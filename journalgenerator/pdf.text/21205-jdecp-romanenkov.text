ДИФФЕРЕНЦИАЛЬНЫЕ 
УРАВНЕНИЯ 
И 
ПРОЦЕССЫ УПРАВЛЕНИЯ 
N. 2, 2021 
Электронный журнал, 
рег. Эл № ФС77-39410 от 15.04.2010 
ISSN 1817-2172 
 
http://diffjournal.spbu.ru/ 
e-mail: jodiff@mail.ru 
 
 
 
Компьютерное моделирование динамических 
и управляемых систем 
 
Гибридная схема для численного решения нелинейного 
уравнения Эйлера 
 
Костиков Ю.А
1,*
, Романенков А.М.
1,2,**
 
 
1
Московский авиационный институт (национальный исследовательский университет) 
2
 Федеральный исследовательский центр «Информатика и управление» Российской 
Академии Наук
 
 
*
jkostikov@mail.ru 
**
romanaleks@gmail.com 
 
Аннотация. В работе рассматривается гибридная разностная схема для построения 
приближенного решения нелинейной системы дифференциальных уравнений с разрывным 
начальным условием. В качестве модельной задачи использована система обыкновенных 
дифференциальных уравнений Эйлера, которая является консервативной на вещественной 
прямой. Для поиска приближенного решения использован комбинированный численный 
метод, в котором в качестве рабочих алгоритмов, между которыми происходит 
переключение, выбраны методы Лакса-Фридрихса и Лакса-Вендрофа. Переключения 
необходимы, так как метод более высокого порядка точности (метод Лакса-Вендрофа) 
приводит к появлению эффекта Гиббса, который является нежелательным не физическим 
артефактом в численном решении. Поэтому в областях, где этот эффект проявляется, 
необходимо выполнить переключение метода. Авторами предложен критерий переключения. 
В системе программирования Matlab разработан скрипт, который реализует гибридную 
схему. Предлагаемый алгоритм оперирует векторными величинами и не использует 
конкретных выражений для координат рассматриваемых векторов. Это делает алгоритм 
независимым от конкретных уравнений системы и позволяет без существенных изменений 
применять его для других задач похожего вида. Продемонстрированы идеи, с помощью 
которых получены данные методы и указана область их применимости. 
 
Ключевые слова: Гибридная схема, уравнение Эйлера, задача Римана. 
 Дифференциальные уравнения и процессы управления, N. 2, 2021 
 
Электронный журнал. http://diffjournal.spbu.ru/81 
1. Введение 
 
Уравнения газовой динамики позволяют описывать и предсказывать процессы, 
происходящие в воздушной среде. В аэрокосмической сфере эти процессы являются 
центральными. Отметим тот факт, что дифференциальные уравнения, возникающие при 
решении газодинамических задач, являются нелинейными [1], точные решения в общем 
случае получить в конечном виде не представляется возможным, поэтому особую роль 
играют приближенные методы построения численных решений. 
Методы вычислительной математики позволяют создавать итерационные алгоритмы для 
получения таких численных решений. Основным подходом, на котором строятся такие 
алгоритмы, является идея замены исходной бесконечномерной задачи на конечномерную, 
разностную задачу с дополнительными ограничениями, которые возникают в силу 
требования выполнения законов сохранения. Отметим, что использование гибридного 
подхода не является нововведением. Так, в работах [2], [3] используется гибридная схема для 
поиска численного решения одномерной краевой задачи для линейного уравнения переноса с 
вязкостью. В качестве переключаемых методов используются схемы Крэнка-Никольсона и 
Лакса. В работе [4] приводится пример гибридной схемы для решения одномерного 
уравнения переноса. Такой подход является типичным для описания и объяснения идей 
построения расчетных выражений, однако, отметим, что при моделировании процессов 
гидро-газодинамики рассмотрения одномерного линейного уравнения переноса не всегда 
делает ясным переход к многомерным нелинейным системам. В работе [5] проведено 
исследование монотонности гибридной схемы для уравнения переноса, что является важным 
аспектом для численных методов, которые предназначены для расчета задач с разрывными 
начальными условиями. При построение гибридных схем можно использовать типичный 
метод неопределенных коэффициентов, который заключается в подборе весовых 
коэффициентов при значениях искомой сеточной функции в заданных узлах сетки. Эти 
коэффициенты подбираются так, чтоб порядок аппроксимации был наибольшим. Авторами в 
работе [6] построен линейный функционал обобщенной аппроксимации и проведен анализ 
разностных схем в пространстве неопределенных коэффициентов. Рассмотрения 
проводились для модельного одномерного уравнения переноса. Совсем свежие результаты в 
работах [7], [8] посвящены построению гибридных схем, которые основаны на интегральных 
законах сохранения. В этих работах рассматриваются трехмерные задачи и гибридные схемы 
для них. 
Стоит заметить, что идеи и методы, которые рассматриваются на модельных линейных 
задачах не всегда могут быть легко перенесены в многомерный случай, где рассматриваются 
нелинейные задачи. 
В данной работе рассмотрена модельная одномерная система дифференциальных 
уравнений Эйлера, которая представляет систему законов сохранения газовой динамики: 
 
         (
       
    
)+
       
(
    
      2
+          )=0,   
(1) 
 
где    =   (   ,   )− плотость газа,    =   (   ,   )− скорость газа,    =   (   ,   )−давление газа, 
   =   (   ,   )− плотность энергии газа в точке    в момент времени    . Для замыкания этой 
системы необходимо добавить два уравнения состояния: 
 
   =   +
      ,   =(   −1)(   −
   2
2
)       
(2) 
 Дифференциальные уравнения и процессы управления, N. 2, 2021 
 
Электронный журнал. http://diffjournal.spbu.ru/82 
Для данной системы часто возникает задача Коши с разрывными начальными данными 
(задача Римана). Для поиска численного решения задачи Римана известны разнообразные 
методы, которые отличаются порядком сходимости, требованиями к виду начальных 
условий и наличием нежелательных эффектов в численном решении разной степени 
выраженности. Остановимся на методах Лакса-Фридрихса и Лакса-Вендроффа [9] - [12]. 
Метод Лакса-Фридрихса является методом первого порядка, а метод Лакса-Вендрофа имеет 
второй порядок. Возникает идея, что для более эффективных вычислений стоит использовать 
метод второго порядка. Однако эта идея не справедлива для разрывных начальных условий, так 
как в окрестностях разрыва возникают нехарактерные осцилляции (явление Гиббса) [9], [13]. 
Поэтому предлагается гибридный метод, который объединяет эти два: для тех областей значений 
переменных, где функции непрерывны, вычисления проводятся по методу Лакса-Вендрофа, а там, 
где возникают разрывы, используется метод Лакса-Фридрихса. 
 
2. Схемы Лакса-Фридрихса и Лакса-Вендрофа 
 
Для описания итерационной процедуры выполним замену переменных, а именно, пусть 
  ⃗ =  ⃗ (   ,   )=(
   1
(   ,   )
   2
(   ,   )
   3
(   ,   )
)=(
   1
   2
   3
)=(
       
    
). Тогда уравнение (1) в новых переменных примет 
вид 
 
           ⃗ +
       
   (  ⃗ )=0,   
(3) 
 
где    (  ⃗ )=
(
 
 
   2
   2
2
   1
+(   −1)(   3
−
1
2
   2
2
   1
 )
   3
   2
   1
+(   −1)
   2
   1
(   3
−
1
2
   2
2
   1
 )
)
 
 
. Далее, возьмем интервал [   ;   ],   >   , на 
вещественной оси и разобьем его на    ∈ℕ частей. Тогда введем величины ∆   =
   −      ,      =
   +
2   −1
2
∆   ,      ±
1
2
=      ±
1
2
∆   и функции 
      (   )=  ⃗ 
   (   )=
1
∆   ∫   ⃗ (   ,   )
      +
1
2
      −
1
2
     
   (      (   ),      +1
(   ))=   (  ⃗ (      +
1
2
,   )). 
С использованием метода Эйлера и введенных параметров можно из дифференциального 
выражения (4): 
 
              (   )=−
1
∆   (   (      (   ),      +1
(   ))−   (      −1
(   ),      (   ))), 
(4) 
 
получить разностную формулу 
 
         +1
=         −
∆   ∆   (   (      (   ),      +1
(   ))−   (      −1
(   ),      (   ))), 
(5) 
 Дифференциальные уравнения и процессы управления, N. 2, 2021 
 
Электронный журнал. http://diffjournal.spbu.ru/83 
где ∆   −величина шага по оси времени и          =     (   ∆   ) . 
Теперь заменив в формулах (4)-(5) выражения, стоящие справа от знака равенства на их 
центральные аппроксимации, получим разностный оператор, по которому строится 
приближенное решение уравнения (3) методом Лакса-Фридрихса: 
 
         +1
=         −
∆   ∆   (       
(         ,      +1
   )−       
(      −1
   ,         )) 
(6) 
 
где        
(         ,      +1
   )=
1
2
(   (         )+   (      +1
   )−
∆   ∆   (      +1
   −         )) . 
Схема Лакса-Вендрофа получается с использованием техники разложений в степенные 
ряды и более объемна при изложении [10], поэтому приведем непосредственно разностный 
оператор данной схемы: 
 
         +1
=         −
∆   ∆   (       
(         ,      +1
   )−       
(      −1
   ,         )),   
(7) 
 
где        
(         ,      +1
   )=   (
1
2
(         +      +1
   −
∆   ∆   (   (      +1
   )−   (         )))). 
 
3. Гибридная разностная схема 
 
Как было отмечено, при использовании схемы Лакса-Вендрофа для численного решения 
уравнения (1) с разрывными начальными условиями появляется эффект Гиббса. Рассмотрим 
начальные условия: 
 
   0
={
      ,0≤   <0.5
      ,0.5≤   <1
,      =(
1
0.75
1
),      =(
0.125
0
0.1
) 
(8) 
 
График компонент решения, полученный методом Лакса-Вендрофа, представлен на рис. 1. 
видно в окрестности точки разрыва появляются сильные колебания решений. 
Для устранения этих эффектов введем переключательную функцию: 
 
         +1
=         −
∆   ∆   (   (     )∙     +(1−   (     ))∙     ), 
(9) 
 
где      =       
(         ,      +1
   )−       
(     −1
   ,         ),     =       
(         ,      +1
   )−       
(      −1
   ,         ) , а величина 
   (   )={
0,|   |>   1,|   |≤   
,    − величина допустимого изменения функции, которая определяется во время 
построения численного решения. Например, можно взять    = 2. 
 Дифференциальные уравнения и процессы управления, N. 2, 2021 
 
Электронный журнал. http://diffjournal.spbu.ru/84 
 
Рис. 1. Решение задачи Римана методом Лакса-Вендрофа 
 
Величина       характеризует относительную величину скачка и может быть вычислена по 
формуле       =
|         −      −1
   |
|      +1
   −         |
. На рис. 2 показан график численного решения, которое получено с 
помощью гибридной схемы. 
 
 
Рис. 2. Решение задачи Римана с помощью гибридной схемы Дифференциальные уравнения и процессы управления, N. 2, 2021 
 
Электронный журнал. http://diffjournal.spbu.ru/85 
 
4. Заключение 
 
В работе предложена гибридная схема для численного решения нелинейных систем 
дифференциальных уравнений с разрывными начальными условиями. Данная схема позволила 
комбинировать два метода поиска приближенного решения дифференциальной задачи, учитывая 
преимущества обоих методов: более высокую точность получаемого решения на непрерывных 
данных и предотвращение разбалтывания численного решения на множествах, где непрерывность 
теряется. Объединение этих методов позволило повысить эффективность вычислений. Численные 
эксперименты показали ускорение поиска приближенного решения для одних и тех же начальных 
данных и заданной точности примерно на 40%. Применение гибридных схем может быть полезно 
и при использовании других методов. Численный метод реализован в среде Matlab с 
использованием средств визуализации matplotlib. 
 
 
Список литературы 
 
[1] Лойцянский, Л.Г. Механика жидкости и газа. М. – Ленинград: Государственное 
издательство технико-теоретической литературы, 1950. 
[2] Бондарев, А.Е. Применение методов научной визуализации для оптимизации 
вычислительных свойств конечно-разностных схем // Препринты ИПМ им. М. В. 
Келдыша, 79 (2006), 1-17. 
[3] Бондарев, А., Бондаренко, А., Галактионов, В., Михайлова, Т., Рыжова, И. Разработка 
программного комплекса BURGERS2 для оптимизации и визуализации 
вычислительных свойств гибридных разностных схем // Научная визуализация, 1 
(2013), 26-37. 
[4] Лобанов, А.И., Петров, И.Б. Математическое моделирование нелинейных процессов: 
учебник для академического бакалавриата. М.: Юрайт, 2019. 
[5] Демьянов, А.Ю., Чижиков, Д.В. Неявная гибридная монотонная разностная схема 
второго порядка точности // Исследовано в России (2003), 2484-2487. 
[6] Лобанов, А.И., Миров, Ф.Х. Гибридная разностная схема с обобщенным условием 
аппроксимации. Анализ в пространстве неопределенных коэффициентов // Журнал 
вычислительной метаматематики и математической физики, 8 (2018), 1-10. 
[7] Semi-implicit Hybrid Discrete H       Approximation of Thermal Radiative Transfer // 
arxiv.org. Available at: https://arxiv.org/pdf/2102.13021.pdf. 
[8] Albertini, G., Elbanna, A., Kammer, D.S. A three-dimensional hybrid finite element – 
spectral boundary 3 integral method for modeling earthquakes in complex unbounded 4 
domains // arxiv.org. Available at: https://arxiv.org/pdf/2102.08756.pdf. 
[9] Лакс, П.Д. Гиперболические дифференциальные уравнения в частных производных. М. 
– Ижевск: НИЦ «Регулярная и хаотическая динамика», Ижевский институт 
компьютерных исследований, 2010. 
[10] Lax, P., Wendroff B. Systems of conservation laws // Communications on Pure and Applied 
Mathematics, 13 (1960), 217-237. 
[11] LeVeque, R.J. Numerical Methods for Conservation Laws. Basel; Boston; Berlin: Birkhauser, 
1992. 
[12] Meister, A., Struckmeier, J. Hyperbolic Partial Differential Equations: Theory, Numerics and 
Applications. Braunschweig; Wiesbaden: Vieweg+Teubner Verlag, 2002. 
[13] Жуков, А.И. Метод Фурье в вычислительной математике. M.: Наука, 1992. 
 
 
 Дифференциальные уравнения и процессы управления, N. 2, 2021 
 
Электронный журнал. http://diffjournal.spbu.ru/86 
Hybrid scheme for numerical solution of a nonlinear Euler's equation 
 
Kostikov Yu.А.
1,*
, Romanenkov A.M.
1,2,**
 
 
1
Moscow Aviation Institute (National Research University) 
2
Federal Research Center “Informatics and Management” of the Russian Academy of Sciences 
 
*
jkostikov@mail.ru 
**
romanaleks@gmail.com 
 
Abstract. In this paper, we consider a hybrid difference scheme for constructing an approximate 
solution of a nonlinear system of differential equations with a discontinuous initial condition. As a 
model problem, the system of Euler's ordinary differential equations, which is a conservative on 
real line, is used. To find an approximate solution, we use a combination from the Lax-Friedrichs 
and Lax-Wendroff methods and switching between them. The switching is necessary, since the 
higher order accuracy method (the Lax-Wendroff method) leads to the appearance of the Gibbs 
effect, which is an unwanted non-physical artifact in the numerical solution. Therefore, in the areas 
where this effect occurs, it is necessary to perform the switching to another method. The authors 
propose a criterion for the switching. The script describing the hybrid scheme was implemented in 
Matlab programming system. The proposed algorithm operates with vector quantities and does not 
use specific expressions for the coordinates of the vectors under consideration. As a sequence, the 
algorithm is independent of  a given system and may be applied to other problems of a similar type 
without significant changes. The ideas used to obtain these methods are demonstrated and the scope 
of their applicability is indicated. 
 
Keywords: Hybrid scheme, Euler equation, Riemann problem. 
