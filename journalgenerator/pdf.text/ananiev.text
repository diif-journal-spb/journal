dx
dt
6
 
-
?
ДИФФЕРЕНЦИАЛЬНЫЕ УРАВНЕНИЯ
И
ПРОЦЕССЫ УПРАВЛЕНИЯ
№ 1, 2007
Электронный журнал,
рег. № П2375 от 07.03.97
ISSN 1817-2172

e-mail: jodiff@mail.ru
Оптимальное управление
ЗАДАЧА МНОГОКРАТНОЙ КОРРЕКЦИИ ПРИ
ГЕОМЕТРИЧЕСКИХ ОГРАНИЧЕНИЯХ НА
ВОЗМУЩЕНИЯ
1
Б.И. Ананьев
Россия, 620219, Екатеринбург, ул. Ковалевской, д. 16,
Институт математики и механики УрО РАН,
e-mail: abi@imm.uran.ru
Н.В. Гредасова
Россия, 620219, Екатеринбург, ул. Ковалевской, д. 16,
Институт математики и механики УрО РАН,
e-mail: gnv@imm.uran.ru
Аннотация.
Рассмотреназадачамногократнойкоррекциидлялинейныхуправляемых
системсдискретныммножествомнаблюдений.Предложенынекоторыеалго-
ритмыкоррекцииуправленияиизученыихсвойства.Вкачествеприложения
исследован простой случай задачи выставки.
1
Статья выполнена при финансовой поддержке РФФИ, грант № 04-01-00148Дифференциальные уравнения и процессы управления, N. 1, 2007
1 Введение
Задачамногократнойкоррекциислужитестественнымобобщениемзадачод-
нократной коррекции движения, рассмотренных в работах [1–4]. Для случа-
ев, когда возмущения стеснены интегральными ограничениями многократ-
ная коррекция изучалась в [5,6]. В работе [6] рассмотрена общая нелинейная
постановка для многошаговых систем. В настоящей работе задача изучается
длялинейнойнепрерывнойсистемысдискретныммножествомнаблюденийи
сгеометрическимиограниченияминавозмущения.Системавпервомприбли-
жении описывает отклонение движения управляемого объекта от номиналь-
ной траектории. В дискретные моменты производится измерение фазового
вектора с возмущением, ограниченным компактным множеством. Начальное
состояние системы также содержится в компакте. В начале процесса коррек-
ции определяется оптимальное программное управление, решающее задачу
минимаксного управления по неполным данным [7]. Затем с использовани-
ем понятия информационного множества [7] в результате сравнения мини-
макса целевого функционала с прогнозом отыскиваются моменты коррекции
программного управления. В качестве приложения полученных результатов
рассмотрен простой случай задачи выставки инерциальной системы самолё-
та, стартующего с движущегося корабля.
2 Оценивание состояния управляемой системы
Пусть отклонение управляемого объекта от заданного движения x
0
(t) ≡ 0
описывается в линейном приближении дифференциальным уравнением
˙ x = A(t)x+B(t)u+v(t), t∈ [0,T], (1)
где x ∈ R
n
– фазовый вектор; u ∈ R
r
– вектор управления, стесненный
ограничением
u(t)∈ U (2)
с выпуклым компактом U; v(t) – неизвестная детерминированная функция,
удовлетворяющая априорному ограничению
v(t)∈ V (3)
с выпуклым компактным ограничивающим множеством V; A(t), B(t) – не-
прерывные матрицы соответствующих размерностей. Начальное состояние

системы (1) стеснено включением
x
0
∈ X
0
, (4)
где X
0
– выпуклый компакт. Поскольку движение системы (1) происходит
вблизи начала координат, обычно считается, что компакты ограничений (2)
– (4) содержат нулевые векторы.
Предположим, что фазовый вектор системы (1) недоступен для измере-
ния. Наблюдается величина
y
k
= C
k
x(t
k
)+w
k
, k = 1,...,N, (5)
в заданные моменты времени 06 t
1
< t
2
< ... < t
N
6 T, y
k
∈ R
m
, rankC
k
=
m. Помеха w
k
стеснена ограничением
w
k
∈ W (6)
с выпуклым компактом W, содержащим нуль.
Введём в рассмотрение информационное множество X(t,y,u) в соответ-
ствиисопределением,даннымв[7],ипримемегозаоценкуфазовоговектора
системы (1) в текущий момент t.
Теорема 1 Информационное множество X(t,y,u) системы (1) с измере-
ниями (5) и ограничениями (3), (4), (6) является выпуклым компактом и
определяется рекуррентно по формулам
X(t,y,u) =S(t,t
k
)X(t
k
,y,u)+
t
R
t
k
S(t,τ)B(τ)u(τ)dτ+
+
t
R
t
k
S(t,τ)Vdτ, t
k
6 t< t
k+1
, k = 0,...,N; t
0
= 0, t
N+1
= T;
X(t
k
,y,u) =X(t
k
−0,y,u)∩Y
k
,
Y
k
={x : C
k
x∈ y
k
−W}, X(0,y,u) =X
0
.
(7)
Многозначное отображение X(·,y,u) непрерывно по Хаусдорфу на отрезке
[t
k
,t
k+1
] и предел слева X(t
k
−0,y,u) существует для всех k = 1,...,N +1.
Здесь S(t,τ) – фундаментальная матрица однородной системы (1).
Теорема устанавливается стандартными рассуждениями, аналогичными
приведеннымв[7].ПосколькувыпуклыйкомпактK однозначноопределяется
своей опорной функцией [8], ρ(l| K) = max
x∈K
l
0
x, из теоремы 1 получаем

Следствие 1 ОпорнаяфункциямножестваX(t,y,u)определяетсяформу-
лами
ρ(l| X(t,y,u)) = ρ(S
0
(t,t
k
)l| X(t
k
,y,u))+
t
R
t
k
l
0
S(t,τ)B(τ)u(τ)dτ+
+
t
R
t
k
ρ(S
0
(t,τ)l| V)dτ, t
k
6 t< t
k+1
, k = 0,...,N; t
0
= 0,
t
N+1
= T; ρ(l| X(t
k
,y,u)) = inf
p∈R
m
{ρ(l−C
0
k
p| X(t
k
−0,y,u))+
+ρ(p| y
k
−W)}, k = 1,...,N, X(0,y,u) =X
0
.
(8)
Здесьидалеесимвол
0
означаеттранспонирование.Вобоснованиинужда-
ется лишь вторая формула в (8). В силу предположений о матрице C
k
имеем
Y
k
= kerC
k
⊕C
0
k
(C
k
C
0
k
)
−1
(y
k
−W). (9)
Известно [8], что опорная функция пересечения выпуклого компакта и вы-
пуклогозамкнутогомножестваопределяетсяоперациейинфимальнойконво-
люции. Ввиду (9) получаем ρ(q | Y
k
) = +∞, если q 6∈ imC
0
k
. Значит, q = C
0
k
p
и мы приходим к формуле из (8). Отметим ещё, что множествоX(t
k
−0,y,u)
получается по формулам (7), (8), если t
k
заменить на t
k−1
, а t на t
k
.
3 Задача программного управления по неполным дан-
ным
Пусть величина отклонения траектории системы (1) от нуля в конечный мо-
мент оценивается величиной Φ(x(T)), где Φ – неотрицательная выпуклая
и конечная функция, заданная на R
n
. Введём ряд обозначений. Символом
f
s
далее обозначается функция f(·), рассматриваемая на отрезке [0,s]. Та
же функция, рассматриваемая на отрезке [s,T], будет обозначаться f
s
, а
на отрезке [s,τ] – как f
τ
s
, где τ < T. Для сокращения записей полагаем
f
k
= f
t
k
, f
k
= f
t
k
, f
m
k
= f
t
m
t
k
. Аналогично, для сигнала y и помехи w обозна-
чаем y
k
={y
1
,...,y
k
}, y
m
k
={y
k
,...,y
m
}.
Определим минимакс отклонения системы от нуля в конечный момент
как
r
t
(y,u) = min
u
t
max
x∈X(t,y,u)
max
v
t
Φ(x(T)). (10)
Величина(10)являетсягарантированнымрезультатомуправлениявпозиции
X(t,y,u), где под позицией будем понимать информационное множество в

данный момент t ∈ [0,T]. Любое управление u
t
, реализующее минимум в
(10), назовём оптимальным в данной позиции.
Получим необходимое условие оптимальности. Имеем
r
t
(y,u) = min
u
t
max
l
{ρ(S
0
(T,t)l| X(t,y,u))+
T
R
t
l
0
S(T,τ)B(τ)×
×u(τ)dτ +
T
R
t
ρ(S
0
(T,τ)l| V)dτ −Φ
∗
(l)},
где Φ
∗
(·) – функция, сопряжённая к Φ(·). Переходя к вогнутой оболочке и
переставляя max и min местами, аналогично [1,2] получим
r
t
(y,u) = max
l
{(conc)[ρ(S
0
(T,t)l| X(t,y,u))+
T
R
t
ρ(S
0
(T,τ)×
×l| V)dτ −Φ
∗
(l)]−
T
R
t
ρ(−B
0
(τ)S
0
(T,τ)l| U)dτ}.
(11)
Таким образом, справедлива
Теорема 2 Пусть l – вектор, доставляющий максимум в (11). Тогда необ-
ходимо имеем
l
0
S(T,τ)B(τ)u
t
(τ) = min
u∈U
l
0
S(T,τ)B(τ)u.
Отметим случай, когда формула (11) принимает относительно простой
вид. Обозначим сумму ρ(lS
0
(T,t)q | X(t,y,u)) +
T
R
t
ρ(lS
0
(T,τ)q | V)dτ через
F(l;q,t,y,u), | l |6 1, q ∈ R
n
. Ввиду выпуклости и положительной однород-
ности функции F(·;q,t,y,u) получаем
Утверждение 1 Пусть Φ(x) =| q
0
x|, где q ∈ R
n
. Тогда Φ(x) = max
|l|61
lq
0
x и,
следовательно,
r
t
(y,u) = max{(F(1;q,t,y,u)+F(−1;q,t,y,u))/2,F(1;q,t,
y,u)−
T
R
t
ρ(−B
0
(τ)S
0
(T,τ)q | U)dτ,F(−1;q,t,y,u)−
T
R
t
ρ(B
0
(τ)×
×S
0
(T,τ)q | U)dτ}.
(12)

Действительно, при условиях утверждения
r
t
(y,u) = max
|l|61
{(conc)F(l;q,t,y,u)−
T
R
t
ρ(−lB
0
(τ)S
0
(T,τ)q | U)dτ}.
Поскольку(conc)F(l;·) =F(−1;·)+((F(1;·)−F(−1;·))/2)(l+1),максимумпо
отрезку [−1,1] достигается в одной из трёх точек -1, 0 или 1. Следовательно,
получаем (12).
4 Алгоритмы многократной коррекции
Введём множество допустимых продолжений сигнала
Y(t,τ,y,u) ={y
j
k+1
: k = m(t), j = m(τ), x∈ X(t,y,u),
v(α)∈ V, w
i
∈ W}.
(13)
Здесь m(t) = max{i > 1 : t
i
6 t}. Если τ > t
k+1
> t, то множество (13)
непусто, компактно и выпукло.
Теперьможемопределитьпрогнозгарантированногорезультата(10),(11)
по формуле
r
t
(τ,y,u) = max
y∈Y(t,τ,y,u)
r
τ
(y,u). (14)
Величина (14) характеризует наихудший прогноз гарантированного резуль-
тата управления, если система находится в позиции X(t,y,u) и вплоть до
момента τ применяется допустимое управление u
τ
t
. Условимся считать, что
r
t
(τ,y,u) =r
τ
(y,u), t
k
6 t6 τ <t
k+1
, (15)
для всякого полуинтервала [t
k
,t
k+1
), k = 0,...,N. В данной позиции с на-
значенным управлением u
t
(τ), t 6 τ 6 T определим минимум наихудшего
прогноза по формуле
r
t
(y,u) = min
t6τ6T
r
t
(τ,y,u). (16)
Прежде чем формулировать алгоритмы, отметим следующее. Пусть t
k
6
t< t
k+1
. Тогда по формулам (8), (11) находим
r
t
(y,u) = max
l
{(conc)[ρ(S
0
(T,t
k
)l| X(t
k
,y,u))+
T
R
t
k
ρ(S
0
(T,τ)×
×l| V)dτ −Φ
∗
(l)]+
t
R
t
k
l
0
S(t,τ)B(τ)u(τ)dτ −
T
R
t
ρ(−B
0
(τ)S
0
(T,
τ)l| U)dτ}> r
t
k
(y,u),
(17)

причём неравенство (17) верно для любого допустимого управления u
t
t
k
. Сле-
довательно, с учётом (15) лишь последующие за t
k
измерения в моменты
t
k+1
,t
k+2
,... могут обеспечить уменьшение прогноза гарантированного ре-
зультата (14).
А. Алгоритм пошаговой многократной коррекции. Будем изменять буду-
щее управление u
k
= u
t
k
лишь в некоторые моменты t
k
поступления ин-
формации по формуле (5). Далее будем полагать, что r
k
(y,u) = r
t
k
(y,u),
r
k
(y,u) =r
t
k
(y,u). Если в позиции X(t
k
,y,u) имеем неравенство
r
k
(y,u) >r
k
(y,u), (18)
то управление u
k
, найденное на предыдущих шагах, не корректируется. В
противномслучае,еслиуправлениеu
k
ктомуженеоптимально,переходимк
оптимальномууправлениюu
k
взадаче(10).Вконцепроцессаполучаемвели-
чинуr
T
(y,u)какмаксимумцелевойфункции Φ(·),вычисленныйнаконечной
позиции X(T,y,u), а также управление u = u(·,y). Это управление зависит
от реализации сигнала y
N
. Моменты коррекции обозначим {τ
1
,τ
2
,...,τ
K
},
где τ
i
= t
i
l
, 16 i
1
< i
2
< ... < i
K
6 N. В частности, совокупность момен-
тов коррекции может быть пустой, что означает удачный выбор начального
управленияu
0
(·) и пошаговое уменьшение наихудшего терминального крите-
рия независимо от реализующегося сигнала. Другой крайний случай состоит
в совпадении моментов коррекции со всем множеством {t
1
,...,t
N
}. В силу
неравенства (17) минимум в равенстве (16) при t = t
k
можно подсчитывать
по конечному множеству {t
k+1
,...,t
N
}.
Б. Алгоритм коррекции с уменьшенным количеством проверок. С целью
уменьшенияпроверокнеравенства(18)впозицииX(t
k
,y,u),гдевыполняется
неравенство(18)иненадокорректироватьбудущееуправлениеu
k
,сохраняем
это управление вплоть до момента
ϑ
k+1
= argmin
τ∈{t
k+1
,...,t
N
}
r
k
(τ,y,u). (19)
Если же в момент t
k
неравенство (18) не выполняется, то полагаем ϑ
k+1
=
t
k+1
. В момент ϑ
k+1
повторяем процедуру.
В. Алгоритм коррекции с прогнозом на один шаг. Алгоритм аналогичен
А, но вместо неравенства (18) проверяется более простое неравенство
r
k
(y,u) >r
k
(t
k+1
,y,u). (20)
В принципе, количество коррекций управления в этом алгоритме может ока-
заться больше, чем в алгоритме А.

Все отмеченные алгоритмы предваряются подсчётом числа r
0
и опреде-
лением начального оптимального управления u
0
. Отметим, что построение
множеств X(t,y,u) c помощью опорных функций (8) – достаточно сложная
задача. Поэтому часто прибегают к аппроксимации сверху указанных мно-
жествэллипсоидамиилипрямоугольниками[9,10].Аппроксимацияприводит
к оценкам сверху для величин (11), (14).
5 Основные результаты
Обозначим сигнал, реализующийся в системе (1) – (6) при u = 0, через e y.
Наблюдаемыйсигналпредставимкакy
k
=e y
k
+C
k
z
k
,гдеz
k
= z(t
k
)–решение
системы (1) при x
0
= 0, v ≡ 0, u 6= 0. Тогда в силу линейности уравнений
получим, что
X(t,y,u) =X(t,e y,u)+z(t). (21)
Утверждение 2 Если в момент t
k
назначается управление u
k
, оптималь-
ное в задаче (10), то для всякого прогноза справедливы неравенства r
k
(τ,y,
u)6 r
k
(y,u), τ ∈{t
k+1
,...,t
N
}. Если в дополнение к сказанному момент t
k
является моментом коррекции в алгоритме А, то указанные неравенства
превращаются в равенства для всякого τ ∈{t
k+1
,...,t
N
}.
Действительно, если бы r
k
(τ,y,u) > r
k
(y,u), то нашлось бы такое про-
должение y
l
k+1
∈ Y(t
k
,τ,y,u), l = m(τ), сигнала y
k
, что r
τ
(y,u) > r
k
(y,u).
Значит, существует векторx∈ X(τ,y,u) и помехаv
τ
, порождающие вместе с
управлениемu
k
значениеx(T),длякоторогоΦ(x(T)) >r
k
(y,u).Ноэтоневоз-
можно в силу выбора управления u
k
. Второе утверждение леммы вытекает
из определения момента коррекции в алгоритме А.
С учётом утверждения 2 получаем теорему.
Теорема 3 Пусть в системе (1) – (6) при u = 0 реализуется некото-
рый сигналe y
N
, и зафиксировано начальное оптимальное управление u
0
. То-
гдаалгоритмАоднозначноопределяетпоследовательность{τ
1
,τ
2
,...,τ
K
},
τ
i
= t
i
k
, 16 i
1
< ... < i
K
6 N, моментов изменения управления. При этом
управление u
T
, формируемое алгоритмом на отрезке [τ
i
,τ
i+1
], совпадает с
оптимальнымуправлениемu
τ
i
взадаче (10),i = 1,...,K−1.Гарантирован-
ные значения r
i
= r
τ
i
(y,u) критерия качества образуют невозрастающую
последовательность:
r
0
> r
1
> ...> r
K
. (22)

Здесь имеют место строгие неравенства r
i
> r
i+1
тогда и только тогда,
когда реализуется не самый худший сигнал из множества Y(τ
i
,τ
i+1
,y, u).
Аналогичные теоремы можно сформулировать и для алгоритмов Б и В.
6 Примеры
1) Вначале рассмотрим иллюстративный пример. Дана скалярная система
˙ x = u, | u |6 μ, | x
0
|6 μ, на отрезке [0,4]. В моменты t
1
= 1, t
2
= 2, t
3
= 3
производятся наблюдения y
k
= x(t
k
)+w
k
, | w
k
|6 ν, 2μ > ν. Пусть Φ(x) =|
x|. Используем равенства
min
|u|6μ
max
a6x6b
| u+x|= min
|u|6μ
{(b−a)/2+| u−(a+b)/2|} =
=





(b−a)/2, | a+b|6 2μ;
b−μ, a+b > 2μ;
−a−μ, a+b <−2μ.
дляопределенияоптимальногоуправления.Вуказаннойминимакснойзадаче
имеем
u =





(a+b)/2, | a+b|6 2μ;
−μ, a+b > 2μ;
μ, a+b <−2μ.
Используя выписанные равенства, получаем r
0
= μ. Это значение получа-
ется, например, при u ≡ 0. Именно это управление и выберем в качестве
начального. Пусть сигнал e y реализуется при x
0
= μ, w
1
= w
2
= 0, w
3
= ν.
С учётом того, что X(t
k
,y,u) =
R
t
k
0
u(t)dt + [(e y
k
− ν) ∨ a,(e y
k
+ ν) ∧ b],
где X(t
k−1
,e y,0) = [a,b], c ∨ d = max{c,d}, c ∧ d = min{c,d}, находим
X(1,y,u) = [μ−ν,μ],r
1
(y,u) =ν/2 <μприуправленииu
2
1
≡ ν/2−μ, u
2
≡ 0.
Посколькунаихудшийпрогноздаётрезультатr
1
= ν/2,момент1естьмомент
коррекции. Мы переходим в позицию X(2,y,u) = [−ν/2,ν/2], где r
2
(y,u)
также равно ν/2. Управление u
2
≡ 0 не меняем, поскольку оно оптимально.
Третье измерение приводит к тому, что X(3,y,u) = {ν/2}, т.е. множество
состоит из одной точки. Значит, в момент 3 следует изменить управление
на u
3
≡ −ν/2. В результате получаем нулевое значение критерия r
4
= 0.
Отметим, что здесь алгоритмы А, Б, В приводят к одинаковому результату.
2) Рассмотрим простой случай задачи согласования (выставки) систем
координат корабля и стартующего с него самолёта. Пусть корабль движется

по экватору. Тогда [11,12] отклонение систем можно характеризовать одним
углом θ, для которого
˙
θ = u+ε, ˙ ε = v.
Здесьε – дрейф,u – разность абсолютных угловых скоростей систем коорди-
нат, используемая как управление, v – неопределённая помеха. Для измере-
ния используется разность выходов акселерометров: y = gθ+w, где g – уско-
рениесвободногопадения,w–непредсказуемыеуходынулейакселерометров.
Измерения проводятся с шагом Δ = 1 сек., время выставки T = 300 сек. В
отличие от [11–13] рассматриваемая модель чисто детерминированная. Были
выбраны следующие числовые данные: | θ
0
|6 3
◦
, | ε
0
|6 0.01 град./сек.,
| v |6 0.01/36 град./сек
2
., | u |6 0.05 град./сек., | w |6 0.002 м/сек
2
. Сиг-
нал формируется при начальных условиях: θ
0
= 3
◦
, ε
0
= −0.01 град./сек.,
v ≡ 0.01/36 град./сек
2
., w ≡ −0.002 м/сек
2
. Использовался алгоритм В с
прогнозом на 1 шаг. При этом информационные множества аппроксимиро-
вались прямоугольниками. Алгоритм приводит к одному моменту коррекции
на 207-ом шаге.
РезультатымоделированияпростогослучаяпредставленынаРис.1,Рис.
2.
Список литературы
[1] АнаньевБ.И.,КуржанскийА.Б.,ШелементьевГ.С.Минимаксныйсин-
тез в задачах импульсного наведения и коррекции движения. // При-
кладная математика и механика, 1976, Т.40, вып.1, С. 3-13.

[2] Ананьев Б.И. Минимаксная квадратичная задача коррекции движении.
// Прикладная математика и механика, 1977, Т.41, вып.3, С. 436-445.
[3] Красовский Н.Н. Игровая задача о коррекции движения. // Прикладная
математика и механика, 1969, Т.33, вып.3, С. 386-396.
[4] Черноусько Ф.Л. Минимаксная задача одноразовой коррекции при по-
грешностях измерений. // Прикладная математика и механика, 1968,
Т.32, вып.4, С.584-595.
[5] Ананьев Б.И., Гредасова Н.В. Многократная коррекция движения ли-
нейно - квадратичной управляемой системы. // Вестник УГТУ-УПИ, №
4(56). 2005. С. 280-288.
[6] Ананьев Б.И., Гредасова Н.В. Коррекция решения многошаговой систе-
мы в условиях неопределенности. // Информационно-математические
технологии в экономике, технике и образовании: сб. материалов област-
нойнаучно-практическойконференции.Екатеринбург:ГОУВПОУГТУ-
УПИ, 2006. Ч. 1. С. 3-11.
[7] Куржанский А.Б. Управление и наблюдение в условиях неопределенно-
сти. М.: Наука, 1977.
[8] Рокафеллар Р. Выпуклый анализ. М.: Мир, 1973.
[9] Kurzhanski A.B., V´ alyi I. Ellipsoidal Calculus for Estimation and Control.
Boston: Birkh¨ auser, 1996.
[10] Костоусова Е.К. О полиэдральном оценивании областей достижимости
линейныхмногошаговыхсистем.//Автоматикаителемеханика,1977,№
3. С. 57-68.
[11] Богуславский И.А. Прикладные задачи фильтрации и управления. М.:
Наука, 1983.
[12] Климов Д.М. Инерциальная навигация на море. М.: Наука, 1984.
[13] Парусников Н.А., Морозов В.М., Борзов В.И. Задача коррекции в инер-
циальной навигации. М.: Изд-во МГУ, 1982.
Электронный журнал.  73
