dx
dt
6
 
-
?
ДИФФЕРЕНЦИАЛЬНЫЕ УРАВНЕНИЯ
И
ПРОЦЕССЫ УПРАВЛЕНИЯ
N 4, 2015
Электронный журнал,
рег. Эл. N ФС77-39410 от 15.04.2010
ISSN 1817-2172
http://www.math.spbu.ru/diffjournal
e-mail: jodiff@mail.ru
Дифференциально-разностные уравнения
Управления на основе предиктора: задача реализации
В. Л. Харитонов
Факультет прикладной математики - процессов управления,
Санкт-Петербургский государственный университет,
Санкт-Петербург, Россия
Аннотация
В работе рассмотрена задача построения динамических регуляторов для
систем с запаздыванием в состоянии и управлении. Регуляторы, построен-
ные на основе метода компенсации запаздывания в управлении, описывают-
ся интегральными уравнениями. Известно, что если эти уравнения не яв-
ляются внутренне устойчивыми, то замена интегралов конечными сумма-
ми приводит к неустойчивости замкнутой системы. Предложено использо-
ватьдополнительныефильтрыдлязаменыинтегральныхуравненийинтегро-
дифференциальными. Получен новый класс динамических регуляторов. По-
казано, что замена интегралов, входящих в состав этих регуляторов, конеч-
ными суммами не приводит к потере устойчивости замкнутой системы.
Ключевые слова: дифференциально-разностные системы, компенсация
запаздывания, стабилизация
Abstract
The problem of design of dynamic controllers for systems with delay in the
state and control variables is studied. Prediction-based controllers are describedДифференциальные уравнения и процессы управления,N. 4, 2015
by integral equations. It is known that in such equations the replacing integrals by
ﬁnite sums leads to instability of the closed-loop system when integral equations
are not internally stable. To avoid this technical deﬃculty we suggest to apply
additional ﬁlters. This provides a new class of dynamic controllers described by
integro-differential equations. It is shown that the closed-loop system with a
controller from the new class remains exponentially stable when integral terms
are approximated by ﬁnite sums.
keywords: difference-differential systems, delay compensation,stabilization
1 Введение
В работе [11] была предложена общая схема построения стабилизирующих
регуляторов для систем с запаздыванием в управлении. Ключевым элемен-
том схемы была формула Коши, выражающая зависимость будущего состоя-
ния системы от её текущего состояния и выбранного управления. Различные
аспекты предложенной схемы подробно обсуждались в работах [1], [5], [8],
[13]. Регуляторы имели вид интегральных уравнений, правые части которых
включали интегралы от переменной управления. При практической реализа-
ции интегралы заменялись конечными суммами. По сути такая замена прин-
ципиально меняла тип регулятора. Исходные интегральные уравнения отно-
сятся к уравнениям запаздывающего типа, а приближенные к уравнениям
нейтрального типа. Анализ возможных последствий такой замены показал,
что даже при использовании квадратурных формул высокой точности но-
вые регуляторы могут приводить к неустойчивости замкнутой системы [12],
[4], [3]. В работе [10] было предложено использовать дополнительные филь-
тры. Это позволило сохранить запаздывающий тип регулятора после заме-
ны интегралов конечными суммами. Использование фильтра можно интер-
претировать как расширение вектора состояния системы за счет добавления
переменных управления к переменным состояния. Устойчивость системы с
расширенным вектором состояния влечет устойчивость исходной замкнутой
системы. Было показано, что для систем с расширенным вектором состояния
замена интегралов конечными суммами не приводит к потере устойчивости,
[10]. Возможность распространения схемы построения стабилизирующих ре-
гуляторов на случай систем с запаздыванием не только в управлении, но и
в состоянии, была показана в работах [6], [7], [14]. Новые регуляторы описы-
ваются интегральными уравнениями, аналогичными полученным для систем
с запаздыванием в управлении. Только теперь правые части этих уравнений

включают дополнительно интегралы от переменных состояния системы. Это
значит, что и эти интегралы в приложениях должны быть заменены конеч-
ными суммами. В работе [14] предложено добавить переменные управления
к вектору состояния. Было замечено, что стабилизируемость исходной систе-
мы влечет стабилизируемость системы с расширенным вектором состояния,
и можно строить регуляторы непосредственно для систем с расширенным
вектором состояния.
В представленной работе предложена новая схема построения регулято-
ров. Показано, что, как и в случае систем с запаздыванием в управлении ис-
пользование дополнительных фильтров позволяет получить регуляторы со-
храняющие после замены интегралов конечными суммами устойчивость за-
мкнутой системы. В отличии от подхода, предложенного в работе [14], не
требуется построения регулятора для расширенной системы.
Описание рассматриваемых систем дано в Разделе 2. Здесь вводятся обо-
значения, и представлена формула Коши, позволяющая построить предик-
тор будущих состояний системы. Общая схема построения стабилизирующих
регуляторов для систем с запаздыванием в управлении и состоянии представ-
лена в Разделе 3. Задача практической реализации регуляторов обсуждается
в Разделе 4. Основной результатом работы является описание класса прак-
тически реализуемых регуляторов. В Разделе 5 показано, что аппроксимация
слагаемыхсраспределённымзапаздыванием,входящихвсоставрегуляторов,
конечными суммами не влияет на устойчивость замкнутой системы.
2 Описание системы
Рассмотрим систему вида
dx(t)
dt
=A
0
x(t) +A
1
x(t h) +Bu(t  ); (1)
где A
j
, j = 0; 1, вещественные n  n матрицы, а B вещественная n  m
матрица. Будем считать, что запаздывания удовлетворяют неравенствамh 
 . Случай   < h может быть рассмотрен аналогично. Пусть t
0
  0 будет
начальным моментом, а начальная функция ' принадлежит пространству
PC([ h; 0];R
n
) кусочно-непрерывных функций, заданных на отрезке [ h; 0]
со значениями в R
n
. Через x(t;t
0
;') будем обозначать решение начальной
задачи
x(t
0
+ ;t
0
;') ='( );  2 [ h; 0]:

Когда это не затрудняет понимание, аргументы t
0
и ' будем опускать и пи-
сать просто x(t) вместо x(t;t
0
;').
Для векторов используется эвклидова норма, а для матриц индуцирован-
ная сингулярная норма. Для элементов пространстваPC([ h; 0];R
n
) вводит-
ся следующая норма
k'k
h
= sup
 2[ h;0]
k'( )k:
Фундаментальную матрицу системы обозначим через K(t). Она удовле-
творяет уравнению
d
dt
K(t) =A
0
K(t) +A
1
K(t h); t  0;
и начальным условиям: K(t) = 0
n n
,t< 0, K(0) =I
n n
.
Формула Коши [2] даёт явное выражение для решения x(t;t
0
;')
x(t;t
0
;') = K(t t
0
)'(0)
+
0
Z
 h
K(t t
0
   h)A
1
'( )d 
+
t
Z
t
0
K(t  )Bu(   )d ; t t
0
В частности, она задаёт предиктор значений решения в момент t + ,
x(t + ) = K( )x(t) (2)
+
0
Z
 h
K(    h)A
1
x(t + )d 
+
0
Z
  
K(  )Bu(t + )d ; t  0;

и в момент t +  h,
x(t +  h) = K(  h)x(t) (3)
+
0
Z
 h
K(     2h)A
1
x(t + )d 
+
 h
Z
  
K( h  )Bu(t + )d ; t  0:
Если   > 2h, то, дополнительно,
x(t +   2h) = K(   2h)x(t) (4)
+
0
Z
 h
K(     3h)A
1
x(t + )d 
+
 2h
Z
  
K( 2h  )Bu(t + )d ; t  0:
3 Построение стабилизирующих регуляторов
В дальнейшем будем полагать, что известны матрицы F
0
и F
1
такие, что
система
dx(t)
dt
= (A
0
+BF
0
)x(t) + (A
1
+BF
1
)x(t h) (5)
экспоненциально устойчива. Начнём с регулятора вида
u(t) =F
0
x(t + ) +F
1
x(t +  h); t  0: (6)
Он зависит от x(t + ) и x(t +  h), поэтому не может быть реализован
непосредственно. Однако, если заменить эти значения, используя предиктор,

получим регулятор, заданный интегральным уравнением вида
u(t) =
0
Z
  
F
0
K(  )Bu(t + )d  (7)
+
 h
Z
  
F
1
K( h  )Bu(t + )d 
+
0
Z
 h
F
0
K(    h)A
1
x(t + )d 
+
0
Z
 h
F
1
K(     2h)A
1
x(t + )d 
+ [F
0
K( ) +F
1
K(  h)]x(t); t  0:
Для построения решения последнего уравнения требуется начальная функ-
ция для переменной u(t). Будем считать, что
u(t) = (t); t2 [  ; 0);
где 2PC([  ; 0];R
m
).
Замечание1 Система (1), замкнутая регулятором (7), для t2 [0; ) име-
ет вид
dx(t)
dt
=A
0
x(t) +A
1
x(t h) +B (t  );
а для t   совпадает с системой (5).
Замечание 2 Для h = 0 система (1) имеет вид
dx(t)
dt
=Ax(t) +Bu(t  );
где A = A
1
+A
2
, а фундаментальная матрица K(t) = e
At
. В этом случае
регулятор (7) задан интегральным уравнением
u(t) =F
t
Z
t  
e
A(t  )
Bu( )d  +Fe
A 
x(t);
где F =F
0
+F
1
, и совпадает с регулятором, полученным в работе [11].

4 Задача реализации
В приложениях интегралы в правой части уравнения (7) заменяются конеч-
ными суммами. В результате интегральное уравнение заменяется разност-
ным. Показано, что разностные регуляторы могут приводить к неустойчи-
вости замкнутой системы даже при использовании квадратурных формул
высокой точности. В случае систем с запаздыванием в управлении для ре-
шения возникшей проблемы было предложено использовать дополнительные
фильтры [10]. В работе [14] предложено включить переменную u в вектор
состояния системы и искать решение задачи стабилизации системы с расши-
ренным вектором состояния
d (t)
dt
=A
0
 (t) +A
1
 (t h) +Bv(t):
Здесь  (t) = (x
T
(t);u
T
(t))
T
,
A
0
=
 
A
0
B
0
m n
0
m m
!
; A
1
=
 
A
1
0
n m
0
m n
0
m m
!
; B =
 
0
n m
I
m m
!
;
и v(t) суть новая переменная управления. Показано, что расширенная си-
стема стабилизируема тогда и только тогда, когда стабилизируема исходная
система (1). В частности, если для расширенной системы найдётся регулятор
вида
v(t) =K
0
 (t) +K
1
 (t h); (8)
гдеK
0
= [K
0x
;K
0u
] иK
1
= [K
1x
;K
1u
] две постоянные матрицы, то динамиче-
ский регулятор
du(t)
dt
= K
0u
u(t) +K
1u
u(t h)
+K
0x
x(t + ) +K
1x
x(t +  h);
в котором x(t + ) и x(t +  h) заменены выражениями (2) и (3) соответ-
ственно, стабилизирует исходную систему (1).
Перейдём к синтезу регуляторов, решающих задачу стабилизации без
предварительного вычисления вспомогательного управления (8). С этой це-
лью выберем m m матрицу Гурвица G. Управление (7) удовлетворяет ра-
венству
du(t)
dt
 Gu(t) = F
0
dx(t + )
dt
+F
1
dx(t +  h)
dt
 G [F
0
x(t + ) +F
1
x(t +  h)]:

Воспользовавшись системой (1) для замены в этом равенстве производных,
придём к регулятору вида
du(t)
dt
= (G +F
0
B)u(t) +F
1
Bu(t h) (9)
+(F
0
A
0
 GF
0
)x(t + )
+ (F
0
A
1
+F
1
A
0
 GF
1
)x(t +  h)
+F
1
A
1
x(t +   2h); t  0:
Заменив в нём значения x(t + ), x(t +  h) и, в случае   > 2h, x(t +  
2h), правыми частями равенств (2)-(4), придём к искомому динамическому
регулятору
du(t)
dt
= (G +F
0
B)u(t) (10)
+F
1
Bu(t h) +Q( )x(t)
+
0
Z
  
Q(  )Bu(t + )d 
+
0
Z
 h
Q(  h  )A
1
x(t + )d ; ;t  0;
где матрица
Q(t) = (F
0
A
0
 GF
0
)K(t) +F
1
A
1
K(t  2h)
+ (F
0
A
1
+F
1
A
0
 GF
1
)K(t h):
Замкнутая этим регулятором система примет вид
dx(t)
dt
= A
0
x(t) +A
1
x(t h) +Bu(t  ) (11)
du(t)
dt
= (G +F
0
B)u(t) (12)
+F
1
Bu(t h) +Q( )x(t)
+
0
Z
  
Q(  )Bu(t + )d 
+
0
Z
 h
Q(  h  )A
1
x(t + )d ; t  0:

Замечание 3 Система (11)-(12) принадлежит к классу систем запазды-
вающего типа.
Теорема 1 Характеристическая функция q(s) замкнутой системы (11)-
(12) задана формулой
q(s) = det
 
sI
n n
  (A
0
+BF
0
) e
 sh
(A
1
+BF
1
)
 
  det [sI
m m
 G]:
Доказательство. Для вычисления характеристической функции восполь-
зуемся преобразованием Лапласа. Через X(s) и U(s) обозначим образы Ла-
пласа x(t) и u(t), соответственно. После преобразования системы (1) и (9)
примут вид алгебраических уравнений для X(s) и U(s)
 
R
11
(s) R
12
(s)
R
21
(s) R
22
(s)
! 
X(s)
U(s)
!
=
 
r
1
(s)
r
2
(s)
!
:
Здесь
R
11
(s) = sI
n n
 
 
A
0
+e
 sh
A
1
 
;
R
12
(s) =  e
 s 
B;
R
21
(s) =  e
s 
  
F
0
+e
 sh
F
1
  
A
0
+e
 sh
A
1
 
 G
 
F
0
+e
 sh
F
1
  
;
R
22
(s) = sI
m m
 G 
 
F
0
+e
 sh
F
1
 
B;
а векторы r
1
(s), r
2
(s) определяются начальными функциями ' 2
PC([ h; 0];R
n
) и 2PC([  ; 0];R
m
) переменных x(t) и u(t). Функция q(s)
совпадает с определителем матрицы
R(s) =
 
R
11
(s) R
12
(s)
R
21
(s) R
22
(s)
!
:
Нам понадобится вспомогательная матрица
T (s) =
 
I
n n
0
n m
e
s 
 
F
0
+e
 sh
F
1
 
I
m m
!
:
Непосредственной проверкой убеждаемся в справедливости тождества
T
 1
(s)R(s)T (s) =
 
sI
n n
 A
0
 e
 sh
A
1
 BF
0
+e
 sh
BF
1
B
0
m n
sI
m m
 G
!
:

В итоге, искомая характеристическая функция
q(s) = det
 
sI
n n
 A
0
 BF
0
 e
 sh
(A
1
+BF
1
)
 
  det [sI
m m
 G]:
Следствие 1 Пусть матрицы F
0
и F
1
таковы, что система (5) экспонен-
циально устойчива. Замкнутая система (11)-(12) экспоненциально устой-
чива, если G – матрица Гурвица.
5 Аппроксимация распределённого запаздывания
Замкнутая система (11)-(12) имеет вид
dz(t)
dt
=
l
X
j=0
A
j
z(t  
j
) +
0
Z
  
P( )z(t + )d ; (13)
гдеA
j
, j = 0; 1;:::;l, (n +m)  (n +m) матрицы,P( ) матрица порядка
(n +m)  (n +m) с кусочно-непрерывными компонентами, а 0 =  
0
<  
1
<
:::< 
l
= .
Пусть N натуральное число, положим
  =
 
N
;
и заменив интегральное слагаемое в правой части системы (13) конечной сум-
мой вида
N
X
k=1
0
B
@
 (k 1) 
Z
 k 
P( )d 
1
C
A
z(t h
k
);
гдеh
k
2 [(k  1) ;k ),k = 1; 2;:::;N, придём к системе
dy(t)
dt
=
l
X
j=0
A
j
y(t  
j
) +
N
X
k=1
0
B
@
 (k 1) 
Z
 k 
P( )d 
1
C
A
y(t h
k
): (14)
Свяжем с вещественным ff комплексную полуплоскость
C
 
ff
=fsjRe(s)<ffg:

Теорема 2 Пусть все собственные числа системы (13) лежат в полуплос-
кости C
 
ff
, тогда найдётся натуральное число N
0
такое, что для любого
N   N
0
все собственные числа системы (14) лежат в этой полуплоско-
сти.
Доказательство. Характеристическая матрица системы (13),
F
0
(s) =sE 
l
X
j=0
e
  
j
s
A
j
 
0
Z
  
P( )e
 s
d ; (15)
остаётся невырожденной в замкнутой полуплоскости
C
+
ff
=fsjRe(s) ffg:
Характеристическая матрица системы (14) имеет вид
F (s) =F
0
(s) +  (s);
где
 (s) =
N
X
k=1
 (k 1) 
Z
 k 
P( )
 
e
 s
 e
 h
k
s
 
d : (16)
Для доказательства теоремы достаточно указать такое N
0
, что для N 
N
0
условие


F
 1
0
(s)


k (s)k< 1 (17)
выполнено для s2 C
+
ff
. Рассмотрим первый множитель


F
 1
0
(s)


. Из (15)
следует, что
kF
0
(s)k jsj  
0
;
где
 
0
=
l
X
j=0
e
  
j
ff
kA
j
k +
0
Z
  
kP( )ke
 ff
d :
Это означает, что


F
 1
0
(s)


 
1
jsj  
0
; (18)
для любогоs2C
+
ff
сjsj> 
0
. МатрицаF
 1
0
(s) не имеет полюсов в замкнутой
полуплоскостиC
+
ff
, поэтому найдётся  
1
такое, что


F
 1
0
(s)


  
1
; s2C
+
ff
: (19)

Обратимся ко второму множителюk (s)k. Из (16) следует, что
 (s) =
N
X
k=1
e
 (k 1) s
0
Z
  
P(   (k  1) )
 
e
 s
 e
 
k
s
 
d ;
где 
k
= (k  1)  h
k
2 (  ; 0],k = 1; 2;:::;N. Поэтому неравенство
k (s)k  
0
(20)
выполняется для любого s2C
+
ff
. Здесь
 
0
= 2 
0
Z
  
kP( )kd ;
и   = maxfe
  ff
; 1g. Норма слагаемого
L
k
(s) = e
 (k 1) s
0
Z
  
P(   (k  1) )
 
e
 s
 e
 
k
s
 
d 
= e
 (k 1) s
0
Z
  
P(   (k  1) )
0
B
@
s
 
Z
 
k
e
 s
d 
1
C
A
d 
допускает наC
+
ff
оценку сверху вида
kL
k
(s)k    
1
0
Z
  
0
@
0
Z
  
jsjd 
1
A
d 
   
1
jsj 
2
;
где
 
1
=  sup
 2[  ;0]
kP( )k:
Второй множитель удовлетворяет наC
+
ff
неравенству
k (s)k N 
1
jsj 
2
: (21)
Выберем R> 
0
так, чтобы выполнялось неравенство
 
0
R  
0
< 1:

Из (18) и (20) следует, что условие (17) выполнено на множестве
fsjs2C
+
ff
;jsj Rg. Неравенство (21) означает, что для любого s2 C
+
ff
, с
jsj R
k (s)k N 
1
R 
2
:
Так как   =
 
N
, то для s2 C
+
ff
, сjsj  R второй множитель удовлетворяет
неравенству
k (s)k 
 
1
R 
2
N
: (22)
Выберем N
0
так, чтобы
 
1
 
1
R 
2
N
0
< 1;
тогда, принимая во внимание неравенства (19) и (22), приходим к вы-
воду, что для любого N   N
0
условие (17) выполнено на множестве
fsjs2C
+
ff
;jsj Rg. Теорема доказана.
6 Заключение
В работе предложен новый класс динамических регуляторов, стабилизиру-
ющих систему с запаздываниями в состоянии и управлении. Показано, что
при замене интегральных слагаемых конечными суммами, типа сумм Рима-
на, замкнутая система остаётся экспоненциально устойчивой. Для простоты
изложения разобран случай систем с одним запаздыванием в состоянии и од-
ним запаздыванием в управлении. Стоит отметить, что предложенную схему
построения регуляторов легко обобщить как на случай систем с нескольки-
ми запаздываниями в состоянии, так и на случай систем с распределённым
запаздыванием.
Список литературы
[1] Arstein Z. Linear systems with delayed controls: A reduction. IEEE Trans.
on Automatic Control, 1982, 27, pp. 869–879.
[2] Bellman R., Cooke K.L. Differential Difference Equations. New York:
Academic Press, 1963. 462 p.
[3] GuK.Areviewofsomesubtletiesofpracticalrelevancefortimedelaysystems
of neutral type. ISRN Applied Mathematics, 2012, Article ID 725783, 46 p.

[4] Engelborghs K., Dambrine M., Roos D. Limitation of a class of stabilization
methods for delay systems. IEEE Trans. on Automatic Control, 2001, 64, pp.
336–339.
[5] Fiagbedzi Y., Pearson A. Feedback stabilization of linear autonomous time
lag systems. IEEE Trans. on Automatic Control, 1986, 31, pp. 847–855.
[6] Jankovic M. Recursive predictor design for state and output feedback
controllers for linear time delay systems. Automatica, 2010, 46, pp. 510–517.
[7] Kharitonov V.L. An extension of the prediction scheme to the case of systems
with both input and state delay. Automatica, 2014, 50, pp. 211–217.
[8] Kwon W., Pearson, A. Feedback stabilization of linear systems with delayed
control. IEEE Trans. on Automatic Control, 1980, 25, pp. 266–269.
[9] Mazenc F., Mondie S., Niculescu S., Conge P., Lorraine L., Metz, F. Global
asymptotic stabilization for chains of integrators with a delay in the input.
IEEE Trans. on Automatic Control, 2003, 48, pp. 57–63.
[10] MondieS.andMichielsW.Finitespectrumassignmentofunstabletime-delay
systems with a safe implementation. IEEE Trans. on Automatic Control,
2003, 48, pp. 2207–2212.
[11] Manitius A.Z., Olbrot, A.W. Finite spectrum assignment for systems with
delay. IEEE Trans. on Automatic Control, 1979, 24, pp. 541–553.
[12] Van Assche V., Dambrine M., Lafey J.F., Richard J.P. Some problems arising
in implementation of distributed-delay control laws. 38th IEEE Conference
on Decision and Control, 1999, Phoenix, AZ.
[13] Palmor Z.J. Time-delay compensation, Smith predictor and its modiﬁcations.
The Control Handbook (W.S. Levine, Eds.), CRC Press, 1996, pp. 224–237.
[14] Zhou B. Input delay compensation of linear systems with both state and
input delay by nested prediction. Automatica, 2014, 50, pp. 1434–1443.
Электронный журнал. http://www.math.spbu.ru/diffjournal 65
