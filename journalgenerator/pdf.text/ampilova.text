dx
dt
6
 
-
?
DIFFERENTIAL EQUATIONS
AND
CONTROL PROCESSES
N 1, 2011
Electronic Journal,
reg. N  C77-39410 at 15.04.2010
ISSN 1817-2172
http://www.math.spbu.ru/diffjournal
e-mail: jodiff@mail.ru
Symbolic dynamics
On application of balance method to approximation of invariant
measures of a dynamical system
N.B. Ampilova, ampilova@math.spbu.ru
E.I.Petrenko, evgeni.petrenko@mail.ru
Math.and Mech. Faculty, St.Petersburg State University, Universitetskii pr.
28, Starii Petergof,195504 St.Petersburg, Russia
Abstract
Invariant measures of a dynamical system describe the asymptotic behaviour of its or-
bits, hence the elaboration of numerical methods of their approximation is of considerable
importance in applications. We use the concept of symbolic image which is a  nite ap-
proximation of a dynamical system. Symbolic image is constructed as an oriented graph
for a mapping f and a  xed covering of its phase space. Vertices of the graph correspond
to the cells of the covering and edges mark the existence of nonempty intersections of the
covering cells with their images. We construct an invariant measure (stationary process)
on the graph of symbolic image, which is the approximation of an invariant measure of the
initial system. Application of balance method allows us to construct an invariant measure
in such a way to assign the measure to all edges of the graph.
key words:dynamical system, symbolic image, entropy, stationary process
on a graph, linear programming
37M25, D5C85
1 Introduction
This paper is devoted to the elaboration of numerical methods of the construc-
tion of an invariant measure of a dynamical system using the notion of symbolicDifferential Equations and Control Processes, N 1, 2011
image [6] | a directed graph constructed by the system and its  nite covering.
The advantage of such a method is that many problems (localization of peri-
odic orbits and invariant sets, estimation of Lyapunov exponents, estimation of
topological entropy) may be solved by using well known algorithms for directed
graphs.
We consider a method of the construction of an invariant measure on a
directed graph. It was shown in [8] that such a measure is an approximation of
an invariant measure of the initial system. The algorithm of the construction
of such a measure using prime cycles was designed and implemented in [1]. In
a prime cycle withl edges the value 1=l is assigned to every edge. A coe cient
(weight) is designated to every prime cycle, being the sum of weights equals to
one. The measure of the edge belonging to more than one cycle is de ned as
the sum of the measures which the edge has in every cycle. If an edge does not
belong to any cycle, its measure is zero. The measure of a vertex is the sum of
measures of outcoming (or incoming ) edges. This method, while clear, has an
evident disadvantage: the number of prime cycles may be very signi cant and
the algorithm becomes time-consuming. An optimization may lead to cycles
missing. Hence, the measure is not assigned to all edges of the graph.
The method proposed in this work is aimed at the construction of an invari-
ant measure, such that to assign a value to every edge. To solve the problem
we formulate it as a task of linear programming. It allows us to construct
a stationary process on the graph (with a given accuracy), using a method
of the sequential balance of the vertices measures. L.M. Bregman proved the
convergence of the method in [2].
The paper is organized as follows: next section is dedicated to the notion
of symbolic image. In section 3 de nitions of Markov chain, stationary process
on a graph and its entropy are given. Section 4 describes the algorithm of the
construction of the invariant measure. In the next section halting criteria of the
algorithm are  ven. Finally, in sections 6 and 7 we give examples of entropy
estimation and summarize our results.
2 Symbolic image of a dynamical system
Let   be a discrete dynamical system generated by a homeomorphism f on a
compact M2 R
n
: Symbolic image of a dynamical system f [6] is an oriented
graph G, constructed in accordance with a coveringfM
i
g;i = 1;:::;k of M
by closed sets, being vertices correspond to the covering cells and the existence
Electronic Journal. http://www.math.spbu.ru/diffjournal 73Differential Equations and Control Processes, N 1, 2011
of the edge (i;j) means that f(M
i
)\M
j
6=;: The symbolic image is a  nite
approximation of the system f.
It depends on the covering and may be speci ed by the following parameters:
d | diameter of the covering (the largest of diameters of M
i
); q | upper
bound of the symbolic image (the largest of diameters of f(M
i
)); r | lower
bound of the symbolic image, which is the minimum of the distances between
f(M
i
) andM
j
, iff(M
i
)\M
j
=;: Being a relationship between the parameters
and an value " is given, there is a correspondence between the "-orbits of the
system and paths on G [9]. The construction of a sequence of symbolic images
corresponding to a sequential subdivision of the set M results in obtaining
sequential approximations of the system dynamics.
3 Markov chain on a graph
Consider an oriented graph G = (V;E):
De nition 1 [5] A Markov chain   on a graph G = (V;E) is an assignment
of probabilities  (I)  0;I2V and conditional probabilities  (ejb(e))  0 such
that
P
I2V
 (I) = 1;
P
e2E
I
 (ejI) = 18I 2 V; where E
I
denotes the set of
edges outcoming from I; b(e) denotes the beginning of the edge e and  (e) =
 (b(e)) (ejb(e)):
Let a row vector p be the initial state distribution, such thatp
I
= (I) and
the conditional probabilities  (ejI) form a stohastic square matrix de ned by
P
IJ
=
P
e2E
J
I
 (ejI); where E
J
I
denotes the set of edges outcoming from I and
incoming to J:
De nition 2 [5] The Markov chain is said to be stationary if the equality
pP = p (1)
holds.
Taking into account the de nition of Markov chain, it easy to understand
that stationarity condition means the following: for any vertex the sum of
measures of incoming edges equals to the sum of measures of outcoming ones.
It is well known [10] that the entropy of Markov process may be computed
by the formula
h( ) = 
P
e2E(G)
 (b(e)) (ejb(e)) log( (ejb(e))): (2)
Electronic Journal. http://www.math.spbu.ru/diffjournal 74Differential Equations and Control Processes, N 1, 2011
For practical computation we use the equivalent form
h( ) =
P
b(e)2V
 (b(e)) log( (b(e))) 
P
e2E
 (e) log( (e)): (3)
LetG be an irreducible graph. Then the entropy of every stationary process
  on G satis es the inequality [5]
h( )  log ; (4)
where   is the maximal eigenvalue of the adjacency matrix of G: If G is an ar-
bitrary graph then in (4)  is the maximal value of eigenvalues of all irreducible
components of G:
4 Construction of an invariant measure  
Assign probabilities to all edges of the graph G arbitrary. Denote by P =
fp
ij
g;i;j = 1;:::;n; the matrix formed by these values. Our goal is to transform
P in such a way to obtain a stationary process on G:
This problem may be formulated as a part of the following linear program-
ming task.
Maximize the function
P
i;j
x
ij
ln
p
ij
x
ij
on conditions
P
n
j=1
x
ij
=a
i
;
P
n
i=1
x
ij
=b
j
;x
ij
  0;
P
n
i=1
a
i
=
P
n
j=1
b
j
;a
i
;b
j
> 0;p
ij
  0;
P
i;j
x
ij
= 1:
(5)
Our problem may be considered as a particular case when a
i
= b
i
;i =
1;:::;n:
A method of approximative solution of (5) based on the successive balance
of rows and columns ofP was proposed by G.V.Sheleihovsky. L.M.Bregman [2]
proved its convergence. In [3] L.M.Bregman supposed and proved the relaxation
method to solve both convex and linear programming tasks, which coincided
with Sheleihovsky method for the tasks with linear restrictions.
Order elements x
ij
on rows and form vector x =fx
k
g;k = 1;:::;m, where
m  n
2
; (all x
k
are different). Consider S =fx2 R
m
;x
k
> 0;k = 1;:::;mg.
Let f be a strictly convex function, f2 C
1
(S) and f2 C
0
(S): Then (5) may
be formulated in the following way:
Minimize the function
P
k
x
k
ln
x
k
p
k
on linear restrictions
Ax =b; (6)
Electronic Journal. http://www.math.spbu.ru/diffjournal 75Differential Equations and Control Processes, N 1, 2011
where x2 S;b2 R
n
, A is [n m] matrix. In such a form our problem is
formulated with A as (1,-1) matrix and b = 0:
It was proved in [3] that a sequencefx
l
g converges to a solution of (6) if
the following conditions are ful lled
gradf(x
l+1
) =gradf(x
l
) + A
i
;
(A
i
;x
l+1
) =b
i
;
(7)
where   is unknown parameter, A
i
is i
th
row of A and b
i
is the right part of
i
th
equation in the linear restrictions (6). The solving of (7) leads to obtaining
both   and the formula of transformation for x
ij
:
x
l+1
ij
=x
l
ij
s
in(i)
out(i)
;
for i
th
row and
x
l+1
ki
=x
l
ki
s
out(i)
in(i)
fori
th
column, beingin(i) andout(i) are sums of elements in columni and row
i respectively. It should be noted that diagonal elements are not changed.
Algorithm. Denote the given accuracy of computation by ": Let i2 V
and
beg(i) =fe2E;e = (i;j);j2Vg;
end(i) =fe2E;e = (j;i);j2Vg:
  Assign measures to all edges of G. As the normalization step may be
ful lled at the and of operating period, we assume  (e) = 1;8e2E:
  For each vertex i calculate its balans
q(i) =j
X
e2beg(i)
 (e) 
X
e2end(i)
 (e)j:
Construct the queueQ of the vertices ofG, being a vertexi with the max-
imum q(i) has the maximum priority. So, we assign the greatest priority
to the most unbalanced vertex.
  In the cycle: select the next vertex i from Q.
Electronic Journal. http://www.math.spbu.ru/diffjournal 76Differential Equations and Control Processes, N 1, 2011
{ If q(i) < ", then complete the processing of i and go out from the
cycle. (In view of the structure of Q such an inequality holds for all
remaining elements.)
{ Else calculate
  out(i) =
P
e2beg(i)
 (e)
  in(i) =
P
e2end(i)
 (e)
 8e2end(i) (e) := (e) 
q
out(i)
in(i)
.
 8e2beg(i) (e) := (e) 
q
in(i)
out(i)
.
  If some of values out(i);in(i);
q
out(i)
in(i)
is too large (or small), we
ful ll the normalization.
  Ful ll the normalization. The algorithm is completed.
To provide the e ciency of the algorithm we have to save both forth and back
directions of the edges, which results in the representation of the graph with
using two hash-tables. Priority queue has been implemented using Fibonacci
trees [4].
5 Halting problem
LetC
v
be the volume of a cellC corresponding to a vertexv;jVj be the number
of vertices and" be a given accuracy. We consider the following criteria for the
algorithm halting:
1. Maximal discrepancy is not greater than ".
max
v2V
q
k
(v)<": (8)
2. Maximal discrepancy divided by the cell volume is not greater than ".
max
v2V
q
k
(v)<"C
v
: (9)
3. The sum of discrepances over all vertices at the step k is not greater than
".
X
v2V
 
 
 
 
 
X
e2V
m
k
ev
 
X
t2V
m
k
vt
 
 
 
 
 
<": (10)
Electronic Journal. http://www.math.spbu.ru/diffjournal 77Differential Equations and Control Processes, N 1, 2011
4. The average sum of discrepances over all vertices at the stepk is not greater
than ".
X
v2V
 
 
 
 
 
X
e2V
m
k
ev
 
X
t2V
m
k
vt
 
 
 
 
 
<"jVj: (11)
5. The sum of discrepances over all vertices at the step k divided by the cell
volume is not greater than ".
X
v2V
 
 
 
 
 
X
e2V
m
k
ev
 
X
t2V
m
k
vt
 
 
 
 
 
<"C
v
: (12)
6. The sum of variation of vertices weights for 1 step is not greater than ".
X
v2V
 
 
m
k
v
 m
k+1
v
 
 
<": (13)
7. The sum of variation of vertices weights for 1 step divided by the cell
volume is not greater than ".
X
v2V
 
 
m
k
v
 m
k+1
v
 
 
<"C
v
: (14)
8. The sum of variation of edges weights for 1 step is not greater than ".
X
(i!j)2E
 
 
m
k
ij
 m
k+1
ij
 
 
<": (15)
9. The sum of variation of edges weights for 1 step divided by the cell volume
is not greater than ".
X
(i!j)2E
 
 
m
k
ij
 m
k+1
ij
 
 
<"C
v
: (16)
The rate of convergence was estimated experimentally for
  Henon map
 
x
y
!
!
 
1 ax
2
+by
x
!
;
a = 1:4, b = 0:3;
Electronic Journal. http://www.math.spbu.ru/diffjournal 78Differential Equations and Control Processes, N 1, 2011
  Ikeda map
 
x
y
!
!
 
d   C
2
(x cos (x;y) y sin (x;y))
C
2
(x sin (x;y) +y cos (x;y))
!
;
where  (x;y) =C
1
 
C
3
1+x
2
+y
2
;d = 2;C
1
= 0:4;C
2
= 0:9;C
3
= 6;
  Du ng system
_ x = y;
_ y = x x
3
  0:1y:
The number of steps equals 100 000 and " = 10
 5
. The dependence of the
number of steps from a halting criteria is shown in table 1. and run time | in
table 2.
Electronic Journal. http://www.math.spbu.ru/diffjournal 79Differential Equations and Control Processes, N 1, 2011
System Step Vert. Edge 1 2 3 4 5 6 7 8 9
Henon 6 138 433 1 194 2 394 2 337 1 034 1 034 1 194 2 394 1 194 2 394
8 866 2 802 9 494 1 1 7 627 7 627 9 494 1 9 495 1
10 4 692 15 350 30 543 1 1 18 622 18 622 30 543 1 30 543 1
12 25 000 81 458 29 649 1 1 11 063 11 063 29 649 1 29 649 1
14 143 345 467 347 8 167 1 1 1 1 8 176 1 8 167 1
Ikeda 6 1 145 5 348 12 219 77 103 1 9 664 9 664 12 219 77 103 12 219 77 104
8 10 750 49 779 40 421 1 1 18 859 18 859 40 421 1 40 421 1
10 104 799 482 427 3 522 1 1 1 1 3 526 1 3 522 1
Du ng 6 6 252 25 116 94 434 1 1 16 892 16 892 94 434 1 89 096 1
8 55 528 227 147 2 153 1 1 1 1 2 153 1 1 683 1
10 757 622 3 119 866 2 1 1 1 1 2 1 1 1
Table 1: Convergence of balance method
Electronic Journal. http://www.math.spbu.ru/diffjournal 80Differential Equations and Control Processes, N 1, 2011
System Step Vert. Edge 1 2 3 4 5 6 7 8 9
Henon 6 138 433 46ms 125ms 125ms 31ms 31ms 46ms 125ms 78ms 140ms
8 866 2 802 828ms 1 1 656ms 656ms 828ms 1 828ms 1
10 4 692 15 350 11s 1 1 6s 6s 11s 1 11s 1
12 25 000 81 458 48s 1 1 18s 18s 48s 1 48s 1
14 143 345 467 347 77s 1 1 3s 3s 77s 1 77s 1
Ikeda 6 1 145 5 348 2s 11s 1 1s 1s 2s 11s 2s 11s
8 10 750 49 779 41s 1 1 19s 19s 41s 1 41s 1
10 104 799 482 427 36s 1 1 2s 2s 36s 1 36s 1
Du ng 6 6 252 25 116 48s 1 1 9s 9s 48s 1 46s 1
8 55 528 227 147 11s 1 1 921ms 921ms 11s 1 8s 1
10 757 622 3119 866 33s 1 1 33s 33s 33s 1 33s 1
Table 2: Run time for balance method
Electronic Journal. http://www.math.spbu.ru/diffjournal 81Differential Equations and Control Processes, N 1, 2011
Subdivision Nodes Entropy log 
9  2
2 6
231 1.384079 1.386763
Table 3: Entropy estimation for Henon map
Subdivision Nodes Entropy log 
9  2
2 6
162 0.916999 0.940517
9  2
2 12
1 032 0.729919 0.731549
9  2
2 11
672 0.756997 0.779899
Table 4: Entropy estimation for logistic map
6 Entropy estimation
To obtain the value of the entropy according to the constructed measure we use
formula (3).
Example 1 For Henon map consider area D = [ 10; 10]  [ 10; 10] and use
both linear and punctual methods [11] to construct a symbolic image. The initial
partition consists from 9 cells. On each step every cell is subdivided in 4 cells.
Construct an invariant measure on the symbolic image and estimate the entropy
for this measure.
In table 3 the number of nodes, the entropy and the estimation of the entropy
by (4) are given.
Example 2 Consider logistic map f(x) = ax(1 x);x2 [0; 1]; for a = 4 and
a = 3:569: The results are given in table 4.
7 Conlusion
In this paper a numerical method of the construction of a approximation to an
invariant measure of a dynamical system is considered. Such an approximation
may be obtained as a stationary process ( an invariant measure) on the graph of
a symbolic image of the initial system. A measure is assigned to all edges of the
graph using a linear programming technique. Experimental data about the rate
of convergence are given. The entropy of the stationary process on a graph with
Electronic Journal. http://www.math.spbu.ru/diffjournal 82Differential Equations and Control Processes, N 1, 2011
regard to the obtained invariant measure is computed. Numerical experiments
show that this value less than the entropy of corresponding topological Markov
chain.
Acknowledgements
Authors are greatly indebted to J.V.Romanovsky for suggesting the problem
and for many stimulating conversations.
References
[1] Ampilova N. B. On the construction of an invariant measure of a sym-
bolic image, Int.Congress Nonlinear dynamical analysis-2007 , June 4-8 2007,
(St.Petersburg, Russia) p. 359.
[2] Bregman L. M. The proof of convergence of the Sheleihovsky method for the
problem with transport constraints (in Russian), Journal of computational
mathematics and mathematical physics, 7(1) (1967), pp. 147{156.
[3] Bregman L. M. Relaxation method for obtaining common point of convex
sets and its application to the solving convex programming tasks. Journal
of computational mathematics and mathematical physics, 7(3) (1967), pp.
620{631.
[4] Cormen T., Leiserson C., Rivest R., Introduction to algorithms (in Russian)
(M., 2001).
[5] Lind D., Marcus B. An introduction to symbolic dynamics and coding, New
York, 1995.
[6] Osipenko G.S. On symbolic image of a dynamical system(in Russian) In
Boundary problems, Perm, 1983, pp. 101{105.
[7] Osipenko G. S., Ampilova N.B. Introduction to symbolic analysis of dynam-
ical systems (in Russian), (SPbGU, 2005).
[8] Osipenko G. S. On approximation of invariant measures of dynamical sys-
tems(in Russian), E-Journal Differential equations and control processes,
 2,2008
Electronic Journal. http://www.math.spbu.ru/diffjournal 83Differential Equations and Control Processes, N 1, 2011
[9] Osipenko G. S. Dynamical Systems, Graphs, and Algorithms, Lect.Notes in
Math., 1889, (Springer, 2007).
[10] Petersen, K. Ergodic Theory, Cambridge Univ.Press. (Cambridge, 1989).
[11] Petrenko, E. I. Design and implementation of the algorithms of construc-
tion of a symbolic image. E-Journal Differential equations and control pro-
cesses,  3, 2006.
Electronic Journal. http://www.math.spbu.ru/diffjournal 84
