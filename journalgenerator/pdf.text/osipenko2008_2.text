
\begin{center}
{\Large {\bf 
 К ВОПРОСУ ОБ АППРОКСИМАЦИИ ИНВАРИАНТНЫХ МЕР

\bigskip

 ДИНАМИЧЕСКИХ СИСТЕМ
}}

\bigskip

Осипенко Г.С.

Санкт-Петербургский государственный политехнический университет
%, Крупин А.В. и Безручко А.А.

george.osipenko@mail.ru
%Севастопольский национальный технический университет

\end{center}


\section{Введение}
Настоящую статью можно рассматривать 
как продолжение работы \cite{OSejournal2007}. 
Пусть $f:M\to M$ гомеоморфизм компактного многообразия $M\subset R^d$,
порождающий дискретную динамическую систему $\{ f^k,\ k\in Z\}$.
Мера $\mu$ на $M$ называется инвариантной для $f$, если
для любого измеримого
%(по Борелю)
множества $A\subset M$ выполнено равенство
$$
\mu(f^{-1}(A))=\mu(A)=\mu(f(A)).
$$
Теорема Крылова-Боголюбова \cite{bogolubov} гарантирует,
что существует  мера $\mu,$ инвариантная для $f$ и  нормированная на 
$M$: $\mu(M)=1$.
Известно \cite{katok}, что множество всех $f$-инвариантных мер
${\cal M}(f)$ является выпуклым замкнутым компактом в слабой топологии.
Сходимость $\mu_n\to \mu$ в этой топологии означает, что
$$
\int_M \phi d\mu_n\to \int_M \phi d \mu
$$
для любой непрерывной функции $\phi :M\to R$.
Наша цель состоит в конструктивном построении множества всех инвариантных мер
${\cal M}(f)$.
В работе \cite{OSejournal2007} указан алгоритм, который позволяет 
построить любую инвариантную меру.
Для решения поставленной задачи 
используется следующая конструкция символического образа
динамической системы \cite{osipenko1983, osipenko2007}.
Пусть $C=\{M(1),\ M(2),\ \dots ,\ M(n)\}$ конечное покрытие области $M$,
$M(i)$ --- ячейка покрытия.
Символический образ $G$ --- это ориентированный граф (орграф),
у которого каждая вершина (узел)
 $i$ соответствует ячейке $M(i)$ и дуга
$i\to j$ существует тогда и только тогда, когда
$f(M(i))\cap M(j)\ne \emptyset$.

В общем случае никаких ограничений на покрытия не налагается,
но мы будем считать, что $C$ является разбиением с измеримыми
связными ячейками.
При численных расчетах ячейками являются параллелепипеды,
которые могут пересекаться только по границам.
Если допускается замкнутое покрытие, то параллелепипеды выбираются замкнутыми.
Когда $C$ является измеримым разбиением, параллелепипеды надо 
выбрать полуоткрытыми,
приписывая граничные диски к одной из примыкающих ячеек.
\begin{definition}
Пусть $G$ абстрактный ориентированный граф. 
Потоком на $G$ называется распределение
$\{m_{ij}\}$ на дугах $\{i\to j\}$ такое, что
%\begin{itemize}\item 
$m_{ij}\ge 0,$
%\item 
\begin{equation}
\label{odin}
\sum _{ij}m_{ij}=1,
\end{equation}
%\item 
и для любой вершины $i$ имеет место равенство 
\begin{equation}
\label{kirkhof}
\sum_{k} m_{ki}= \sum_{j} m_{ij}.
\end{equation}
%\end{itemize}
\end{definition}
Последнее свойство инвариантности можно трактовать как закон Кирхгофа:
для каждой вершины входящий поток равен исходящему потоку.
Иногда в теории графов описанное распределение называют
замкнутым или инвариантным потоком.
Для потока $\{m_{ij}\}$ на графе $G$ мы можем определить меру вершины $i$ как
 $$m_i= \sum_{k} m_{ki}= \sum_{j} m_{ij}.$$
В таком случае получаем равенство $\sum_i m_i=1.$
Поток на символическом образе позволяет построить меру $\mu^*$ на $M$,
полагая
\begin{equation}
\label{lebesgue}
\mu^*(A)=\sum_i m_i v(A\cap M(i))/v(M(i)),
\end{equation}
где $v$ --- нормированная на $M$ мера Лебега.
Предполагается, что мера Лебега каждой ячейки
$v(M(i)) \ne 0$. В этом случае мера ячейки
$M(i)$ совпадает с мерой вершины $i$:
$$
\mu^*(M(i))=m_i.
$$
Вообще говоря, построенная мера $\mu^*$ не является инвариантной для $f$.
Однако, мы покажем, что 
эта мера является приближением к некоторой инвариантной мере.

\begin{definition}
Пусть $Q$ и $G$ --- ориентированные графы, отображение
$s:\ Q\to G $ является отображением графов, если $s$ отображает вершины и 
дуги графа $Q$ в вершины и дуги графа $G$ и эти отображения согласованы.
Иначе говоря, если $k$ и $l$ --- вершины на $Q$, $s(k)=i,\ s(l)=j$ и
существует  дуга $k\to l$, тогда существует дуга $i\to j$ на $G$
и $s(k\to l)=i\to j$. При этом верно и обратное: если
$s(k\to l)=i\to j$, то $s(k)=i$ и $s(l)=j.$
\end{definition}
Напомним, что вершина называется возвратной, если существует
периодический путь, проходящий через нее.
Две возвратные вершины эквивалентны, если существует общий периодический путь,
проходящий через них. Класс эквивалентных возвратных вершин 
называется  компонентой сильной связности графа.
Отображение графов порождает отображение (допустимых) путей,
а периодический путь отображается на периодический путь,
при этом период может уменьшиться, вообще говоря.
Возвратные вершины отображаются на возвратные вершины, при этом
 эквивалентные возвратные
вершины отображаются в эквивалентные. Следовательно,
компоненты сильной связности отображаются в компоненты сильной связности.
В \cite{OSejournal2007} доказано
\begin{proposition}
\label{mesure}
Пусть $Q$ и $G$ --- орграфы, $s:\ Q\to G $ является отображением орграфов 
 и на $Q$ существует поток $m$. Тогда на $G$ индуцируется поток
$m^*=s^*(m )$ такой, что для дуги $i\to j\ \in G$
$$m^*_{ij}=\sum_{s(p\to q)=i\to j}m_{pq},$$
где сумма берется по всем дугам $p\to q$, которые отображаются на $i\to j.$
Если дуга $i\to j$ не имеет прообразов, то $m^*_{ij}=0$.
\end{proposition}
Это утверждение позволяет построить потоки на произвольном орграфе. 
Например, 
пусть на графе $G$ существует периодический путь $\omega$ периода $N$.
Тогда на $G$ имеется поток $m^*$ такой, что $m^*_{ij}=k_{ij}/N$, где
$k_{ij}$ это количество  прохождений пути $\omega$ через дугу $i\to j$.
Здесь граф $Q$ состоит из одного простого
периодического цикла периода  $N$, т.е. $Q=\{1\to 2\to\dots\to N\to 1\}$.
Отображение $s:\ Q\to G $  укладывает простой цикл
$Q$ на периодический путь $\omega$. 
Детали доказательства см. в \cite{OSejournal2007}.

Пусть $G$ --- абстрактный ориентированный граф, имеющий $n$ вершин.
Рассмотрим пространство ${\cal M}(G)=\{m\}$ всех потоков на $G$.
Пусть  $m^1=\{m^1_{ij}\}$ и $m^2=\{m^2_{ij}\}$
 два  потока, числа $\alpha,\ \beta \ge 0$ и $\alpha +\beta=1$.
Тогда, как нетрудно проверить, распределение
$m=\alpha m^1+\beta m^2=\{\alpha m^1_{ij}+\beta m^2_{ij}\}$
также является потоком.
При этом мы будем говорить, что поток $m$ является суммой потоков
$m^1$ и $m^2$ с весами  $\alpha$ и $\beta$.
Таким образом, пространство  всех потоков ${\cal M}(G)$
является выпуклым.

Исследуем структуру выпуклого множества ${\cal M}(G)$.
 Пусть $\omega=(i_1\to i_2\to \cdots\to i_k\to i_1)$ ---
простой периодический путь (цикл),
т.е. все вершины $\{i_t,\ t=1,2,\dots ,k\}$ различны.
Построим простой поток $m(\omega)$, сосредоточенный на этом цикле.
Для этого положим $m_{ij}=1/k$ для всех дуг периодического пути $\omega$ и
$m_{ij}=0$ для всех остальных дуг.
Очевидно, что простой поток обладает свойством инвариантности,
является единственным потоком, сосредоточенным на $\omega$
и не раскладывается в сумму других потоков.
Таким образом $m(\omega)$ является крайней точкой множества
потоков ${\cal M}(G)$.
Так как число вершин конечно, то число простых циклов и простых потоков тоже
конечно.
В \cite{OSejournal2007} доказано
\begin{proposition} 
\label{simple}
Любой поток $m\in {\cal M}(G)$ раскладывается в сумму
простых потоков.
\end{proposition}
Таким образом, необходимым условием существования потока, сосредоточенного 
на некотором множестве дуг
$P\subset G$, является наличие циклов в $P$.

\section{Аппроксимация множества инвариантных мер ${\cal M}(f)$ потоками из ${\cal M}(G)$.}

Рассмотрим гомеоморфизм $f:M\to M$, измеримое разбиение
$C$ и символический образ $G$, порожденный данным разбиением.
Исследуем, что происходит с пространством потоков ${\cal M}(G)$
 при последовательном измельчении покрытий.
Пусть покрытие $C$ подвергается подразбиению, т.е. каждая ячейка
$M(i)$ разбивается
на несколько ячеек $M(i1),\ M(i2),\ \dots $ так, что $M(i)=\bigcup _kM(ik)$.
Таким образом, мы получаем новое покрытие
$NC$ и новый символический образ $NG$.
Нумерация вершин на $G$ и $NG$ задается в виде $\{i\}$ и $\{(ik)\}$
соответственно. 
Новое покрытие $NC$ построено как подразбиение покрытия $C$, что порождает  
естественное отображение $s:\ NG\to G$,
которое  имеет очень простой вид $s(ik)=i$. Поскольку $M(ik)\subset M(i)$,
то $s$ является отображением ориентированных графов, т.е.
если на $NG$ имеется дуга $(ik)\to (jl)$, то на $G$ существует дуга $i\to j$.
 Отображение $s$ позволяет перенести любой поток на $NG$ в поток на $G,$
как это описано в предыдущем разделе, т.е. построить отображение
$s^*:{\cal M}(NQ)\to {\cal M}(G)$, 
где ${\cal M}(G)$ и ${\cal M}(NG)$ множество потоков на
$G$ и $NG$, соответственно.
Действительно, пусть на  $NG$ имеется поток $m=\{m_{ik,jl}\}$,
 т.е. каждой дуге
$(ik)\to (jl)$ приписана мера $m_{ik,jl}$, для которой выполнены равенства

$$\sum_{ikjl} m_{ik,jl}=1,$$

$$ \sum_{kp} m_{kp,iq}= \sum_{jl} m_{iq,jl}.$$    

\noindent Поток $s^*(m)=\{m_{ij}\}$ на графе $G$ определяется равенством

$$m_{ij}=\sum_{kl} m_{ik,jl},$$

\noindent т.е. мера дуги $i\to j$ является суммой мер тех дуг
$(ik)\to (jl)$, которые проектируются
на $i\to j$  отображением $s:\ NG\to G$.
Ясно, что $s^*({\cal M}(NG))\ne {\cal M}(G)$, вообще говоря.
Для любых двух потоков $m\in {\cal M}(NG)$ и $m^*\in {\cal M}(G) $
будем говорить, что они согласованы, если $s^*(m)=m^*$.

Теперь рассмотрим последовательные подразбиения
$C_1,\ C_2,\ C_3,\ \dots $ такие, что максимальный диаметр ячеек разбиений
$d_1,\ d_2,\ d_3,\ \dots \to 0.$
Такая последовательность порождает последовательность символических образов
$G_1,\ G_2,\ G_3,\ \dots $ и отображений $s:\ G_k\to G_{k-1}$,
$s^*: {\cal M}(G_k)\to {\cal M}(G_{k-1})$.
Таким образом, определены последовательности вида:
$$
G_1\stackrel{s}\longleftarrow G_2\stackrel{s}\longleftarrow G_3\stackrel{s}
\longleftarrow \dots .
$$
и
$$
{\cal M}(G_1)\stackrel{s^*}\longleftarrow {\cal M}(G_2)\stackrel{s^*}
\longleftarrow {\cal M}(G_3)\stackrel{s^*}\longleftarrow \dots .
$$
Отображение $f:M\to M$ можно трактовать как бесконечный 
граф с вершинами $x\in M$ и 
 ребрами  $x\to f(x)$. Для любого символического образа $G$ 
существует отображение $s:M\to G$ вида $s(x)=\{i|\ x\in M(i)\}$,
т.е. точке $x$ сопоставляется номер ячейки, в которой она лежит.
Данное отображение является отображением ориентированных графов.
Мы получаем последовательность вида
\begin{equation}
\label{pp}
G_1\stackrel{s}\longleftarrow G_2\stackrel{s}\longleftarrow G_3\stackrel{s}
\longleftarrow \dots \stackrel{s}\longleftarrow\{f:M\to M\}.
\end{equation}
Для любого символического образа $G$ существует отображение
$s^*:{\cal M}(f)\to {\cal M}(G)$, которое задается по формуле
$$
s^*(\mu)=m=\{m_{ij}=\mu (M(i)\cap f^{-1}(M(j)))\},
$$
где $M(i), \ M(j)$ ячейки символического образа $G$.
Последовательность (\ref{pp}) порождает последовательность вида
\begin{equation}
{\cal M}(G_1)\stackrel{s^*}\longleftarrow {\cal M}(G_2)\stackrel{s^*}
\longleftarrow {\cal M}(G_3)\stackrel{s^*}\longleftarrow \dots 
\stackrel{s^*}\longleftarrow {\cal M}(f).
\end{equation}

Пусть на каждом символическом образе $G_k$ выбран поток
$m^k\in {\cal M}(G_k)$, причем эти потоки согласованы, т.е.
$$
s^*(m^{k+1})=m^k.
$$
Используя меру Лебега, построим  меру $\mu_k$ на $M$ для каждого $k$:
\begin{equation}
\label{ll}
\mu_k(A)=\sum_i m^k_i v(A\cap M(i))/v(M(i)),
\end{equation}
где  $A$ --- измеримое множество, $M(i)$ --- ячейки разбиения $C^k$,
$v$ --- лебегова мера, нормированная на $M$. 
В результате получена последовательность мер $\{\mu_k\}$ на многообразии $M$.
В \cite{OSejournal2007} доказана
\begin{theorem}
\label{tmesure}
Пусть $C_k$ --- последовательные подразбиения такие, что максимальный
диаметр ячеек $d_k \to 0$. Если $m^k$ согласованная последовательность
потоков на символических образах $G_k$, то существует  мера
$\mu$ инвариантная для $f$ такая, что
$$
\mu=\lim_{k\to \infty}\mu_k,
$$
где сходимость рассматривается в слабой топологии.
\end{theorem}

Теперь перейдем к изучению несогласованной последовательности потоков.
 Рассмотрим последовательность символических образов
$G_1,\ G_2,\ \cdots\ G_t,\ \cdots $ гомеоморфизма $f$ для последовательных
разбиений $C_1,\ C_2,\ \cdots\ C_t,\ \cdots $,
где максимальный диаметр ячеек $d_t\to 0$ при $t\to \infty$. 
Пусть на каждом символическом образе $G_t$ определен поток $m^t$. 
Потоки $m^t$, вообще говоря, не являются согласованными. 
Используя меру Лебега, по потокам $m^t$ построим последовательность мер 
$\mu_t$ на $M$ согласно формуле (\ref{ll}).
На каждом символическом образе $G_{\tau }$ 
определена последовательность потоков $m^{k}_{\tau}$,
которая получается проектированием потоков $m^{\tau +k}$ отображением
$s^*:{\cal M}(G_{\tau +k})\to {\cal M}(G_{\tau })$.
В пространстве потоков на любом символическом образе $G$ введем расстояние 
$\rho (m^1,m^2)=\sum_i|m^1_i-m^2_i|$,
где $m^*_i$ --- мера вершины $i$ или мера ячейки $M(i)$.

\begin{definition}
Будем говорить, что последовательность потоков $\{m^t\}$ сходится, 
если  последовательность проекций $\{ m^{k}_{\tau}\}$ 
сходится в метрике $\rho$ при $k\to \infty$ на каждом $G_{\tau }$. 
\end{definition}
\begin{theorem}
\label{theorem2}
Если последовательность потоков $\{ m^t\}$ сходится, то последовательность
мер $\{ \mu_t \}$ сходится к инвариантной мере в слабой топологии.
\end{theorem}
{\bf Доказательство.} На каждом символическом образе $G_{\tau }$ 
определен поток $m^*_{\tau}=\lim_{k\to \infty}m^{k}_{\tau}$. 
По построению потоки $m^*_{\tau}$ согласованы, т.е. 
$s^*(m^*_{\tau +1})=m^*_{\tau}$.
Согласно Теореме \ref{tmesure}, согласованная последовательность  
$\{m^*_{\tau}\}$
порождает последовательность мер $\mu^* _{\tau}$, 
которая сходится в слабой топологии к инвариантной мере $\mu$. 

Покажем, что последовательность $\{\mu_t \}$ тоже 
сходится в слабой топологии к мере $\mu$. Пусть $t=\tau +k$, 
$G_{\tau}$ --- символический образ для покрытия $C_{\tau}$ и 
$M(i)$ --- ячейки покрытия $C_{\tau}$.
Найдем 
$$
\int_M \phi d\mu_{t} - \int_M \phi d\mu=
\sum_i\int_{M(i)}\phi d\mu_{t} - \sum_i\int_{M(i)}\phi d\mu =
\sum_i\phi(x_i)m^t_i  - \sum_i \phi(x^*_i)m^*_i,
$$
где $m^t_i=\mu_t(M(i)) $, $m^*_i=\mu(M(i)) $, 
точки $x_i$ и $x^*_i$ лежат в ячейке $M(i)$ и определяются по теореме о среднем
для каждой ячейки $M(i)$.  По условию
$$
\sum_i|m^t_i-m^*_i|=\sum_i|\mu_t(M(i))-\mu^*(M(i))|=
\sum_i|m^k_{\tau}(M(i))-m^*_{\tau}(M(i))|=
\rho(m^k_{\tau},m^*_{\tau})\to 0
$$
при $k\to \infty$.
Оценим разность
$$
|\int_M \phi d\mu_{t} - \int_M \phi d\mu|=
|\sum_i[\phi(x_i)(m^t_i-m^*_i)+(\phi(x_i)-\phi(x^*_i))m^*_i]|\leq
$$
$$
||\phi||\sum_i|m^t_i-m^*_i|+\alpha (d_t)\sum_im^*_i =
||\phi||\rho(m^k_{\tau},m^*_{\tau})+\alpha (d_{\tau}),
$$
$||\phi||=\sup_M|\phi(x)|$, $d_{\tau}$ --- наибольший диаметр ячеек
$M(i)$, $\alpha (d)$ --- модуль непрерывности функции $\phi$.

Для доказательства сходимости $\mu_t \to \mu$ в слабой топологии
 надо показать, что для данной функции $\phi$ и 
любого $\epsilon >0$ существует номер $t_0$
такой, что 
$$
|\int_M \phi d\mu_{t} - \int_M \phi d\mu|<\epsilon
$$
при $t>t_0$.
Для этого по $\epsilon /2$ и $\phi$  найдем $\tau$ и 
$d_{\tau}>0$ такие, что
$\alpha (d_{\tau})<\epsilon /2$.
По $\tau,\ \epsilon /2$ и $||\phi||$ найдем  номер $k$ такой, что
$\rho(m^k_{\tau},m^*_{\tau})<\epsilon /(2||\phi||)$, при $1\leq ||\phi||$ и
$\rho(m^k_{\tau},m^*_{\tau})<\epsilon /2$,  при $||\phi||<1$. 
Положим $t_0=\tau+k$. При $t>t_0$ имеем
$$
|\int_M \phi d\mu_{t} - \int_M \phi d\mu|\leq
||\phi||\rho(m^k_{\tau},m^*_{\tau})+\alpha (d_{\tau})<
\epsilon /2+\epsilon /2=\epsilon.
$$
Таким образом, $\int \phi d\mu_{t} \to \int \phi d\mu$ при $t\to \infty$
и, следовательно, последовательность мер $\mu_{t}$ сходится к $\mu$
в слабой топологии.
Теорема доказана.
$$\odot$$
Если последовательность $\{m^t\}$ является согласованной, т.е. 
$s^*(m^{t +1})=m^{t}$, то $ m^{k}_{\tau}=m^{\tau}$ и 
последовательность  проекций
$\{ m^{k}_{\tau}\}$ сходится к $m^{\tau}$. Следовательно,
Теорема \ref{theorem2} является обобщением Теоремы \ref{tmesure}.
Однако данные теоремы не применимы к произвольной последовательности 
 потоков $\{m^t\}$,
т.е. такой которая может не удовлетворять условиям Теоремы \ref{theorem2}. 
Следующая теорема описывает свойства любой последовательности потоков.
\begin{theorem} 
\label{tri}
Пусть на последовательности символических образов $\{G_t\}$
гомеоморфизма $f$ определена последовательность потоков $\{m^t\}$
и максимальный диаметр разбиений $d_t\to 0$ при $t\to \infty$. Тогда
\begin{itemize}
\item существует подпоследовательность мер $\mu_{t_k}$ 
(построенных по формуле (\ref{ll})), сходящаяся 
в слабой топологии
 к мере $\mu$ инвариантной для $f$;
\item если некоторая подпоследовательность мер $\mu_{t_l}$ 
сходится в слабой топологии
 к мере $\mu^*$, то эта мера является инвариантной для $f$.
\end{itemize}
\end{theorem}
{\bf Доказательство.} 
Рассмотрим один из символических образов, например  $G_1$. 
Множество потоков на $G_1$ образует многогранник ${\cal M}_1$,
 который описывается 
как линейная оболочка простых потоков.
Каждый поток $m=\{m_{ij}\}$ является точкой в $R^N$, где 
$N$ --- число вершин. 
На ${\cal M}_{1}$ 
определено расстояние 
$\rho (m^1,m^2)=\sum_i|m^1_i-m^2_i|,\ \ \ m^*_i=\sum_jm^*_{ij}$.
Используя естественное отображение 
$s^*:{\cal M}(G_t)\to {\cal M}(G_1)={\cal M}_1$, 
перенесем потоки $m^t$ на граф $G_1$ и обозначим их 
$m^t_1$, т.е. $m^t_1=s^*(m^t)$. 
Таким образом, на компакте ${\cal M}_1$
 определяется последовательность
$\{m^t_1\}$, из которой можно выделить сходящуюся подпоследовательность.
Не ограничивая общности, будем считать, 
что исходная последовательность является сходящейся.
Пусть $m^*_1=\lim_{t\to\infty}m^t_1$.
Рассмотрим символический образ $G_2$, на котором построим аналогичным образом 
 поток $m^*_2$ как предел подпоследовательности
проекций $s^*(m^t)$ на ${\cal M}_2$.
Так можно построить $m^*_t$ на каждом символическом образе $G_t$.
Если взять диагональную последовательность $m^{t_k}$, то
для каждого символического образа $G_t$ проекции $s^*(m^{t_k})$ сходятся к 
$m^*_t$. 
Согласно Теореме \ref{theorem2} последовательность мер $\mu_{t_k}$ 
 сходится в слабой топологии к инвариантной мере $\mu$. 
Таким образом, первое утверждение теоремы доказано.

Доказательство второго утверждения.
 Пусть существует подпоследовательность мер, 
сходящаяся в слабой топологии к мере $\mu$. 
Не ограничивая общности, будем считать, 
что сходится исходная последовательность $\mu_t$. 
Согласно предыдущему утверждению, из последовательности
$\mu_t$ можно выделить подпоследовательность, 
которая сходится к инвариантной мер  $\mu^*$.
Из единственности предела следует равенство  $\mu^*=\mu$,
т.е. мера  $\mu$ --- инвариантна. 
Теорема доказана.
$$\odot$$
Предыдущие результаты относились к последовательностям потоков,
 построенных на символических образах для разбиений с
 максимальными диаметрами $d_k\to 0$. При этом мы получаем 
хорошее приближение инвариантной меры, если выполнены условия
Теорем \ref{tmesure} или \ref{theorem2}. Если условия не выполнены, то надо перейти к
  подпоследовательности приближений,
но как  строить такую подпоследовательность ---  неизвестно.
Ясно, что для практического 
построения инвариантной меры эти результаты мало пригодны.
 Поэтому
желательно иметь результат, гарантирующий, что индивидуальный
поток построенный для 
достаточно мелкого разбиения хорошо аппроксимирует некоторую
инвариантную меру.

\begin{theorem}
\label{theorem3}
Для любой окрестности (в слабой топологии) $U$ множества ${\cal M}(f)$ найдется положительное
число $d_0$ такое, что для всякого разбиения $C$ с максимальным диаметром
$d<d_0$ и любого потока $m$ на символическом образе $G$, построенного
 относительно разбиения $C$, мера $\mu$, 
построенная согласно (\ref{ll}) по  $m$, лежит в окрестности $U$.
\end{theorem}
{\bf Доказательство} проведем от противного. 
Пусть найдется некоторая окрестность $U$ множества ${\cal M}(f)$ такая, что
для каждого покрытия $C_k$ с максимальным диаметром $d_k$            
на символическом образе $G_k$ найдется поток $m_k$, для которого мера
$\mu_k$ не лежит в окрестности $U$ и при этом $d_k\to 0$. 
Согласно предыдущей теореме существует подпоследовательность
$\{m_{k_p}\}$ такая, что соответствующая последовательность
мер $\mu_{k_p}$ сходится к инвариантной мере $\mu\in {\cal M}(f)$.
Это означает, что начиная с некоторого номера вся последовательность
$\mu_{k_p}$ лежит в $U$, что противоречит предположению.
Следовательно, наше предположение не верно и теорема доказана.
$$\odot$$

Доказанная теорема гарантирует, что любая мера построенная 
по потоку на символическом образе хорошо аппроксимирует некоторую инвариантную
меру, если только диаметр ячеек достаточно мал.
В реальных расчетах мы можем построить только конечное
число символических образов, поэтому полученный результат дает
обоснование  практического вычисления приближений инвариантных мер.
Более того, теорема гарантирует, что множество всех потоков ${\cal M}(G)$
на символическом образе хорошо аппроксимирует множество 
инвариантных мер ${\cal M}(f)$,
если только диаметр ячеек достаточно мал.

\begin{example}
Построение инвариантной меры на единичной окружности $S^1$.
\end{example}
\begin{figure}[bht]
  \begin{center}
       \includegraphics[height=6cm, width=6cm]{n-recr.png}
  \end{center}
  \caption{Динамическая система единичной окружности $S^1$.}
  \label{s1}
\end{figure} 
Рассмотрим динамическую систему  
на единичной окружности  
$$
S^1=\{(x,y)\in R^2\ | \ x=\cos\phi,\ y=\sin \phi,\ \phi\in [0,2\pi ]\}.
$$
Координатой на  $S^1$ является угол $\phi,\ 0\le\phi<2\pi$.
Уравнение движения задается в виде $\phi'=\cos\phi-1$ (см. рис. \ref{s1}).
Такая непрерывная динамическая система имеет
одно состояние равновесия $O=\{\phi=0\}$,  
остальные траектории начинаются в $O$
 и заканчиваются в $O$, делая полный оборот на $S^1$ по часовой стрелке.
Рассмотрим дискретную систему, порожденную сдвигом на единицу времени 
вдоль траекторий непрерывной системы. 
Применим описанную выше технологию построения инвариантных мер к 
данной дискретной динамической системе.
Нетрудно видеть, что система имеет единственную инвариантную меру $\mu$,
которая является $\delta$-функцией,  сосредоточенной в точке $O$, т.е.
$\mu (A)=1$, если $O\in A$, иначе $\mu (A)=0$.
Так как ${\cal M}(f)$ состоит из одной $\delta$-функции,
то согласно Теореме \ref{tri} (или \ref{theorem3}) 
любая последовательность мер $\mu_k$, построенная согласно (\ref{ll}),
должна сходиться к $\delta$-функции при $d_k\to 0$.

Действительно, рассмотрим любое разбиение 
$C=\{M(1),\dots , M(n)\}$ окружности $S^1$ 
на отрезки длины $d$, такое что точка $O$ лежит внутри ячейки $M(1)$.  
Тогда символический образ $G$ содержит дугу $1\to 1$,
 которая дает самый короткий периодический путь на $G$.
Существует поток $m_{11}=1$,  остальные $m_{ij}=0$,  
который очевидно сходится к мере $\mu$ при $d\to 0$.
Теперь рассмотрим самый большой цикл $\omega$ на $G$. 
Этот цикл начинается в первой вершине (ячейке), делает 
полный оборот по часовой стрелке и заканчивается в той же вершине 1.
Период $N$ данного пути зависит от диаметра $d$ и
$N\to\infty$ при $d\to 0$. 
Путь $\omega$ порождает поток $m_{ij}=1/N$ для $i\to j$ из $\omega$,
иначе $m_{ij}=0$.
Пусть $U$ --- окрестность точки $O$,
$A=S^1\setminus U$ --- дополнение к $U$. 
Любая траектория непрерывной системы 
 пересекает $A$ за конечное время 
$t_0$. Тогда путь $\omega$ пересекает $A$ за время 
$k<t_0+1$, если диаметр $d$ достаточно мал. 
Остальное время $N-k$ путь $\omega$ находится в $U$.
Отсюда получаем оценки мер:
$\mu_d^*(A)=\frac{k}{N}\to 0$, и $\mu_d^*(U)=\frac{N-k}{N}\to 1$
при $d\to 0$. 
Следовательно, в этом случае мы тоже получаем
$\delta$-функцию,  сосредоточенную в точке $O$.
Таким же способом можно показать, что любая последовательность
потоков сходится к $\delta$-функции при $d\to 0$.

\section{Метод балансировки}

В работе \cite{OSejournal2007} описан метод построения потока на графе, 
который основан на наличии любого набора периодических путей. 
Сейчас мы рассмотрим другой метод, который
 позволяет, исходя из произвольного не инвариантного распределения,
 итерационным способом  приблизится к инвариантному потоку на графе.
Пусть матрица $P=(p_{ij})$ задает некоторое распределение неотрицательных чисел 
на дугах графа $G$. 
Не предполагается, что распределение $P$ удовлетворяет условиям 
(\ref{odin}) и (\ref{kirkhof}).
Множество $G^+(P)=\{ i\to j |\ p_{ij}>0\}$ дуг, на которых распределение $P$ 
положительно, назовем носителем этого распределения.
Мы будем строить поток на этом носителе $G^+(P)$.
Как показано выше, 
для существования потока на $G^+(P)$ необходимо, 
чтобы носитель содержал какой-нибудь периодический путь. 
 
Пусть $G$ --- произвольный граф и $n$ --- число его вершин.
Матрица $x=(x_{ij})$ задает поток на $G$ тогда и только тогда,
 когда выполнены следующие условия
\begin{itemize}
\item $x_{ij}\ge 0$,
\item $\sum_{ij}x_{ij}=1$,
\item $\sum_jx_{ij}=\sum_kx_{ki}$ для $i=1,\ 2,\ \dots ,\ n.$
\end{itemize}
Кроме того, мы хотим найти поток, носитель которого лежит в $G^+(P)$.
Для этого надо потребовать, чтобы $x_{ij}=0$ при $p_{ij}=0$.
Подобная задача вычисления матрицы $x$ при линейных ограничениях
 возникает в теории выпуклого программирования 
при решении некоторых экстремальных задач. 
Мы будем опираться на работу \cite{bregman}, 
где обоснован итерационный метод решения таких задач.
В докладе \cite{romanovsky} 
была высказана гипотеза о применении методов выпуклого программирования
 к задаче вычисления потока на графе. 
Следует отметить, что вероятно впервые задача о 
вычислении замкнутого потока на графе возникла 
как специальная транспортная задача. 
Ленинградский архитектор Г.В. Шелейховский в 50-х годах успешно 
решал такую задачу методом, который можно назвать 
методом балансировки \cite{sheleihovsky}. 
Исходя из произвольного распределения, он предложил последовательно менять 
его так чтобы удовлетворить только одно равенство, не заботясь о других. 
Повторяя такую балансировку циклически, 
он получил последовательность распределений, 
которая быстро сходилась к искомому решению.
Фактически мы будем решать нашу задачу таким же методом. 
Целью 
 является обоснование применения метода балансировки к 
задаче вычисления потоков на графе.
\begin{proposition} Пусть дано произвольное неотрицательное распределение 
$P=(p_{ij})$, для которого носитель $G^+(P)$ содержит цикл. 
Тогда существует поток $Q=(q_{ij})$ на $G$ такой, что 
его носитель $G^+(Q)$ лежит в $G^+(P)$, а сам он максимизирует функцию 
$$
g(x)=\sum_{ij}x_{ij}\ln \frac{p_{ij}}{x_{ij}}=
\sum_{ij}x_{ij}\ln p_{ij}-\sum_{ij}x_{ij}\ln x_{ij}
$$
в пространстве всех потоков на $G^+(P)$.
\end{proposition}
{\it Замечание.} Здесь как обычно мы полагаем по непрерывности $0\ln 0=0$.

{\bf Доказательство.}
Надо решить задачу нахождения точки максимума функции 
$g$ на множестве $G^+(P)$. 
Пусть $d$ --- число дуг входящих в носитель $G^+(P)$, $d\le n^2$.
Если элементы матрицы $x=(x_{ij})$, где $x_{ij}> 0$ при $p_{ij}>0$ и
 $x_{ij}=0$ при $p_{ij}=0$, упорядочить $(ij)\to k=1,\ 2,\ \dots, d$
(например, по строкам сверху вниз), 
то $x$ можно рассматривать как точку в пространстве 
$S=\{x\in R^d|\ x_k=x_{ij}>0\}$. 
Обозначим 
$$B_0=\{x\in R^d|\ x_{ij}\ge 0,\ \sum_{ij}x_{ij}=1\},$$ 
$$B_i=\{x\in R^d|\ x_{ij}\ge 0,\ \sum_jx_{ij}=\sum_kx_{ki}\}$$
 для $i=1,\ 2,\ \dots ,\ n.$ 
Пересечение $D=\bigcap_i B_i\cap B_0$ является компактом, 
который лежит в замыкании
$\overline{S}$ и поэтому функция $g$ достигает своего максимума на $D$. 
Наша задача состоит в том, чтобы найти эту точку максимума.
В работе \cite{bregman} была решена следующая задача выпуклого программирования.

Пусть $f(x)$ --- строго выпуклая функция, непрерывно дифференцируемая 
на выпуклом множестве $S\subset R^d$ и непрерывная на $\overline{S}$. 
Требуется минимизировать функцию $f$ при линейных условиях
$$
Ax=b,\ x\in \overline{S},
$$
где $ b\in R^m, \ A$ --- матрица с $r$ столбцами и $m$ строками. 
Применим результаты работы \cite{bregman} к функции $f=-g$,
которая является строго выпуклой.
Наши линейные условия состоят из $n+1$ уравнения, 
первое из которых задает нормировку 
\begin{equation}
\label{norma}
\sum_{ij}x_{ij}=1,
\end{equation}
а остальные $n$ уравнений описывают инвариантность (закон Кирхгофа)
\begin{equation}
\label{kir}
\sum_jx_{ij}-\sum_kx_{ki}=0,\ \ i=1,\ 2,\ \dots ,\ n.
\end{equation}
Необходимым условием применения результатов работы \cite{bregman} является
наличие допустимого решения системы (\ref{norma}), (\ref{kir}), что означает 
существование какого-либо потока на $G^+(P)$. 
По предположению на $G^+(P)$ существует периодический путь,
который порождает поток (см. \cite{OSejournal2007}) 
и допустимое решение системы линейных ограничений.
Рассмотрим следующий итерационный процесс:

1) выберем произвольную точку $x^0\in S;$

2) если точка $x^t$  известна, 
то выбираем некоторым образом $p_t$-е уравнение 
и находим точку $x^{t+1}\in B_{p_t}$, 
которая удовлетворяет выбранному уравнению и, 
возможно, не удовлетворяет остальным уравнениям. 
Способ нахождения такой точки будет описан ниже. 
При этом за один итерационный цикл мы должны перебрать все $n+1$ уравнения. 
Полученную последовательность $\{x^t\}$ называют релаксационной 
последовательностью. Последовательность номеров $\{p_t\}$ уравнений 
называют управлением релаксацией. 
Например, можно выбрать управление в обычном циклическом порядке: 
сначала решать уравнение нормировки, 
затем подряд уравнения инвариантности и потом повторять весь цикл снова. 

В \cite{bregman} показано, что для решения поставленной 
экстремальной задачи,
точки последовательности
 $x^{t+1}$ и $x^t$ должны удовлетворять следующей системе равенств
\begin{equation}
\label{grad}
grad\ f(x^{t+1})=grad\ f(x^t)+\lambda A_p,
\end{equation}
\begin{equation}
\label{urav}
(A_p,x^{t+1})=b_p,
\end{equation}
где $grad\ f$ --- градиент функции $f$, 
$\lambda$ --- неизвестный параметр,
(*,*) --- скалярное произведение,
 $A_p$ --- строка коэффициентов левой части 
$p$ -го уравнения наших линейных ограничений, 
$b_p$ --- правая часть этого уравнения, 
т.е. $x^{t+1}$  есть решение $p$-го уравнения наших линейных ограничений.
Для функции $f(x)=-g(x)=\sum_{ij}x_{ij}\ln \frac{x_{ij}}{p_{ij}}$ 
мы имеем
$$
(grad\ f(x))_{ij}=ln \frac{x_{ij}}{p_{ij}}+1.
$$
Для уравнения нормировки (\ref{norma}) мы получаем равенства
$$
\ln \frac{x^{t+1}_{ij}}{p_{ij}}=\ln \frac{x^{t}_{ij}}{p_{ij}}+\lambda,
$$
$$
\sum_{ij}x^{t+1}_{ij}=1.
$$
Из первого уравнения получаем  соотношение
$$
x^{t+1}_{ij}=x^t_{ij}\exp (\lambda),
$$
а из второго 
$$
\sum_{ij}x^{t}_{ij} \exp (\lambda)=1.
$$
Отсюда мы получаем обычное преобразование нормировки
\begin{equation}
\label{normirovka}
x^{t+1}_{ij}=\frac{x^t_{ij}}{\sum_{kl}x^{t}_{kl}}.
\end{equation}
Для $i$-го уравнения инвариантности (\ref{kir}) мы получаем
 следующую систему равенств
$$
\ln \frac{x^{t+1}_{ij}}{p_{ij}}=\ln \frac{x^{t}_{ij}}{p_{ij}}+\lambda,
$$
$$
\ln \frac{x^{t+1}_{ki}}{p_{ki}}=\ln \frac{x^{t}_{ki}}{p_{ki}}-\lambda,
$$
$$
\sum_{j\ne i}x^{t+1}_{ij}-\sum_{k\ne i}x^{t+1}_{ki}=0.
$$
Тогда
$$
\exp \lambda=\left(\frac{\sum_{k\ne i}x^t_{ki}}{\sum_{j\ne i}x^t_{ij}}\right)
^{\frac{1}{2}}
$$
и мы получаем формулы преобразования в виде
\begin{equation}
\label{ij}
x^{t+1}_{ij}=x^t_{ij}\left(\frac{\sum_{m\ne i}x^{t}_{mi}}{\sum_{l\ne i}
x^t_{il}}\right)^{\frac{1}{2}},
\end{equation}
 для  $j\ne i$ и
\begin{equation}
\label{ki}
x^{t+1}_{ki}=x^t_{ki}\left(\frac{\sum_{l\ne i}x^t_{il}}{
\sum_{m\ne i}x^{t}_{mi}}\right)^{\frac{1}{2}},
\end{equation}
 для $k\ne i$, при этом 
\begin{equation}
\label{ii}
x^{t+1}_{ii}=x^t_{ii}.
\end{equation}
\noindent Формулы (\ref{ij}), (\ref{ki}) и (\ref{ii}) 
описывают преобразование элементов 
$i$-й строки и $i$-го столбца матрицы $x^t$.  
Остальные элементы не меняются.
Согласно работе \cite{bregman}, полученная последовательность 
имеет предел, если функция
$$
D(x,y)= f(x)-f(y)- (grad\ f(y), x-y)
$$
будет такой, что $D(x,y^k)\to 0$, при $x\in \overline{S}$, $y^k\to x$  и 
$y^k\in S$.
В нашем случае 
$$
D(x,y)=\sum_{ij}(y_{ij}-x_{ij})+\sum_{ij}x_{ij}\ln x_{ij} 
-\sum_{ij}x_{ij}\ln y_{ij}
$$
и описанное свойство легко проверяется. 
В таком случае показано \cite{bregman}, что 
предел не зависит от выбранного управления релаксации,
а зависит только от начального значения $x^0$. 
Для того чтобы предельное значение 
$$
Q=\lim_{t\to \infty}x^t
$$
решало поставленную экстремальную задачу, достаточно взять начальное значение в
точке глобального минимума функции $f$, т.е. положить
$x^0_{ij}=p_{ij}\exp (-1)$. 
Учитывая нормировку, мы можем начать итерационный процесс с 
\begin{equation}
\label{initial}
x^0_{ij}=p_{ij}.
\end{equation}

Утверждение доказано.
$$\odot$$
Рассмотрим теперь управление релаксацией, при котором сходимость к искомому 
решению является более быстрой. 
Пусть $x=(x_{ij})$ --- произвольное неотрицательное распределение 
на дугах графа $G$. 
Каждому из уравнений (\ref{norma}),\ (\ref{kir}) припишем индекс 
$i=0,\ 1,\ \dots,\ n$, где $i=0$ соответствует уравнению нормировки 
(\ref{norma}), а индекс $i>0$ соответствует уравнению инвариантности для 
$i$-й вершины. 
Для произвольной матрицы $x=(x_{ij})$ и каждого $i$ определим параметр, 
который назовем "невязкой"
$$
a_0=|1-\sum _{ij}x_{ij}|,
$$
$$
a_i= |\sum_{j} x_{ij}-\sum_{k} x_{ki}|, \ \ i\ge 0.
$$
\begin{proposition} \label{two}
Пусть выполнены предположения предыдущего утверждения. 
Выберем начальное распределение
$$
x^0_{ij}=p_{ij}
$$
и релаксационное управление так, что для каждого $x^t$ 
 в качестве $p_t$ будем выбирать тот индекс, который реализует максимум 
невязки
$$
max\{a_i,\ i=0,\ 1,\ \dots, n\}.
$$
Если $p_t=0$, то $x^{t+1}$ вычисляется по формуле (\ref{normirovka}),
если $p_t>0$, то $x^{t+1}$ вычисляется по формулам (\ref{ij})---(\ref{ii}),
где $i=p_t$.
Тогда релаксационная последовательность сходится к распределению
$Q=(q_{ij})$, которое является потоком с носителем в $G^+(P)$
и максимизирует функцию 
$$
g(x)=\sum_{ij}x_{ij}\ln \frac{p_{ij}}{x_{ij}}=
\sum_{ij}x_{ij}\ln p_{ij}-\sum_{ij}x_{ij}\ln x_{ij}
$$
в пространстве всех потоков на $G^+(P)$.
\end{proposition}
Это утверждение доказано в более общем виде в \cite{bregman}.
Более того, выше указано, что
в нашем случае предельное значение 
$Q=(q_{ij})$ не зависит от выбора управления релаксацией, 
а зависит только от начального значения. 
Данное утверждение является особенно полезным для вычислительной практики,
т.к. существенно увеличивает скорость сходимости.
Надо отметить, что
так как в преобразовании (\ref{normirovka})---(\ref{ii}) участвует 
нормировка, то пропорциональное начальное значение 
$Lx^0, \ L>0$ порождает то же предельное распределение $Q$.
При численном применении метода балансировки следует учитывать,
что носитель любого потока необходимо лежит во множестве
возвратных дуг и, следовательно, носитель начального
распределения $x^0$ должен лежать в этом же множестве.
Более того, достаточно строить потоки на каждой компоненте
сильной связности графа, а при необходимости взять линейную оболочку
этих потоков.

\begin{example}
Поток максимально равномерно распределенный на графе.
\end{example}
Рассмотрим 0-1 матрицу смежности $\Pi=(\pi_{ij})$ графа $G$,
т.е. $\pi_{ij}=1$,  если существует дуга $i\to j$,  иначе $\pi_{ij}=0$.
В качестве матрицы $P$ возьмем матрицу $\Pi$  и 
ее же возьмем в качестве начального значения $x^0 $. После нормировки
мы получим $x^1=(x_{ij})$, 
где $x_{ij}=\pi_{ij}/N$, $ N$ ---  число дуг графа $G$.
Согласно Утверждению \ref{two},
релаксационная последовательность сходится к распределению
$Q=(q_{ij})$, 
которое является потоком на $G$ и максимизирует
функцию 
$$g(x)= -\sum_{ij}x_{ij}\ln x_{ij}$$
 на множестве всех потоков ${\cal M}(G)$.
Заметим, что если выполнено только условие нормировки, то функция $g(x)$
достигает своего максимального значения при $x_{ij}=const=\pi_{ij}/N$.
В этом случае $g(x)=\ln N$. 
При выполнении условия инвариантности (закона Кирхгофа) 
поток максимизирующий функцию $g(x)$ будет наиболее близким к 
$x_{ij}=const$, 
т.е. будет максимально равномерно распределен на графе $G$.

\begin{example} Применение метода балансировки к отображению Икеда.
\end{example}
Отображение Икеда \cite{ikeda}  
возникает при моделировании оптических носителей
информации и имеет вид:
\begin{eqnarray}
    \left(
  \begin{array}{c}
     x
     \\
     y
  \end{array}
  \right)
  &\rightarrow&
  \left(
  \begin{array}{ccc}
     d & + & a ( x \cos\tau(x,y) - y  \sin\tau(x,y) ) \\
       &   & b ( x \sin\tau(x,y) + y  \cos\tau(x,y) ) \\
  \end{array}
    \right), \\
  \tau (x,y) &=& 0.4 - \frac {6}{1+x^2+y^2}  
\end{eqnarray}
\noindent где $d>0$, $0<a<1,\ 0<b<1$.
Отображение обладает свойством сжатия площадей и имеет глобальный
аттрактор.


В \cite{osipenko_ikeda, osipenko2007} было показано, что при 
$d = 2$, $a=-0.9$, $b = 0.9$ это отображение меняет ориентацию и также
имеет глобальный аттрактор в области $M = [-10, 10]\times[-10, 10]$.

\begin{figure}[ht!]
  \begin{center}
  \includegraphics[width=12cm, height=17cm, bb=0 0 1479 1592]{ikeda-measure.png}
  \end{center}
  \caption{Метод балансировки для модифицированного отображения Икеда.}
  \label{ikeda}
\end{figure} 
\newpage

\noindent Для локализации глобального аттрактора было сделано 10 подразбиений
и построена последовательность символических образов $G_1,\dots ,G_{10}$.
На верхнем рисунке \ref{ikeda} в плоскости (xy) 
лежит покрытие аттрактора, которое получено на $G_{10}$
и состоит из 96543 ячеек
размером $0.019\times 0.019$. 
Инвариантный поток строился на $G_{10}$
методом балансировки, а в качестве начального
значения была выбрана матрица смежности $\Pi$.  
Релаксационный процесс приводит нас к матрице $Q=(q_{ij})$
размером $96543\times 96543$, 
которая максимизирует функцию
$g(x)= -\sum_{ij}x_{ij}\ln x_{ij}$.
Распределение полученной (аппроксимации) меры  показано на
нижнем рисунке \ref{ikeda}, где
по оси z отмечена мера ячейки.
Инвариантная мера будет максимально распределена по аттрактору, так как $Q$ максимизирует функцию $g.$

Этот численный эксперимент был проведен аспирантом Е.И. Петренко(zhene@mail.ru),
Санкт-Петербургский Государственный университет.                  

\newpage                                      

\section{Приложение. Оценка метрической энтропии.}

Рассмотрим  применение разработанной техники к оценке 
метрической энтропии.
Пусть на символическом образе $G$ отображения $f$ 
построен инвариантный поток $m=\{m_{ij}\}$.
Как было показано выше, любой поток $m$ следует рассматривать как приближение
к некоторой инвариантной мере $\mu$, если диаметр ячеек $d$
достаточно мал.
Поток $m$ на $G$ порождает цепь Маркова 
(см. \cite{douglas}, p.47, 328), у которой состояния  
совпадают с вершинами графа $G$, а вероятности перехода 
$$p_{ij}=m_{ij}/m_i.$$
Матрица вероятностей $P=(p_{ij})$ имеет стационарное распределение 
$(m_1,m_2, \ldots , m_n)$, т.к.
$$(m_1,m_2, \ldots , m_n)
\left(
\begin{array}{cccc}
p_{11}&p_{12}&\ldots&\ p_{1n}\\
p_{21}&p_{22}&\ldots&\ p_{2n}\\
\cdot& \cdot&\ldots& \cdot\\
p_{n1}&p_{n2}&\ldots&\ p_{nn}\
\end{array}
\right)= (m_1,m_2, \ldots , m_n).
$$
Для стационарного распределения $(m_1,m_2, \ldots , m_n)$
 энтропия вычисляется по формуле (см. \cite{douglas}, p.443)
$$
h_m=-\sum_i m_i\sum_j p_{ij}\ln p_{ij}.
$$
Подставим $p_{ij}=m_{ij}/m_i$ и найдем 
$$
h_m=-\sum_i m_i\sum_j m_{ij}/m_i \ln (m_{ij}/m_i )=-\sum_{ij} m_{ij} 
\ln (m_{ij}/m_i )=
-\sum_{ij} m_{ij} \ln m_{ij}+ \sum_{ij} m_{ij} \ln m_i =
$$
$$
-\sum_{ij} m_{ij} \ln m_{ij}+ \sum_{i} m_{i} \ln m_i.
$$
Таким образом, энтропия может вычисляться непосредственно по потоку 
$m_{ij}$ как
\begin{equation}
\label{entropy}
h_m=-\sum_{ij} m_{ij} \ln m_{ij}+ \sum_{i} m_{i} \ln m_i.
\end{equation}
Это позволяет нам надеяться, что энтропия отображения $f$  
по инвариантной мере $\mu$ может быть оценена по формуле
(\ref{entropy}), где поток $m$ является приближением к $\mu$.
Такой подход к оценке метрической энтропии был анонсирован в 
докладе \cite{OS2007}.

\begin{thebibliography}{99}

\bibitem{bregman} Брегман Л.М. 
Релаксационный метод нахождения общей точки выпуклых множеств и 
его применение для задач выпуклого программирования.
Журнал вычисл. математики и матем. физики. 
т.7, №3 (1967), 630-631.

\bibitem{katok} Каток А.Б., Хасселблат Б.
Введение в современную теорию динамических систем.
Москва 1999.
\bibitem{osipenko1983} Осипенко Г.С.
О символическом образе динамической системы.
Граничные задачи. Сб. трудов, Пермь, 1983, 101-105.

\bibitem{OS2007} Осипенко Г.С. Построение инвариантных мер и оценка энтропии
динамических систем. 
Нелинейный динамический анализ-2007, 4-8 июня 2007, Санкт-Петербург,
Тезисы докладов, с.379.
 
\bibitem{OSejournal2007} Осипенко Г.С., Крупин А.В., Безручко А.А.,
 Петренко Е.И., Капитанов А.А.
 Построение инвариантных мер динамических систем.
Эл. ж. Дифференциальные уравнения и процессы управления. 
http://www.neva.ru/journal, т.4, 2007, с. 27-51.

\bibitem{romanovsky} Романовский И.В., Ампилова Н.Б., Петренко Е.И.
О максимизации энтропии при линейных ограничениях.
Тезисы докладов. Международная конференция 
"Космос, астрономия, программирование", 
20-22 мая 2008 г., Санкт-Петербург, c. 181-184.

\bibitem{sheleihovsky} Шелейховский Г.В.
Композиция городского плана как проблема транспорта.
Рукопись, 1946.

\bibitem{douglas} Douglas Lind, Brian Marcus.
An introduction to symbolic dynamics and coding. Cambridge, 1995.

\bibitem{ikeda}  Ikeda K. Multiple-valued stationary state and
its instability of the transmitted light by a ring cavity system.
Opt. Comm. 1979, Vol.30, p.257-261.

\bibitem{bogolubov} Kryloff N, Bogollouboff N.
La theorie generale de la mesure dans son application a l'etude
das systemes dynamiques de la mecanique non lineaire.
Ann. Math. v. 38 (1937), no. 1, 65-113.
                                       
\bibitem{osipenko_ikeda} Osipenko G.
 Numerical Explorations of the Ikeda mapping dynamics.
 El. J. Differential Equations and Control Processes.
http://www.neva.ru/journal, no.2, 2004.

\bibitem{osipenko2007} George Osipenko,
Dynamical systems, Graphs, and Algorithms, Springer, 2007


\end{thebibliography}

                                                         
