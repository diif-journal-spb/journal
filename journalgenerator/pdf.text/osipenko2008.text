dx
dt
6
¾
-
?
ДИФФЕРЕНЦИАЛЬНЫЕ УРАВНЕНИЯ
И
ПРОЦЕССЫ УПРАВЛЕНИЯ
N.4 , 2007
Электронный журнал,
рег. N П2375 от 07.03.97
ISSN 1817-2172

http://www.math.spbu.ru/user/diffjournal/
e-mail: jodiff@mail.ru
Моделирование динамических систем
ПОСТРОЕНИЕ ИНВАРИАНТНЫХ МЕР
ДИНАМИЧЕСКИХ СИСТЕМ
Осипенко Г.С., Крупин А.В. и Безручко А.А.
Севастопольский национальный технический университет,
Петренко Е.И.
Санкт-Петербургский государственный университет,
Капитанов А.Я.
Санкт-Петербургский государственный политехнический университет.
Работа была анонсирована на Международном конгрессе NDA-2007 [3].
1 Аннотация
Пусть f : M ! M гомеоморфизм компактного многообразия M ½ R
d
, по-
рождающий дискретную динамическую систему ff
n
; n 2 Zg. Описывает-
ся основанный на конструкции символического образа алгоритм построения
инвариантной меры динамической системы. Рассматривается последователь-
ность подразбиений таких, что максимальный диаметр ячеек d
k
! 0 и со-
ответствующая последовательность G
k
символических образов, на которых
строятся согласованные инвариантные потоки m
k
: С помощью этих потоков
и меры Лебега строятся меры ¹
k
: Доказано, что при этих условиях суще-
ствует мера ¹ инвариантная для f такая, что ¹=lim
d
k
!0
¹
k
; где сходимость
рассматривается в слабой топологии.Дифференциальные уравнения и процессы управления,N.4 , 2007
2 Введение
Пусть f : M ! M гомеоморфизм компактного многообразия M ½ R
d
, по-
рождающий дискретную динамическую систему ff
k
; k 2 Zg. Мера ¹ на
M называется инвариантной для f, если для любого измеримого множества
A½M выполнено равенство
¹(f(A))=¹(A)=¹(f
¡1
(A)):
Теорема Крылова-Боголюбова [15] гарантирует, что существует мера ¹; ин-
вариантная для f и нормированная на M: ¹(M) = 1. Известно [1], что мно-
жество всехf-инвариантных мерM(f) является выпуклым замкнутым ком-
пактом в слабой топологии. Сходимость ¹
n
! ¹ в этой топологии означает,
что
Z
M
Ád¹
n
!
Z
M
Ád¹
для любой непрерывной функции Á:M !R. Крайними точками выпуклого
множестваM(f) являются эргодические меры. (Мера ¹ эргодична, если для
любого инвариантного измеримого множества A либо ¹(A) = 0, либо ¹(Mn
A)=0.)
Пример 1 Предположим, что точка x   периодическая с наименьшим пе-
риодом p, т.е. траектория T =fx;f(x);:::;f
p¡1
(x)g состоит из p различ-
ных точек и f
p
(x) = x. Пусть мера ¹ равномерно распределена по траек-
тории T, т.е. ¹(x) = ¹(f(x)) =¢¢¢ = ¹(f
p¡1
(x)) = 1=p и мера множества
A определяется как ¹(A)=¹(A\T)=k=p, где k число точек траектории
T, лежащих в A. Легко проверить, что данная мера является инвариант-
ной и эргодической. Она дискретна в том смысле, что она сосредоточена в
конечном числе точек.
Наша цель состоит в конструктивном построении множества всех инва-
риантных мер M(f). Будет указан алгоритм, который позволяет постро-
ить любую инвариантную меру. Для этого мы воспользуемся конструк-
цией символического образа динамической системы [2, 17]. Пусть C =
fM(1); M(2); :::; M(n)g конечное покрытие области M, M(i)   ячейка
покрытия. Символический образ G   это ориентированный граф (орграф),
у которого каждая вершина (узел) i соответствует ячейке M(i) и дуга i!j
существует тогда и только тогда, когда f(M(i))\M(j) 6= ;. В общем слу-
чае, никаких ограничений на покрытия не налагается, но мы будем считать,
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 28Дифференциальные уравнения и процессы управления,N.4 , 2007
что C является разбиением с измеримыми ячейками. При численных расче-
тах ячейками являются параллелепипеды, которые могут пересекаться толь-
ко по границам. Если допускается замкнутое покрытие, то параллелепипеды
выбираются замкнутыми. Когда C является измеримым разбиением, парал-
лелепипеды надо выбрать полуоткрытыми, приписывая граничные диски к
одной из примыкающих ячеек. Общая схема построения состоит в следую-
щем. Сначала мы определим на дугах G, вероятностное распределение m
ij
;
которое обладает некоторым свойством инвариантности. Такое распределе-
ние позволяет приписать меру ячейкам и получить некоторое приближение к
инвариантной мере. Множество распределенийfm=(m
ij
)g образует выпук-
лый многогранник, который является приближением для множества инвари-
антных мерM(f). Затем мы рассмотрим последовательность подразбиений
исходного разбиения при стремлении максимального диаметра ячеек к нулю.
Образуется последовательность символических образов, на которых опреде-
ляется согласованная последовательность распределений fm
k
g. Переходя к
пределу по k, определим меру ¹; инвариантную для отображения f. Будет
показано, что любая инвариантная мера может быть получена описанным
предельным переходом.
3 Потоки на графах
Предположим, что существуетf-инвариантная нормированная мера¹. Тогда
каждой дуге i!j символического образа G мы можем приписать меру
m
ij
=¹(M(i)\f
¡1
(M(j)))=¹(f(M(i))\M(j)); (1)
где последнее равенство является следствием инвариантности меры ¹. Кроме
того, из инвариантности ¹ следуют равенства
X
k
m
ki
=
X
k
¹(f(M(k))\M(i)))=¹(f(M(i)))=¹(M(i))=
X
j
¹(M(i)\f
¡1
(M(j)))=
X
j
m
ij
:
Сумма
P
k
m
ki
называется потоком, входящим в вершину i, а сумма
P
j
m
ij
  потоком, исходящим из i. Равенство
X
k
m
ki
=
X
j
m
ij
(2)
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 29Дифференциальные уравнения и процессы управления,N.4 , 2007
можно трактовать как закон Кирхгофа: для каждой вершины входящий по-
ток равен исходящему потоку. Кроме того, имеет место равенство
X
ij
m
ij
=¹(M)=1; (3)
которое означает, что распределение m
ij
является нормированным (вероят-
ностным). Таким образом, существование инвариантной меры ¹ порождает
на символическом образе распределение m
ij
, которое удовлетворяет (2) и (3).
Описанное наблюдение приводит нас к следующему определению.
Определение 1 Пусть G ориентированный граф. Потоком на G называ-
ется распределениеfm
ij
g на дугахfi!jg такое, что
² m
ij
¸0;
²
P
ij
m
ij
=1;
² для любого i имеет место равенство
P
k
m
ki
=
P
j
m
ij
:
Последнее свойство можно назвать инвариантностью потока. Второе свой-
ство нормировки можно записать в виде m(G) = 1, где под мерой графа
понимается сумма мер его дуг. Иногда в теории графов описанное распреде-
ление называют замкнутым или инвариантным потоком. Для потока fm
ij
g
на графе G мы можем определить меру вершины i как
m
i
=
X
k
m
ki
=
X
j
m
ij
:
В таком случае получаем равенство
P
i
m
i
=m(G)=1:
Пусть на символическом образе G определен поток m =fm
ij
g, тогда на
области M можно определить меру ¹
¤
, полагая
¹
¤
(A)=
X
i
m
i
v(A\M(i))=v(M(i)); (4)
где v   нормированная на M мера Лебега. В этом случае мера ячейки M(i)
совпадает с мерой вершины i:
¹
¤
(M(i))=m
i
:
Вообще говоря, построенная мера ¹
¤
не является инвариантной для f. Од-
нако, как будет показано, эта мера является приближением к инвариантной
мере в том смысле, что¹
¤
сходится к инвариантной мере, если максимальный
диаметр ячеек стремится к нулю.
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 30Дифференциальные уравнения и процессы управления,N.4 , 2007
4 Свойства потоков на графе
Пусть G абстрактный ориентированный граф, имеющий n вершин. Рас-
смотрим пространство Z = fmg всех потоков на G. Пусть m
1
= fm
1
ij
g и
m
2
= fm
2
ij
g два потока, числа ff; ¯ ¸ 0 и ff+¯ = 1. Тогда, как нетрудно
проверить, распределение m = ffm
1
+¯m
2
=fffm
1
ij
+¯m
2
ij
g также является
потоком. При этом мы будем говорить, что поток m является суммой пото-
ков m
1
и m
2
с весами ff и ¯. Таким образом, пространство всех потоков Z
является выпуклым.
Исследуем структуру выпуклого множества Z. Пусть ! = (i
1
! i
2
!
¢¢¢ ! i
k
! i
1
)   простой периодический путь (цикл), т.е. все вершины
fi
t
; t = 1;2;:::;kg различны. Построим поток m(!), сосредоточенный на
этом цикле (простой поток). Для этого положим m
ij
= 1=k для всех дуг
периодического пути ! и m
ij
= 0 для всех остальных дуг. Очевидно, что
простой поток обладает свойством инвариантности, является единственным
потоком, сосредоточенным на ! и не раскладывается в сумму других пото-
ков. Таким образом m(!) является крайней точкой множества потоков Z.
Так как число вершин конечно, то число простых циклов и простых потоков
тоже конечно.
Утверждение 1 Любой поток m 2 Z раскладывается в сумму простых
потоков.
Доказательство. Пусть m=fm
ij
g поток на G. Рассмотрим множество дуг
D = fi ! jg таких, что m
ij
> 0: На этом множестве выполняется закон
Кирхгофа (2). Это означает, что через любую дугу из D можно проложить
бесконечный путь !
¤
, лежащий в D. Действительно, если существует дуга
k! i c m
ki
> 0, то согласно равенству (2), существует дуга i! j с m
ij
> 0.
Так как граф имеет конечное число дуг, то !
¤
содержит периодический путь
!, который можно считать простым. Пусть p   наименьший период ! и
m(!)=minfm
ij
ji!j2!g >0
  наименьшая мера дуги из !. Найдем число ff> 0 такое, что
ff=p =m(!):
Построим новое распределение m
¤
на дугах G. Для каждой дуги i! j в !
определим новую меру m
¤
ij
= m
ij
¡ff=p¸ 0: Если дуга i! j не входит в !;
то m
¤
ij
=m
ij
:
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 31Дифференциальные уравнения и процессы управления,N.4 , 2007
Ясно, что сумма мер всех дуг
P
ij
m
¤
ij
=1¡ff.
Перейдем к проверке закона Кирхгофа (2) для меры m
¤
. Если вершина i
не лежит на цикле !, то m
¤
ij
= m
ij
; m
¤
ki
= m
ki
и равенство (2) очевидно
выполнено.Пустьвершинаiлежитнапростомцикле!,тогдав! существуют
дуги: k
¤
! i входящая в i и i! j
¤
выходящая из i, и не существует других
дуг цикла !; связанных с вершиной i:
Рис. 1: Проверка закона Кирхгофа.
В этом случае, в левой и правой частях равенства
X
k
m
ki
=
X
j
m
ij
(5)
имеются слагаемые вида m
k
¤
i
и m
ij
¤, которые порождены дугами k
¤
! i и
i!j
¤
. Остальные слагаемые не связаны с циклом !. Таким образом, если из
левой и правой частей равенства (5) отнять число ff=p, то получим искомое
равенство
X
k
m
¤
ki
=
X
j
m
¤
ij
:
Следовательно, новое распределение m
¤
удовлетворяет закону Кирхгофа, но
при этом множество D
¤
=fi! jg таких, что m
¤
ij
> 0; не содержит цикл !:
Повторяя этот процесс удаления простых циклов из множества D, через ко-
нечное число шагов придем к тому, что каждой дуге будет приписана нулевая
мера. В этом случае исходный поток представляется в виде
m=
X
!
ff
!
m
!
;
где ff
!
¸ 0; m
!
  простой поток, а сумма берется по всем простым циклам.
Из равенств m(G)=m
!
(G)=1 следует, что
P
!
ff
!
=1,
¯
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 32Дифференциальные уравнения и процессы управления,N.4 , 2007
Замечание Из доказательства следует, что мера m
ij
может быть
положительной только на дуге i ! j, через которую проходит периоди-
ческий путь. Вершина i называется возвратной, если через нее проходит
периодический путь. Две возвратные вершины являются эквивалентны-
ми, если существует периодический путь проходящий через обе вершины.
Множество возвратных вершин разбивается на классы эквивалентности,
которые в теории графов называются сильными компонентами. Cильные
компоненты символического образа порождают изолирующие окрестности
цепно-рекуррентных множеств динамической системы [17].
Известно [1], что инвариантная мера равна нулю вне цепно-
рекурррентного множества. Следовательно, не ограничивая общности, при
построении инвариантных мер достаточно рассматривать изолированную
инвариантную компоненту цепно-рекуррентного множества. Поэтому бу-
дем предполагать, что граф G состоит из одной сильной компоненты. Ес-
ли в рассуждениях будут использоваться графы общего вида, то мы будем
оговаривать это особо.
Таким образом, семейство потоков Z на графе G есть выпуклый много-
гранник, который является выпуклой оболочкой простых потоков. Это озна-
чает,чтолюбойпотокможнопостроитьследующимобразом.ПустьP =f!
z
g
  множество всех простых путей (циклов),fm
z
ij
g   множество простых пото-
ков. Тогда любой потокfm
ij
g определяется выбором неотрицательных чисел
a
z
таких, что
P
z
a
z
= 1 и в этом случае m
ij
=
P
z
a
z
m
z
ij
: Коэффициенты
fa
z
g можно назвать весами простых цикловf!
z
g.
Метод построения потоков, в котором используются все простые циклы,
может потребовать большого времени вычислений, т.к. число простых цик-
лов, как правило, очень велико. Например, в полном графе (где каждая вер-
шинасоединенаскаждой)числовершин n,числодуг n
2
,ачислопростых
циклов   2
n
. Однако, можно использовать неполный набор простых циклов,
считая веса незадействованных циклов равными нулю.
Рассмотрим другие способы построения потоков, которые позволяют про-
извести вычисления за приемлемое время даже для достаточно больших гра-
фов.
Пусть Q и G   ориентированные графы, отображение s : Q! G явля-
ется отображением орграфов, если отображение вершин порождает отобра-
жение дуг. Иначе говоря, если k и l   вершины на Q, s(k) = i; s(l) = j и
существует дуга k!l, тогда существует дуга i!j наG иs(k!l)=i!j.
При этом верно и обратное, если s(k!l)=i!j, то s(k)=i и s(l)=j:
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 33Дифференциальные уравнения и процессы управления,N.4 , 2007
Отображение орграфов порождает отображение (допустимых) путей, а
периодический путь отображается на периодический путь, при этом период
может уменьшиться, вообще говоря.
Утверждение 2 Пусть Q и G   орграфы, s : Q ! G является отобра-
жением орграфов, и на Q существует поток m. Тогда на G индуцируется
поток m
¤
=s(m) такой, что для дуги i!j 2G
m
¤
ij
=
X
s(p!q)=i!j
m
pq
;
где сумма берется по всем дугам p!q, которые отображаются на i!j:
Если дуга i!j не имеет прообразов, то m
¤
ij
=0.
Доказательство. Надо проверить выполнение для m
¤
двух свойств потока.
Свойство нормировки проверяется тривиально, т.к. суммирование по всем
вершинам i; j графа G совпадает с суммированием по всем p; q из Q
X
ij
m
¤
ij
=
X
pq
m
pq
=1:
Для проверки условия инвариантности фиксируем вершину i2G и рассмот-
рим все вершины p из прообраза s
¡1
(i). Для каждой вершины p выполне-
но условие инвариантности
P
r
m
rp
=
P
t
m
pt
. Суммируя эти равенства по
p 2 s
¡1
(i) и учитывая, что m
¤
rl
= 0 для дуг r ! l, не имеющих прообразов
при отображении s, получаем искомое равенство
X
k
m
¤
ki
=
X
j
m
¤
ij
для вершины i2G.
¯
Утверждение 3 Пусть на G существует периодический путь ! периода
N. Тогда на G имеется поток m
¤
такой, что m
¤
ij
= k
ij
=N, где k
ij
это
количество прохождений пути ! через дугу i!j.
Доказательство.Построим графQ, который состоит из одного простого пе-
риодическогоциклапериодаN,т.е.QимеетN вершиниN дуг.Вэтомслучае
на Q существует единственный поток m такой, что m
ij
=1=N. Отображение
s : Q ! G реализует путь !, т.е. s укладывает простой цикл Q на перио-
дический путь !. Согласно Утверждению 2, мера дуги i!j есть сумма мер
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 34Дифференциальные уравнения и процессы управления,N.4 , 2007
прообразов этой дуги при отображении s, т.е. m
¤
ij
= k
ij
=N, где k
ij
это число
прохождений пути ! через дугу i!j.
¯
Если G состоит из одной сильной компоненты, то существует путь ­,
который проходит через все вершины. Путь ­ можно назвать плотным на
вершинах. Тогда согласно Утверждению 3, определяется поток m = fm
ij
g
с положительной мерой m
i
=
P
j
m
ij
> 0 на каждой вершине. Аналогично,
существует путь ­
¤
, который проходит через все дуги. Описанный путь ­
¤
можно назвать плотным на дугах. Ясно, что путь плотный на дугах является
плотным на вершинах, но обратное неверно, вообще говоря. Поток порож-
денный ­
¤
является положительным m
ij
>0 на каждой дуге i!j.
Утверждение 4 Пусть наG существует семейство периодических путей
!
1
;:::;!
r
с периодами p
1
;:::;p
r
, положим N = p
1
+¢¢¢ + p
r
. Тогда на G
имеется поток m такой, что m
ij
= k
ij
=N, где k
ij
это общее число про-
хождений путей !
1
;:::!
r
через дугу i!j.
Доказательство этого утверждения повторяет доказательство Утвержде-
ния 3. Действительно, пусть выполнено предположение данного утвержде-
ния. Заметим, что Утверждение 2 не предполагает, что графы G и Q явля-
ются сильно связными. Более того, эти графы могут иметь много компонент
связности. Построим граф Q, который состоит из несвязного объединения
r простых периодических циклов ­
1
;:::;­
r
с периодами p
1
;:::;p
r
, т.е. Q
имеет N вершин и N дуг, где N = p
1
+¢¢¢+p
r
. В этом случае на Q суще-
ствует поток m
¤
такой, что m
¤
ij
=1=N. Отображение s: Q!G укладывает
циклы ­
1
;:::­
r
на периодические пути !
1
;:::;!
r
, соответственно. Согласно
Утверждению 2, мера дуги i! j есть сумма мер прообразов этой дуги при
отображении s, т.е. m
ij
= k
ij
=N, где k
ij
это общее число прохождений путей
!
1
;:::;!
r
через дугу i!j.
¯
Утверждение 4 допускает следующее обобщение.
Утверждение 5 Пусть наG существует семейство периодических путей
!
1
;:::;!
r
с периодами p
1
;:::;p
r
. Тогда на G имеется поток m такой, что
m
ij
=
X
t
ff
t
k
t
ij
=p
t
;
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 35Дифференциальные уравнения и процессы управления,N.4 , 2007
гдеff
t
¸0 и
P
t
ff
t
=1,k
t
ij
это число прохождений пути !
t
через дугу i!j.
Доказательство этого утверждения аналогично доказательству Утверждения
4. Заметим, что Утверждение 4 следует из Утверждения 5, если положить
ff
t
=p
t
=N, N =
P
t
p
t
. Из Утверждений 2 и 5 следует, что любой поток изZ
может быть построен методом, описанным в Утверждении 5.
5 Последовательность подразбиений и символических
образов
Рассмотримгомеоморфизмf :M !M,измеримоеразбиениеC исимволиче-
ский образ G, порожденный данным разбиением. Исследуем, что происходит
при последовательном измельчении покрытий. Пусть покрытие C подверга-
ется подразбиению, т.е. каждая ячейка M(i) разбивается на несколько ячеек
M(i1); M(i2); ::: так, что M(i) =
S
k
M(ik). Таким образом, мы получаем
новое покрытие NC и новый символический образ NG. В этом случае суще-
ствует [17] естественное отображение s: NG!G такое, что s(ik)=i; если
M(ik) ½ M(i). Это отображение является отображением ориентированных
графов, т.е. если на NG имеется дуга (ik) ! (jl), то на G существует дуга
i ! j. Отображение s позволяет перенести любой поток на NG в поток на
G; как это описано в разделе 4. Действительно, пусть на NG имеется по-
ток m
¤
=fm
ikjl
g, т.е. каждой дуге (ik)! (jl) приписана мера m
(ik)(jl)
, для
которой выполнены равенства
X
ikjl
m
(ik)(jl)
=1;
X
kp
m
(kp)(iq)
=
X
jl
m
(iq)(jl)
:
Определим поток m
ij
на графе G равенством
m
ij
=
X
kl
m
(ik)(jl)
;
т.е. мера дуги i ! j является суммой мер тех дуг (ik) ! (jl), которые
проектируются на i!j отображением s: NG!G.
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 36Дифференциальные уравнения и процессы управления,N.4 , 2007
Обозначим M(G) и M(NG) множество потоков на G и NG, соответ-
ственно. При рассмотрении отображения s возникает отображение пото-
ков s
¤
, которое действует из M(NG) в M(G), является однозначным и
s
¤
(M(NG))6=M(G), вообще говоря.
Построенныйпотокm=fm
ij
gнаграфеGявляетсяобразомпотокаm
¤
=
fm
(ik)(jl)
g на NG при отображении s
¤
. Мы будем писать s
¤
(m
¤
) = m. Для
любых двух потоков m
¤
2 M(NG) и m 2 M(G) будем говорить, что они
согласованы, если s
¤
(m
¤
)=m.
Теперь рассмотрим последовательные подразбиения C
1
; C
2
; C
3
; ::: та-
кие, что максимальный диаметр ячеек разбиений d
1
; d
2
; d
3
; ¢¢¢! 0: Такая
последовательность порождает последовательность символических образов
G
1
; G
2
; G
3
; ::: и отображений s : G
k
! G
k¡1
, s
¤
: M(G
k
) ! M(G
k¡1
).
Таким образом, определены последовательности вида:
G
1
s
Ã¡G
2
s
Ã¡G
3
s
Ã¡::::
и
M(G
1
)
s
¤
Ã¡M(G
2
)
s
¤
Ã¡M(G
3
)
s
¤
Ã¡::::
Пусть на каждом символическом образе G
k
выбран поток m
k
2M(G
k
), при-
чем эти потоки согласованы, т.е.
s
¤
(m
k+1
)=m
k
:
Для каждого k определена мера ¹
k
на M:
¹
k
(A)=
X
i
m
k
i
v(A\M(i))=v(M(i)); (6)
где A   измеримое множество, M(i)   ячейки разбиения C
k
, v   лебегова
мера, нормированная на M.
Теорема 1 Пусть C
k
  последовательные подразбиения такие, что мак-
симальный диаметр ячеек d
k
! 0. Если m
k
согласованная последователь-
ность потоков на символических образах G
k
, то существует мера ¹ инва-
риантная для f такая, что
¹= lim
d
k
!0
¹
k
;
где сходимость рассматривается в слабой топологии.
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 37Дифференциальные уравнения и процессы управления,N.4 , 2007
Доказательство. Пусть m
k
=fm
k
ij
g согласованная последовательность по-
токов на G
k
, Á   непрерывная функция на компакте M и C
k
= fM(i)g -
разбиение компакта M. Каждой ячейке M(i) припишем меру m
k
i
вершины
i2G
k
. Выберем точку x
i
2M(i) и построим интегральную сумму
F
k
(Á)=
X
i
Á(x
i
)m
k
i
:
Покажем, что существует предел
lim
k!1
F
k
(Á)=F(Á): (7)
Для этого достаточно показать, что последовательность F
k
(Á) является фун-
даментальной. Пусть C
l
есть подразбиение покрытия C
k
, l > k и ячейки
M(ir)2C
l
; r =1; 2; ::: образуют подразбиение ячейки M(i)2C
k
. Так как
последовательность потоков согласована, то m
k
=s
¤
(m
l
), что дает равенство
m
k
i
=
X
r
m
l
ir
; (8)
гдеm
ir
  мера ячейкиM(ir)2C
l
(или вершины(ir)2G
l
). Оценим разность
jF
k
(Á)¡F
l
(Á)j=j
X
i
Á(x
i
)m
k
i
¡
X
ir
Á(x
ir
)m
l
ir
j:
Учитывая (8) и равномерную непрерывность Á(x) на компакте M, получаем
jF
k
(Á)¡F
l
(Á)j=j
X
ir
(Á(x
i
)¡Á(x
ir
))m
l
ir
j·
X
ir
jÁ(x
i
)¡Á(x
ir
)jm
l
ir
·
sup
jx¡yj·d
k
jÁ(x)¡Á(y)j=ff(d
k
);
где ff(d)   модуль непрерывности функции Á, d
k
  максимальный диаметр
ячеек из покрытия C
k
. Так как ff(d)! 0 при d! 0, то последовательность
F
k
(Á) является фундаментальной и предел (7) существует.
Аналогично можно показать, что этот предел не зависит от выбора точек
x
i
2 M(i). Таким образом, определен линейный функционал F(Á), который
является ограниченным:jF(Á)j·jÁj и положительным: F(Á)¸0 при Á>0.
Тогда согласно теореме Рисса о представлении [1] существует мера ¹ такая,
что
F(Á)=
Z
M
Ád¹:
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 38Дифференциальные уравнения и процессы управления,N.4 , 2007
Для каждого k определена мера ¹
k
на M, на ячейке M(i) мера ¹
k
отлича-
ется от лебеговой постоянным сомножителем и мера ячейки ¹
k
(M(i)) = m
k
i
совпадает с мерой вершины i2G
k
. Покажем, что
lim
k!1
¹
k
=¹
в слабой топологии, т.е. надо показать, что для любой непрерывной функции
Á
Z
M
Ád¹
k
!
Z
M
Ád¹
приk!1. По теореме о среднем для каждой ячейкиM(i) существует точка
x
¤
i
в замыкании cl(M(i)) такая, что
Z
M(i)
Ád¹
k
=Á(x
¤
i
)¹
k
(M(i))=Á(x
¤
i
)m
k
i
:
Тогда
Z
M
Ád¹
k
=
X
i
Z
M(i)
Ád¹
k
=
X
i
Á(x
¤
i
)m
k
i
:
Таким образом, надо доказать равенство
lim
k!1
X
i
Á(x
¤
i
)m
k
i
= lim
k!1
X
i
Á(x
i
)m
k
i
;
гдеjx
¤
i
¡x
i
j·d
k
. Это можно доказать аналогично предыдущему, используя
модуль непрерывности функции Á.
Известно [1], что инвариантность меры ¹ относительно f следует из ра-
венства Z
M
Ád¹=
Z
M
Á(f)d¹;
гдеÁ любаяфункциянепрерывнаянаM.Рассмотриминтегральнуюсумму
F
k
(Á)=
P
i
Á(x
i
)m
k
i
, где
m
k
i
=
X
j
m
k
ij
=
X
r
m
k
ri
:
Тогда
F
k
(Á)=
X
i
Á(x
i
)
X
r
m
k
ri
=
X
ir
Á(x
i
)m
k
ri
:
Для каждого слагаемого Á(x
i
)m
k
ri
заменим точку x
i
точкой x
ri
так, что x
ri
2
f(M(r))\M(i): При этом мы получаем
F
k
(Á)=
X
ir
Á(x
ri
)m
k
ri
+
X
ir
(Á(x
i
)¡Á(x
ri
))m
k
ri
=
X
ir
Á(x
ri
)m
k
ri
+"
¤
;
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 39Дифференциальные уравнения и процессы управления,N.4 , 2007
где "
¤
оценивается модулем непрерывности функции Á и "
¤
(d
k
) ! 0 при
k ! 1. Для каждой точки x
ri
2 f(M(r))\ M(i) существует точка z
ri
2
M(r)\f
¡1
(M(i)) такая, что f(z
ri
)=x
ri
, т.е. z
ri
=f
¡1
(x
ri
). Получаем
F
k
(Á)=
X
ir
Á(f(z
ri
))m
k
ri
+"
¤
;
где все точки z
ri
; i=1; i=2; ::: лежат в ячейке M(r). Заменим эти точки
одной точкой z
r
2M(r). Получаем равенство
F
k
(Á)=
X
ir
Á(f(z
r
))m
k
ri
+
X
ir
(Á(f(z
ri
))¡Á(f(z
r
)))m
k
ri
+"
¤
=
X
r
Á(f(z
r
))
X
i
m
k
ri
+"
¤¤
+"
¤
=
X
r
Á(f(z
r
))m
k
r
=F
k
(Á(f))+"
¤¤
+"
¤
;
где "
¤¤
оценивается через модуль непрерывности суперпозиции Á(f) и
"
¤¤
(d
k
)! 0 при k !1. Переходя к пределу при k !1; приходим к иско-
мому равенству
F(Á)=F(Á(f)):
Теорема доказана.
¯
Как было отмечено во Введении, каждая инвариантная мера ¹ порождает по
формуле (1) последовательность потоков m
k
на символических образах для
любой последовательности подразбиений C
1
; C
2
; C
3
; :::. Нетрудно прове-
рить, что эта последовательность является согласованной. Доказанная теоре-
ма гарантирует обратное: каждая согласованная последовательность потоков
m
k
на символических образах G
k
таких, что максимальный диаметр ячеек
d
k
!0, порождает инвариантную меру.
Следствие 1 Любая инвариантная мера ¹ может быть построена мето-
дом, указанным в Теореме 1.
6 Стохастические цепи Маркова
Стохастическая цепь Маркова [9] определяется набором состояний fi =
1; 2; :::ng и вероятностями перехода P
ij
из состояния i в состояние j.
Матрица вероятностей переходов P = (P
ij
) является стохастической мат-
рицей ( P
ij
¸ 0 и
P
j
P
ij
= 1 для каждого i). Распределение вероятностей
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 40Дифференциальные уравнения и процессы управления,N.4 , 2007
p=(p
1
;p
2
;:::;p
n
),
P
i
p
i
=1 называется стационарным, если
(p
1
;p
2
;:::;p
n
)
0
B
B
B
B
@
P
11
P
12
::: P
1n
P
21
P
22
::: P
2n
¢ ¢ ::: ¢
P
n1
P
n2
::: P
nn
1
C
C
C
C
A
=(p
1
;p
2
;:::;p
n
);
т.е. p является левым стационарным вектором матрицы P. Следует отме-
тить, что часто [1] стохастическая матрица определяется так, что она яв-
ляется транспонированной по отношению к выше описанной. В этом случае
стационарное распределение является правым собственным вектором.
Каждый инвариантный поток m = fm
ij
g на графе G порождает сто-
хастическую цепь Маркова, у которой состояния i совпадают с вершинами
fij m
i
6=0g, а вероятности перехода i!j вычисляются как
P
ij
=m
ij
=m
i
:
Стахастическая матрица P = (m
ij
=m
i
) имеет стационарное распределение
(m
1
;m
2
;:::;m
n
), т.к.
(m
1
;m
2
;:::;m
n
)
0
B
B
B
B
@
m
11
=m
1
m
12
=m
1
::: m
1n
=m
1
m
21
=m
2
m
12
=m
2
::: m
2n
=m
2
¢ ¢ ::: ¢
m
n1
=m
n
m
n2
=m
n
::: m
nn
=m
n
1
C
C
C
C
A
=(m
1
;m
2
;:::;m
n
):
Таким образом, любой инвариантный поток m = fm
ij
g на графе G порож-
дает стохастическую цепь Маркова, для которой распределение меры по вер-
шинам (m
i
) является стационарным.
Покажем обратное: для любой стохастической матрицы P = (P
ij
) и ее
стационарного распределения p = (p
i
) существует инвариантный поток m =
fm
ij
g, для которого распределение меры по вершинам m
i
=p
i
.
Действительно, пусть P стохастическая матрица и pP = p. Рассмотрим
граф G, который имеет n вершинfig и дуга i! j существует, если P
ij
> 0.
Построим распределение на дугах m
ij
= P
ij
p
i
и покажем, что это распре-
деление является потоком на G. Так как P   стохастическая матрица, то
P
j
P
ij
=1 для любого i. Тогда
X
j
m
ij
=
X
j
P
ij
p
i
=p
i
X
j
P
ij
=p
i
:
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 41Дифференциальные уравнения и процессы управления,N.4 , 2007
Так как pP =p, то
P
k
p
k
P
ki
=p
i
. Тогда
X
k
m
ki
=
X
k
p
k
P
ki
=p
i
=
X
j
m
ij
;
т.е. для распределенияm
ij
выполнен закон Кирхгофа. Кроме того,
P
ij
m
ij
=
P
i
p
i
=1.
Из описанных рассуждений следует, что технология построения потока
на графе эквивалентна методу стохастической матрицы. В работах [6, 8, 10,
11, 12] используются стохастические матрицы вида
P
ij
=v(M(i)\f
¡1
(M(j)))=v(M(i));
где v   мера Лебега. В этих работах показано, что при некоторых допол-
нительных условиях методом стохастической матрицы строится "физиче-
ская"инвариантная мера (Синая-Боуэна-Рюэля), которая активно использу-
ется физиками. Ясно, что построение стохастической матрицы по мере, от-
личной от лебеговой, тоже приводит к некоторой инвариантной мере, вообще
говоря, отличной от меры Синая-Боуэна-Рюэля. Более того, стохастическую
матрицу можно получить, исходя из 0-1 матрицы ¦ = (¼
ij
) (¼
ij
= 1 если
есть дуга i ! j, иначе ¼
ij
= 0). Положив, P
ij
= ¼
ij
=
P
k
¼
ik
, мы получим
стохастическую матрицу, по которой можно строить инвариантную меру.
7 Реализация алгоритма
При построении инвариантной меры на символическом образе мы использо-
вали Утверждение 1 раздела 4 и реализовали алгоритм построения инвари-
антногопотока,каклинейнойкомбинациипростыхпотоков.Рассмотримпри-
ближенный алгоритм нахождения циклов, который имеет сложность O(mn),
где m и n число вершин и дуг графа, соответственно.
Пусть G=(V;E)   ориентированный граф. Обозначим через i!j дугу
между вершинами i;j:
Определение 2 Будем говорить, что вершина c является потомком вер-
шины p (или c является предком вершины p), если p родительская вершина
c либо если родитель c является потомком p.
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 42Дифференциальные уравнения и процессы управления,N.4 , 2007
7.1 Построение циклов
Алгоритм использует поиск в ширину и обходит все компоненты связности.
Одновременно строится дерево поиска, где существование ребра p!c озна-
чает,чтосредивершин,достижимыхизpвграфеGбыларассмотренаверши-
на c. Для работы алгоритма достаточно хранить только ссылку из вершины-
потомка(c) на вершину-родителя(p).
Узел дерева поиска представляется парой (вершина, указатель на роди-
тельский узел дерева поиска), ref обозначает операцию вычисления указа-
теля на пару, null   пустой указатель, маркер вершины дерева поиска, q
обозначает очередь таких пар.
1. Выберем произвольную вершину i.
2. Положим в q пару (i;null).
3. Пока очередь q не пуста выберем пару (r;p) из q.
4. Есливершинаr ужебыла рассмотрена, пропуститьее. Перейти нашаг 3.
5. Иначе для всех ребер r!j2E выполнить
(a) Если вершина j уже рассмотрена и является потомком вершины r,
то найден цикл   путь в дереве поиска от вершины r к вершине j.
Вершины найденного цикла можно перебрать при помощи ссылок
на родительскую вершину пар представления дерева поиска.
(b) Иначе, положить (j;ref(r;p)) в очередь.
Проверка факта обработки вершины алгоритмом может быть выполнена
за константное время, если хранить дополнительный флаг в самой вершине.
Каждая вершина рассматривается не более одного раза. Для проверки того,
найден ли новый цикл потребуется пройти по дереву поиска вверх. Такую
операцию можно выполнить за линейное от количества вершин время.
Заметим, что некоторые циклы могут быть не найдены. Чтобы преодо-
леть эту ситуацию, мы использовали модификацию алгоритма, в дальнейшем
называемую "улучшенный алгоритм". В этом случае приближенный алго-
ритм применяется ко всем вершинам, которые не вошли ни в один из найден-
ных циклов. Используя этот алгоритм, мы сможем назначить вес большему
количествудуг,но сложностьбудетпорядкаO(n£O(nm)); что соответствует
O(n
2
£m):
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 43Дифференциальные уравнения и процессы управления,N.4 , 2007
7.2 Построение меры (потока) на графе
Циклы обрабатываются по мере их нахождения, т.е. мера назначается оче-
редному найденному циклу. В начале работы всем дугам приписывается зна-
чение 0: В процессе работы алгоритм приписывает им значения описанным
ранее способом с выбором весов a
z
с помощью функции g :N
0
!R:
1. Для каждого найденного цикла l выполним следующее:
(a) Вычислим u=
g(jlj)
jlj
; гдеjlj обозначает число дуг в цикле l.
(b) Для всех дуг e цикла l положим m(e):=m(e)+u.
2. Перебор циклов завершен. Проведем нормировкуfmg:
(a) Вычислим w :=
P
e2E
m(e),
(b) положим m(e):=
m(e)
w
Для эффективной реализации этого алгоритма вес каждого ребра хра-
нится в структуре данных самого ребра. Это позволяет проводить операции
обновления значения m(e) за константное время.
В численной реализации мы рассматривали g(l) = 1; что соответствует
выбору одинаковых коэффициентов a
z
: После расстановки мер на дугах вы-
числим меры в вершинах графа. Таким образом мы получаем распределение
меры в ячейках покрытия, соответствующего графу символического образа.
8 Численные эксперименты
Для построения символического образа используются методы, описанные в
[5]. Символический образ строится при помощи линейного метода, при этом
последний шаг построения символического образа проводится точечным ме-
тодом.
8.1 Отображение Хенона [13, 7] при a=1:2, b=0:2
Рассмотрим систему:
Ã
x
y
!
!
Ã
1¡ax
2
+y=5
5bx
!
; (9)
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 44Дифференциальные уравнения и процессы управления,N.4 , 2007
при a=1:2, b=0:2.
Известно [17], что при заданных параметрах у этой системы существует
инвариантное множество в области [¡2;2]£[¡2;2]. Возьмем M = [¡2;2]£
[¡2;2]. Проведем 13 шагов построения символического образа. На каждом
шаге будем подразбивать ячейку на 4 равных части.
Проведем построение символического образа при помощи линейного ме-
тода [5]. Полученный символический образ состоит из 10 компонент сильной
связности с количеством вершин 129419, 6974, 388, 16, 15, 7, 6, 5, 3 и 3 соот-
ветственно. Размеры ячейки составляют 0:00024£00024.
На рис. 2 и рис. 3 показано распределение меры по ячейкам покрытия
(вершинам графа). Вычисления проводились двумя способами поиска про-
стых циклов   приближенным и улучшенным. В плоскости показано постро-
енное инвариантное множество динамической системы. Над каждой ячейкой
отрезком прямой обозначено соответствующее значение построенной меры.
Рис. 2: Отображение Хенона при a = 1:2, b = 0:2. Приближенный метод нахождения
циклов.
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 45Дифференциальные уравнения и процессы управления,N.4 , 2007
Рис. 3: Отображение Хенона при a=1:2, b=0:2. Улучшенный метод нахождения циклов.
В работе [7] приводится результат приближенного построения так назы-
ваемой меры Синая-Рюэля-Боуэна (SRB-меры) для отображения Хенона при
рассмотренных параметрах. Метод построения основан на аппроксимации
оператора Перрона-Фробениуса. На следующих рисунках показаны резуль-
таты построения инвариантной меры методом работы [7] и улучшенным ме-
тодом поиска простых циклов.
8.2 Отображение Икеда [14]
Отображение Икеда возникает при моделировании оптических носителей
(кристаллов) информации и имеет вид:
¿(x;y) = C
1
¡
C
3
1+x
2
+y
2
(10)
Ã
x
y
!
!
Ã
d ¡ C
2
(xcos¿(x;y)¡ysin¿(x;y))
C
2
(xsin¿(x;y)+ycos¿(x;y))
!
; (11)
где d=2, C
1
=0:4, C
2
=0:9, C
3
=6.
Отображение обладает свойством сжатия площадей и имеет глобальный
аттрактор A
g
. В [14, 16] было показано, что при заданных параметрах это
отображение имеет цепно-рекуррентное множество. Пусть M = [¡10;10]£
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 46Дифференциальные уравнения и процессы управления,N.4 , 2007
Рис. 4: Построение инвариантной меры для отображения Хенона: cлева результат, полу-
ченный в [7], справа   метод поиска простых циклов.
[¡10;10]. Проведем 9 шагов построения символического образа. Получен-
ный символический образ состоит из двух компонент сильной связности с
количеством вершин 44101 и 2 соответственно. Размеры ячейки составляют
0:026£0:026.
Распределение полученной меры показано на рис. 5.
Рис. 5: Отображение Икеда. Улучшенный метод поиска циклов.
Рассмотрим отображение Икеда при тех же значениях параметров в об-
ласти­=[¡1:1;3:5]£[¡1:5;1:8].Какизвестно,[4]вэтойобластисодержится
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 47Дифференциальные уравнения и процессы управления,N.4 , 2007
максимальное цепно-рекуррентное множество исходного отображения. Мно-
жество ­ распадается на две компоненты ­
1
и ­
2
, соответствующие двум
компонентам сильной связности на символическом образе. Множество ­
1
представляет собой периодическую орбиту периода 6, а ­
2
является инвари-
антным множеством с нетривиальной фрактальной структурой [16]. Прове-
дем13шаговпостроениясимволическогообраза.Полученныйсимволический
образ состоит из двух компонент сильной связности с количеством вершин
3823 и 47 соответственно. Размеры ячеек составляют 0:00018£0:00012
На рис. 6 приведены результаты построения инвариантной меры в ука-
занной области.
Рис. 6: Отображение Икеда в области ­: Улучшенный метод.
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 48Дифференциальные уравнения и процессы управления,N.4 , 2007
Приведенные примеры показывают, что при использовании приближен-
ного метода (в зависимости от выбора начальной вершины) большое количе-
ство ребер может получить нулевую меру. Метод работает довольно быстро
и может применяться для получения первого приближения к искомой мере.
Улучшенный метод поиска циклов требует гораздо больше времени, но
практически все ребра получают ненулевой вес.
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 49Дифференциальные уравнения и процессы управления,N.4 , 2007
Список литературы
[1] Каток А.Б., Хасселблат Б. Введение в современную теорию динамиче-
ских систем. Москва 1999.
[2] Осипенко Г.С. О символическом образе динамической системы. Гранич-
ные задачи. Сб. трудов, Пермь, 1983, 101-105.
[3] Осипенко Г.С. Построение инвариантных мер и оценка энтропии дина-
мическихсистем.Нелинейныйдинамическийанализ-2007,4-8июня2007,
Санкт-Петербург, Тезисы докладов, с.379.
[4] Осипенко Г.С., Романовский И.В., Ампилова Н.Б., Петренко Е. О вычис-
лении спектра Морса. Проблемы Математического Анализа, Выпуск 27,
Январь 2004, с. 151-169.
[5] Петренко Е.И. Разработка и реализация алгоритмов построения сим-
волического образа. Эл. ж. Дифференциальные уравнения и процессы
управления.  т.3,2006.
[6] Dellnitz Michael and Junge Oliver. On the approximation of complicated
dynamical behaviour. SIAM Journal for Numerial Analysis, v. 36 (1999), no.
2, 491-515.
[7] Michael Dellnitz and Oliver Junge. Set oriented numerical methods for
dynamical systems.in Handbook of dynamical systems,v.2, Ed.B.Fiedler,
2002.
[8] Jiu Ding and Aihui Zhou, Finite approximation of Frobenius-Perron
operarors, a solution of Ulam’s conjecture to multi-dimensional
transformation. Physica D, v. 92 (1992), no. 1-2, 61-66.
[9] Douglas Lind, Brian Marcus. An introduction to symbolic dynamics and
coding. Cambridge, 1995.
[10] Froyland Gary. Approximating physical invariant measures of mixing
dynamical systems in higher dimensions. Nonlinear Analysis, Methods and
Applications, v.32 (1998), no. 7, 831-860.
[11] Froyland G, Jung O, Ochs G. Rigorous computation of topological entropy
with respect to a ﬁnite partition. Physica D 154 (2001), no. 1-2, 68-84.
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 50Дифференциальные уравнения и процессы управления,N.4 , 2007
[12] Froyland Gary. On Ulam approximation of the isolated spectrum and
eigenfunctions of hyperbolic maps. Discrete and Continuous Dynamical
Systems, v. 17 (2007), no.3, 203-221.
[13] Henon M. A two-dimensional mapping with a strange attractor. Comm.
Math.Phys. v.50,69-77(1976).
[14] Ikeda K. Multiple-valued stationary state and its instability of the
transmitted light by a ring cavity system. Opt. Comm. 1979, Vol.30, p.257-
261.
[15] Kryloff N, Bogollouboff N. La theorie generale de la mesure dans son
application a l’etude das systemes dynamiques de la mecanique non lineaire.
Ann. Math. v. 38 (1937), no. 1, 65-113.
[16] Osipenko G. Numerical Explorations of the Ikeda mapping dynamics.
Electronic Journal of Differentional Equations and Control Processes
(), Vol.2, 2004.
[17] Osipenko George, Dynamical systems, Graphs, and Algorithms, Springer,
2007
Электронный журнал. , http://www.math.spbu.ru/user/diffjournal/ 51
