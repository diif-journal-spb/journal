dx
dt
6
 
-
?
ДИФФЕРЕНЦИАЛЬНЫЕ УРАВНЕНИЯ
И
ПРОЦЕССЫ УПРАВЛЕНИЯ
N 1, 2015
Электронный журнал,
рег. Эл. N ФС77-39410 от 15.04.2010
ISSN 1817-2172
http://www.math.spbu.ru/diffjournal
e-mail: jodiff@mail.ru
Фильтрация и идентификация
Алгоритмы прогнозирования состояний
в стохастических дифференциальных системах на основе
моделирования специального ветвящегося процесса
∗
К.А. Рыбаков
Московский авиационный институт (национальный исследовательский университет),
rkoﬃce@mail.ru
Аннотация. Предлагаются новые алгоритмы решения задачи прогнозирования для
нелинейных стохастических дифференциальных систем методом статистических испыта-
ний. Основу алгоритмов прогнозирования составляют алгоритмы оптимальной фильтра-
ции, использующие моделирование специального случайного процесса с обрывами и ветв-
лениями траекторий. При решении задачи прогнозирования применяются методы чис-
ленногорешениястохастическихдифференциальныхуравненийиметодымоделирования
неоднородных пуассоновских потоков.
Abstract. New algorithms for solving the extrapolation problem for nonlinear stochastic
differential systems by statistical modeling are given. These algorithms are based on optimal
ﬁltering algorithms by modeling the special random process with terminating and branching
paths. The solution of extrapolation problem can be found by numerical methods for solving
stochastic differential equations and methods for modeling inhomogeneous Poisson ﬂows.
Введение
На основе многих методов и алгоритмов решения задачи фильтрации в стохасти-
ческих системах, т.е. задачи оценивания вектора состояния системы в текущий момент
времени по результатам косвенных измерений с учетом случайных возмущений и помех,
естественным образом могут быть сформированы методы и алгоритмы решения задачи
прогнозирования, т.е. задачи оценивания вектора состояния системы в будущий момент
времени по результатам косвенных измерений, имеющихся к текущему моменту.
Цельнастоящейработысостоитвформированииалгоритмовпрогнозированиявнели-
нейных стохастических дифференциальных системах [9,12,13] на основе рассмотренных
 
Работа выполнена при финансовой поддержке РФФИ (проект № 13-08-00323-а).Дифференциальные уравнения и процессы управления, N. 1, 2015
ранее алгоритмов оптимальной нелинейной фильтрации. В [10,11] было предложено ре-
шать задачу оптимальной нелинейной фильтрации как задачу анализа вспомогательной
стохастической системы с обрывами и ветвлениями траекторий. Такой подход к решению
задачи фильтрации основан на интерпретации одного из слагаемых в уравнении Дунка-
на–Мортенсена–Закаикакфункциипоглощенияивосстановлениятраекторийслучайно-
го процесса. Напомним, что решением уравнения Дункана–Мортенсена–Закаи является
ненормированнаяплотностьвероятности,характеризующаяраспределениевекторасосто-
яния объекта наблюдения при наличии косвенных измерений с начального и до текущего
момента времени [8,9,12,13].
Решениезадачианализавспомогательнойстохастическойсистемысобрывамииветв-
лениями траекторий можно найти приближенно с помощью статистического моделирова-
ния,применяяметодычисленногорешениястохастическихдифференциальныхуравнений
и методы моделирования неоднородных пуассоновских потоков (обрывы и ветвления об-
разуют неоднородные пуассоновские потоки событий с интенсивностями, зависящими от
текущего измерения). По результатам моделирования траекторий вспомогательной стоха-
стической системы можно оценить апостериорную плотность вероятности при фиксиро-
ванныхизмеренияхинайтиоптимальнуюоценкувекторасостоянияобъектанаблюдения,
используя различные критерии оптимальности оценивания.
Например, при использовании критерия минимума среднеквадратической ошибки
оценка текущего состояния может быть получена в результате усреднения по ансамблю
траекторий системы, отличающейся от исходного объекта наблюдения только тем, что ее
траектории обрываются и разветвляются в случайные моменты времени, распределение
которых определяется результатами измерений оцениваемого вектора состояния. Прогноз
состояния можно получить, если продолжить моделирование без обрывов и ветвлений
траекторий, используя сформированную к текущему моменту времени выборку состоя-
ний вспомогательной стохастической системы и усредняя по полученному в результате
ансамблю траекторий.
Для апробации предложенных алгоритмов прогнозирования состояний стохастиче-
ских дифференциальных систем решены модельные задачи прогнозирования для одно-
мерных стохастических систем наблюдения с фиксированным упреждением по времени и
в фиксированный момент времени.
Постановка задачи
Будем рассматривать модель объекта наблюдения, описываемую стохастическим
дифференциальным уравнением Ито [7–9]
dX(t) = f
(
t,X(t)
)
dt+σ
(
t,X(t)
)
dW(t), X(t
0
) = X
0
, (1)
где X ∈R
n
— вектор состояния, t∈ [t
0
,T +∆(T)] — время; f(t,x): [t
0
,T +∆(T)]×R
n
→
R
n
— вектор-функция размеров n×1, σ(t,x): [t
0
,T +∆(T)]×R
n
→R
n×s
— матричная
функция размеров n×s; ∆(t): [t
0
,T]→ [0,+∞) — величина опережения по времени:
max
t∈[t
0
,T]
(
t+∆(t)
)
= T +∆(T);
W(t) — s-мерный стандартный винеровский процесс, не зависящий от начального состоя-
ния X
0
, заданного плотностью вероятности φ
0
(x).
Модель измерительной системы также записывается в форме стохастического диф-
ференциального уравнения:
dY(t) = c
(
t,X(t)
)
dt+ζ(t)dV(t), Y(t
0
) = Y
0
= 0, (2)
Электронный журнал. http://www.math.spbu.ru/diffjournal 26Дифференциальные уравнения и процессы управления, N. 1, 2015
или
Z(t) = c
(
t,X(t)
)
+ζ(t)N(t), (3)
где Y,Z ∈R
m
— векторы измерений; c(t,x): [t
0
,T +∆(T)]×R
n
→R
m
— вектор-функция
размеров m×1, ζ(t): [t
0
,T +∆(T)]→R
m×d
— матричная функция размеров m×d,
detζ(t)ζ
T
(t) ̸= 0; V(t) — d-мерный стандартный винеровский процесс, не зависящий от
W(t) и X
0
; N(t) — d-мерный стандартный гауссовский белый шум [8,9,13].
Задача прогнозирования состоит в нахождении оценки
ˆ
X(t + ∆(t)) по результатам
измерений Y
t
0
={Y(τ), τ ∈ [t
0
,t)}.
При формировании алгоритма будем исходить из несмещенности оценки и минимума
среднеквадратического отклонения. Тогда
ˆ
X
(
t+∆(t)
)
=M
[
X
(
t+∆(t)
)
|Y
t
0
]
=
∫
R
n
xp
(
t+∆(t),x|Y
t
0
)
dx,
где M — знак математического ожидания, p(t + ∆(t),x|Y
t
0
) — апостериорная плотность
вероятности прогноза вектора состояния X.
Будем рассматривать два варианта задачи прогнозирования: прогнозирование с фик-
сированнымупреждением,т.е. ∆(t) = ∆ = const,ипрогнозированиевфиксированныймо-
мент времени T
′
> T, т.е. ∆(t) = T
′
−t.
Отметим, кроме того, что задачу прогнозирования можно сформулировать и в тер-
минах измерений Z
t
0
={Z(τ), τ ∈ [t
0
,t)}, в данном случае это не имеет принципиального
значения,однакодалеепризаписинеобходимыхсоотношенийдлярешениязадачипрогно-
зирования будут использоваться как измерения Y(t), так и Z(t).
Уравнения для апостериорной плотности вероятности
Задачу прогнозирования будем решать в два этапа. На первом этапе будем опре-
делять апостериорную плотность вероятности p(t,x|Y
t
0
), используя уравнение Дункана–
Мортенсена–Закаи [8,12,13], записанное в форме [10,11]:
∂φ(t,x|Y
t
0
)
∂t
=Aφ(t,x|Y
t
0
)−λ
−
(
t,x,Z(t)
)
φ(t,x|Y
t
0
)+λ
+
(
t,x,Z(t)
)
φ(t,x|Y
t
0
), (4)
с начальным условием φ(t
0
,x) = φ
0
(x), где
Aφ(t,x|Y
t
0
) =−
n
∑
i=1
∂
∂x
i
[
f
i
(t,x)φ(t,x|Y
t
0
)
]
+
1
2
n
∑
i=1
n
∑
j=1
∂
2
∂x
i
∂x
j
[
g
ij
(t,x)φ(t,x|Y
t
0
)
]
;
λ
−
(t,x,z) =
{
−λ(t,x,z), λ(t,x,z) < 0,
0, λ(t,x,z)> 0,
λ
+
(t,x,z) =
{
λ(t,x,z), λ(t,x,z) > 0,
0, λ(t,x,z)6 0,
λ(t,x,z) =
m
∑
k=1
m
∑
r=1
c
k
(t,x)q
kr
(t)
(
z
r
−
c
r
(t,x)
2
)
;
g(t,x) = σ(t,x)σ
T
(t,x), g
ij
(t,x) =
s
∑
l=1
σ
il
(t,x)σ
jl
(t,x), i,j = 1,2,...,n;
q(t) = η
−1
(t), η(t) = ζ(t)ζ
T
(t), η
kr
(t) =
d
∑
l=1
ζ
kl
(t)ζ
rl
(t), k,r = 1,2,...,m.
Электронный журнал. http://www.math.spbu.ru/diffjournal 27Дифференциальные уравнения и процессы управления, N. 1, 2015
Уравнение (4) решается на промежутке [t
0
,θ], где θ∈ [t
0
,T] — некоторое текущее
время. Затем его решение нормируется, результатом этой операции будет апостериорная
плотность вероятности p(t,x|Y
t
0
) вектора состояния X:
p(t,x|Y
t
0
) =
φ(t,x|Y
t
0
)
∫
R
n
φ(t,x|Y
t
0
)dx
, t∈ [t
0
,θ], (5)
причем предполагается, что измерения Y
t
0
или Z
t
0
фиксированы.
На втором этапе определяется апостериорная плотность вероятности p(t,x|Y
θ
0
) как
решение уравнения Фоккера–Планка–Колмогорова
∂p(t,x|Y
θ
0
)
∂t
=Ap(t,x|Y
θ
0
) (6)
на промежутке [θ,θ +∆(θ)] с начальным условием p(θ,x|Y
θ
0
).
Заметим, что оба этапа можно объединить в один, а именно решать уравнение (4) на
промежутке [t
0
,θ +∆(θ)] при дополнительном условии λ(t,x,z) = 0, если t> θ. Решени-
ем такой задачи будет ненормированная апостерироная плотность вероятности φ(t,x|Y
θ
0
)
как функция текущего времени θ∈ [t
0
,T] и будущего момента времени θ6 t6 θ +∆(θ),
для которого оценивается вектор состояния. Для перехода к апостериорной плотности
вероятности p(t,x|Y
θ
0
) нужна нормировка, аналогичная (5):
p(t,x|Y
θ
0
) =
φ(t,x|Y
θ
0
)
∫
R
n
φ(t,x|Y
θ
0
)dx
, t∈ [θ,θ +∆(θ)], θ∈ [t
0
,T].
Уравнения вида (4) называются обобщенными уравнениями Фоккера–Планка–
Колмогорова [2]. Для уравнения (4) слагаемое λ
−
(t,x,Z(t))φ(t,x|Y
t
0
) — это функция по-
глощения, а λ
+
(t,x,Z(t))φ(t,x|Y
t
0
) — функция восстановления. Это означает, что можно
рассматривать специальный случайный процесс X(t), который характеризуется коэффи-
циентами сноса f(t,x) и диффузии g(t,x), но в отличие от обычного диффузионного про-
цессаеготраекториимогутдополнительнообрыватьсяиобрывыобразуютпуассоновский
потоксобытийсинтенсивностьюλ
−
(t) = λ
−
(t,X(t),Z(t)),амогутпоявлятьсяновыеветви
и ветвления также образуют пуассоновский поток событий, но с другой интенсивностью
λ
+
(t) = λ
+
(t,X(t),Z(t)).
Кэтомуможнодобавить,чтовероятностьP
−
(t,∆t)обрыватраекторииивероятность
P
+
(t,∆t) ветвления траектории на промежутке времени [t,t+∆t] при X(t) = x и Z(t) = z
удовлетворяют условию
P
−
(t,∆t) = λ
−
(t,x,z)∆t+o(∆t), P
+
(t,∆t) = λ
+
(t,x,z)∆t+o(∆t).
Обрывы и ветвления траекторий случайного процесса X(t) могут быть только на
промежутке [t
0
,θ], а на промежутке (θ,θ +∆(θ)] поведение траекторий определяется за-
данными коэффициентами сноса и диффузии. Таким образом, функция φ(t,x|Y
θ
0
), харак-
теризует распределение вектора X — состояния объекта наблюдения, описываемого урав-
нением(1),—сучетомтого,чтотраекториислучайногопроцесса X(t)могутобрыватьсяи
разветвляться в случайные моменты времени. Распределением моментов времени появле-
нияобрывовиветвленийуправляетпроцессZ(t).Приt = θфункцияφ(t,x|Y
θ
0
)определяет
Электронный журнал. http://www.math.spbu.ru/diffjournal 28Дифференциальные уравнения и процессы управления, N. 1, 2015
распределениевекторасостоянияX сучетомвсехимеющихсяктекущемумоментувреме-
никосвенныхизмеренийY
θ
0
,поэтойфункцииможнонайтиоптимальнуюоценкутекущего
вектора состояния объекта наблюдения, т.е. решить задачу фильтрации [10,11]. При t> θ
функция φ(t,x|Y
θ
0
) задает распределение прогноза вектора состояния X с учетом имею-
щихся измерений к моменту времени θ, т.е. с опережением по времени на (t−θ), по этой
функции можно найти прогноз для вектора состояния объекта наблюдения, т.е. решить
задачу прогнозирования. Структурная схема системы наблюдения, оценивания текущего
состояния и прогнозирования изображена на рис. 1.
Рис. 1. Структурная схема системы наблюдения, оценивания текущего состояния
и прогнозирования.
Приближенный метод прогнозирования
Для приближенного определения прогноза вектора состояния
ˆ
X(t+∆(t)) предлага-
ется модифицировать алгоритмы, предложенные в [10,11] для приближенного решения
задачи оптимальной фильтрации с помощью метода статистических испытаний (метода
Монте-Карло). Алгоритмы базируются на моделировании траекторий специального слу-
чайного процесса X(t) с учетом обрывов и ветвлений при фиксированных измерениях Y
t
0
илиZ
t
0
.Приэтомможноприменятьизвестныеметодычисленногорешениястохастических
дифференциальныхуравненийиметодымоделированиянеоднородныхпуассоновскихпо-
токов [1,3,5,6,8,14–16].
Электронный журнал. http://www.math.spbu.ru/diffjournal 29Дифференциальные уравнения и процессы управления, N. 1, 2015
Восновуалгоритмов,какив[10],положимнаиболеепростойметодчисленногореше-
ниястохастическихдифференциальныхуравнений—стохастическийметодЭйлера(метод
Эйлера–Маруямы) [3,8,16]:
X
k+1
= X
k
+hf(t
k
,X
k
)+
√
hσ(t
k
,X
k
)∆W
k
, Y
k+1
= Y
k
+hc(t
k
,X
k
)+
√
hζ(t
k
)∆V
k
,
Z
k
= c(t
k
,X
k
)+
ζ(t
k
)
√
h
∆V
k
(Y
k+1
= Y
k
+hZ
k
), t
k
= t
0
+hk, k = 0,1,...,
(7)
где ∆W
k
и ∆V
k
— случайные векторы размеров s×1 и d×1 соответственно, их коорди-
наты независимы и имеют стандартное нормальное распределение, h — шаг численного
интегрирования.
Для моделирования моментов времени обрывов и ветвлений траекторий использу-
ется метод «максимального сечения» [1,5,15]: моделирование времени τ, через которое
произойдет обрыв или ветвление, осуществляется по правилу
τ = θ
N
, N = min
{
µ: α
µ
6
|λ(t
∗
+θ
µ
)|
λ
∗
}
, θ
µ
=
µ
∑
i=1
ξ
i
, (8)
где ξ
1
, ξ
2
, ..., ξ
µ
, ...— последовательность независимых одинаково распределенных слу-
чайных величин, имеющих показательное распределение с параметром λ
∗
:
ξ
i
=−
lnβ
i
λ
∗
, λ
∗
: |λ(t)|6 λ
∗
= const;
α
1
,α
2
,...,α
µ
,...,β
1
,β
2
,...,β
µ
,...,—последовательностинезависимыхслучайныхвели-
чин, имеющих равномерное распределение на интервале (0,1); λ(t) — значение функции
λ(t,x,z) на вспомогательных траекториях процесса X(t) и траектории Z(t), полученной
в результате измерений на оцениваемой траектории, т.е. λ(t) = λ(t,X(t),Z(t)); t
∗
— на-
чальный момент времени t
0
или момент времени последнего ветвления траектории. При
условии λ(t
∗
+τ) < 0 происходит обрыв (моделирование такой траектории прекращает-
ся), а при λ(t
∗
+τ) > 0 — ветвление (далее моделируются две траектории, имеющие как
минимум одну общую точку — точку ветвления).
Возможны и другие варианты моделирования времени τ, но наиболее эффективным,
по-видимому, является метод «максимального сечения» или его модификации [1,5,6].
На основе результатов моделирования траекторий специального случайного процес-
са X(t) с обрывами и ветвлениями в каждый момент времени можно оценить функцию
распределения и плотность вероятности, а также найти оценку вектора состояния как
для текущего времени (фильтрация), так и для будущего (прогнозирование), например,
усредняя по ансамблю траекторий с учетом того, что на этапе прогнозирования обрывы
и ветвления не происходят.
Алгоритмы совместного моделирования
системы наблюдения и прогнозирования
Как и в [10], приведем два алгоритма совместного моделирования системы наблю-
дения и прогнозирования. В первом из них предполагается, что за время, равное ша-
гу численного интегрирования, может произойти только одно событие типа обрыва или
ветвлениятраектории.Такойалгоритмпрощевреализации,однаконеоднородныйпуассо-
новскийпотокмоделируется,вообщеговоря,неточно.Вовторомалгоритметакихограни-
чений на количество событий типа обрыва или ветвления траектории не накладывается,
пуассоновский поток моделируется точно в рамках метода «максимального сечения».
Электронный журнал. http://www.math.spbu.ru/diffjournal 30Дифференциальные уравнения и процессы управления, N. 1, 2015
Алгоритм 1
Шаг1.ЗадатьM —числомоделируемыхвспомогательныхтраекторий; h—шагчис-
ленного интегрирования; величину λ
∗
. Получить реализации начальных состояний X
0
и
X
i
0
согласно заданной плотности вероятности φ
0
(x), где X
0
— начальное состояние для
основной траектории (для которой проводятся измерение и оценивание), X
i
0
— для вспо-
могательных траекторий, по которым приближенно вычисляется оптимальная оценка, и
моменты времени ξ
i
, через которые могут произойти обрывы или ветвления траекторий:
ξ
i
=−
lnβ
λ
∗
, i = 1,2,...,M.
Здесь и далее β — различные реализации (для всех i) случайной величины, имеющей
равномерное распределение на интервале (0,1).
Положить Y
0
= 0, k = 0, t
i
∗
= t
0
, F
i
0
= 1 (в случае обрыва траектории с номером i при
последующем моделировании F
i
k
= 0, k > 0), i = 1,2,...,M.
Шаг2.Положить κ = k (запомнить текущее время), i = 1, j = 0 (j — количество
новых ветвей на шаге k), Ξ = 1 (прогнозирование):
Шаг3.Проверить условие t
κ
+∆(t
κ
)−t
k
> 0. Если оно выполнено, то перейти к ша-
гу 4. Иначе положить
M
κ
=
M
∑
i=1
F
i
κ
(M
0
= M)
и найти прогноз
ˆ
X
k
как выборочное среднее реализацийX
k
={X
i
k
}
i=1,...,M;F
i
k
=1
:
ˆ
X
κ
=
1
M
κ
∑
i=1,...,M; F
i
 
=1
X
i
k
.
Проверить условие T −t
κ
= 0. Если оно выполнено, то завершить процесс, иначе по-
ложить k = κ, i = 1, Ξ = 0 (фильтрация).
Далее,получитьреализациюоцениваемоговекторасостояниявследующемузлесетки
{t
k
}:
X
k+1
= X
k
+hf(t
k
,X
k
)+
√
hσ(t
k
,X
k
)∆W,
и получить вектор измерений:
Z
k
= c(t
k
,X
k
)+
ζ(t
k
)
√
h
∆V, Y
k+1
= Y
k
+hZ
k
.
В этих формулах и далее ∆W и ∆V — различные для всех k и i (а также для промежу-
точных расчетов) реализации случайных векторов размеров s×1 и d×1 соответственно,
координаты которых независимы и имеют стандартное нормальное распределение.
Положить i = 1.
Шаг4.Проверить условие F
i
κ
= 0. Если оно выполнено, то перейти к последнему
шагу, иначе: при Ξ = 1 или t
i
∗
+ξ
i
> t
k
+h перейти к шагу 5, а при t
i
∗
+ξ
i
<t
k
+h —
к шагу 6.
Шаг5.Получить реализацию вектора состояния в следующем узле сетки {t
k
}:
X
i
k+1
= X
i
k
+hf(t
k
,X
i
k
)+
√
hσ(t
k
,X
i
k
)∆W.
Электронный журнал. http://www.math.spbu.ru/diffjournal 31Дифференциальные уравнения и процессы управления, N. 1, 2015
Положить F
i
k+1
= 1 (если Ξ = 0) и перейти к последнему шагу.
Шаг6.Получить реализацию вектора состояния в дополнительном узле сетки:
˜
X = X
i
k
+h
▹
f(t
k
,X
i
k
)+
√
h
▹
σ(t
k
,X
i
k
)∆W, h
▹
= t
i
∗
+ξ
i
−t
k
.
Получить реализацию α случайной величины, имеющей равномерное распределение
на интервале (0,1). Проверить условие
α6
|λ(t
i
∗
+ξ
i
)|
λ
∗
,
гдеλ(t
i
∗
+ξ
i
) = λ(t
i
∗
+ξ
i
,
˜
X,Z
k
),иеслионовыполнено,топерейтикшагу7,иначе—кша-
гу 8.
Шаг7.Проверить условия:
а)еслиλ(t
i
∗
+ξ
i
) < 0(λ
−
(t
i
∗
+ξ
i
,
˜
X,Z
k
) > 0,обрывтраектории),тоположитьF
i
k+1
= 0
(траектория далее не моделируется: F
i
r
= 0, r > k) и перейти к последнему шагу;
б)если λ(t
i
∗
+ξ
i
) > 0 (λ
+
(t
i
∗
+ξ
i
,
˜
X,Z
k
) > 0, ветвление траектории), то положить
j = j +1 и получить реализацию вектора состояния в следующем узле сетки {t
k
} для
новой траектории (точнее, «новой ветви» траектории с номером i, которая далее рассмат-
ривается как другая траектория с номером M +j):
X
M+j
k+1
=
˜
X +h
◃
f(t
k
+h
▹
,
˜
X)+
√
h
◃
σ(t
k
+h
▹
,
˜
X)∆W, h
◃
= h−h
▹
= t
k
+h−t
i
∗
−ξ
i
.
ПоложитьF
M+j
k+1
= 1(F
M+j
r
= 0,r6 k),t
M+j
∗
= t
i
∗
+ξ
i
иполучитьреализациюдляпро-
межутка времени, через который может произойти обрыв или новое ветвление:
ξ
M+j
=−
lnβ
λ
∗
,
моделирование ξ
M+j
проводится до тех пор, пока не будет выполнено условие
t
M+j
∗
+ξ
M+j
> t
k
+h.
Шаг8.Получить реализацию вектора состояния в следующем узле сетки {t
k
}:
X
i
k+1
=
˜
X +h
◃
f(t
k
+h
▹
,
˜
X)+
√
h
◃
σ(t
k
+h
▹
,
˜
X)∆W, h
◃
= h−h
▹
.
Положить F
i
k+1
= 1, t
i
∗
= t
i
∗
+ξ
i
и получить новую реализацию для промежутка вре-
мени,черезкоторыйможетпроизойтиобрывиливетвлениерассматриваемойтраектории:
ξ
i
=−
lnβ
λ
∗
,
моделирование ξ
i
проводится до тех пор, пока не будет выполнено условие
t
i
∗
+ξ
i
> t
k
+h.
Шаг9.Проверить условия:
а)если i = M, то положить M = M +j, t
k+1
= t
k
+h, k = k +1 и перейти к шагу 3
при Ξ = 1 или к шагу 2 при Ξ = 0;
б)если i< M, то положить i = i+1 и перейти к шагу 4.
Электронный журнал. http://www.math.spbu.ru/diffjournal 32Дифференциальные уравнения и процессы управления, N. 1, 2015
Алгоритм 2
Шаг1–Шаг5 из алгоритма 1.
Шаг6.Проверитьусловиеt
i
∗
+ξ
i
> t
k
+h.Еслионовыполнено,топерейтикшагу10,
иначе: положить
˜
X
i
= X
i
k
, τ
i
= t
k
и перейти к шагу 7.
Шаг7.Получить реализацию вектора состояния в дополнительном узле сетки:
˜
X
i
=
˜
X
i
+h
i
f(τ
i
,
˜
X
i
)+
√
h
i
σ(τ
i
,
˜
X
i
)∆W, h
i
= t
i
∗
+ξ
i
−τ
i
.
Положить τ
i
= τ
i
+h
i
и получить реализацию α случайной величины, имеющей рав-
номерное распределение на интервале (0,1). Проверить условие
α6
|λ(τ
i
)|
λ
∗
,
где λ(τ
i
) = λ(τ
i
,
˜
X
i
,Z
k
), и если оно выполнено, то перейти к шагу 8, иначе — к шагу 9.
Шаг8.Проверить условия:
а)если λ(τ
i
) < 0 (λ
−
(τ
i
,
˜
X
i
,Z
k
) > 0, обрыв траектории), то положить F
i
k+1
= 0 (тра-
ектория далее не моделируется: F
i
r
= 0, r > k) и перейти к последнему шагу;
б)если λ(τ
i
) > 0 (λ
+
(τ
i
,
˜
X
i
,Z
k
) > 0, ветвление траектории), то положить j = j +1,
F
M+j
k+1
= 1(F
M+j
r
= 0,r6 k),t
M+j
∗
= t
i
∗
+ξ
i
,
˜
X
M+j
=
˜
X
i
,τ
M+j
= τ
i
иполучитьреализацию
для промежутка времени, через который может произойти обрыв или новое ветвление:
ξ
M+j
=−
lnβ
λ
∗
.
Шаг9.Положить t
i
∗
= t
i
∗
+ξ
i
и получить новую реализацию для промежутка време-
ни, через который может произойти обрыв или ветвление рассматриваемой траектории:
ξ
i
=−
lnβ
λ
∗
.
Перейти к шагу 6.
Шаг10.Получить реализацию вектора состояния в следующем узле сетки {t
k
}:
X
i
k+1
=
˜
X
i
+h
i
f(τ
i
,
˜
X
i
)+
√
h
i
σ(τ
i
,
˜
X
i
)∆W, h
i
= t
k
+h−τ
i
.
Положить F
i
k+1
= 1.
Шаг11.Проверить условия:
а)еслиi = M +j,тоположитьM = M +j,t
k+1
= t
k
+h,k = k +1иперейтикшагу3
при Ξ = 1 или к шагу 2 при Ξ = 0;
б)если i< M, то положить i = i+1 и перейти к шагу 4;
в)если M6 i< M +j (новые ветви), то положить i = i+1 и перейти к шагу 6.
Замечания.
1.Величину λ
∗
можно оценить, например, по результатам пробного моделирования
траекторий системы наблюдения.
Электронный журнал. http://www.math.spbu.ru/diffjournal 33Дифференциальные уравнения и процессы управления, N. 1, 2015
2.Предполагается, что конечный момент времени T для построения текущей оцен-
ки и конечный момент времени t
κ
+∆(t
κ
) для нахождения прогноза согласованы с ша-
гом интегрирования, т.е. найдутся такие целые числа K
1
и K
κ
2
, что t
0
+K
1
h = T и
t
0
+K
κ
2
h = t
κ
+∆(t
κ
), иначе при нахождении вектора состояния в этот момент времени
потребуется корректировать шаг численного интегрирования.
3.На шаге 3 можно получить ковариационную матрицу ошибки прогнозирования:
ˆ
Γ
κ
=
1
M
κ
−1
∑
i=1,...,M; F
i
 
=1
(X
i
k
−
ˆ
X
k
)(X
i
k
−
ˆ
X
k
)
T
.
Индекс κ в обозначении
ˆ
X
κ
и
ˆ
Γ
κ
указывает на то, что эти характеристики соответ-
ствуют прогнозу в момент времени t
κ
+∆(t
κ
) при текущем времени θ = t
κ
.
На этом же шаге по выборке X
k
можно найти оценку апостериорной плотности ве-
роятности p(t
κ
+∆(t
κ
),x|Y
t
 
0
), например, с помощью построения гистограммы. Это дает
возможность использовать критерии при нахождении оценки вектора состояния, отлич-
ные от критерия минимума среднеквадратической ошибки оценивания.
4.На шагах 6 и 7 алгоритма 1 или шагах 7 и 8 алгоритма 2 подставляется значение
Z
k
,т.е.длямоментавремени t
k
,посколькудругихизмерений Y(t)илиZ(t),врамкахэтих
алгоритмовнетипримоделированиитраекториипроцессовX(t)иY(t)кусочно-линейные,
а траектория процесса Z(t) кусочно-постоянная.
5.Еслипримоделированииколичествообрывовсущественнобольшеколичестваветв-
лений траекторий, то выборкаX
k
«вырождается» и в таком случае необходимо добавлять
новые траектории, восполняя «потери» при обрывах. Это можно делать по оценке апо-
стериорнойфункциираспределениянаосновевыборкиX
k
,генерируяновыевекторы,или
использовать«размножение»выборки.Еслипримоделированииколичествоветвленийсу-
щественнобольшеколичестваобрывовтраекторий,тотраекториинужно«прореживать»,
например, случайным образом.
6.Для повышения точности расчетов могут применяться методы численного реше-
ния стохастических дифференциальных уравнений, имеющие больший порядок точности,
нежели стохастический метод Эйлера (7). Такие методы описаны, например, в [3,8,14,16].
Однако точность оценивания определяется не только выбранным методом численного ре-
шения стохастических дифференциальных уравнений, но и методом моделирования неод-
нородных пуассоновских потоков, а также свойствами используемых генераторов псевдо-
случайных чисел.
При апробации алгоритма использовались следующие генераторы псевдослучайных
чисел: Mersenne Twister [17] для величин, имеющих равномерное распределение; Ziggurat
и генератор Бокса–Мюллера [16,18] для величин, имеющих нормальное распределение.
Преимущества разработанных алгоритмов прогнозирования такие же, как и для ал-
горитмов оптимальной фильтрации [10,11]. Поскольку их основу составляют методы чис-
ленногорешениястохастическихдифференциальныхуравненийиметодымоделирования
неоднородных пуассоновских потоков, реализация этих алгоритмов достаточно проста,
при этом сложность решения задачи прогнозирования не зависит от модели объекта на-
блюдения или измерительной системы.
Далее приведем примеры моделирования и прогнозирования для линейных систем
наблюдения. Выбор линейных систем обусловлен возможностью сравнения результатов с
оценкой, полученной с помощью фильтра Калмана–Бьюси и уравнений метода момен-
тов [4,8,12], т.е. с «точным» решением (с учетом того, что далее уравнения фильтра
Электронный журнал. http://www.math.spbu.ru/diffjournal 34Дифференциальные уравнения и процессы управления, N. 1, 2015
Калмана–Бьюси и метода моментов решаются приближенно методом Эйлера), модели
объекта наблюдения и измерительной системы такие же, как и в [10]. Решение осуществ-
лялось с помощью алгоритма 1.
Пример 1. Система наблюдения описывается уравнениями
dX(t) =−(2−2cos10t)X(t)dt+0.25dW(t), X(0) = X
0
,
dY(t) = sin20tX(t)dt+0.1dV(t), Y(0) = 0,
где t∈ [0,1], X,Y ∈R, W(t) и V(t) — одномерные стандартные винеровские процессы
(W(t), V(t) и X
0
независимы), случайная величина X
0
имеет нормальное распределение
с математическим ожиданием−0.5 и дисперсией 0.01.
Шаг численного интегрирования h = 0.005, начальное число вспомогательных траек-
торий M = 10000. Прогнозирование осуществляется для фиксированного момента време-
ни T
′
= 1, т.е. ∆(t) = 1−t.
На рис. 2 слева приведены результаты моделирования системы наблюдения (выбо-
рочная траектория X(t) показана синим цветом, траектория Y(t) — красным) и прог-
нозирования по критерию минимума среднеквадратичной ошибки (оценка текущего со-
стоянияи прогноз, полученныеусреднениемпопучку траекторий с обрывами и ветвлени-
ями, показаны зеленым цветом, результат решения уравнений фильтра Калмана–Бьюси
и метода моментов — пурпурным), а справа оценка апостериорной плотности вероятно-
сти текущего состояния (гистограмма, показана синим цветом) и прогноза в фиксиро-
ванный момент времени T
′
= 1 (гистограмма, показана красным цветом). Первая стро-
ка на рис. 2 соответствует начальному моменту времени t
0
= 0.00, поэтому оценка апо-
стериорной плотности вероятности текущего состояния отсутствует: это начальная плот-
ность вероятности φ
0
(x). Далее приведенные рисунки соответствуют моментам времени
θ = 0.25,0.50,0.75,1.00. Для конечного момента времени θ = 1.00 показана только оцен-
ка апостериорной плотности вероятности текущего состояния. В процессе моделирования
объем выборкиX
k
менялся в пределах от 10000 до 21968.
Пример 2. Система наблюдения описывается уравнениями
dX(t) = (10sin100t−5)X(t)dt+0.05dW(t), X(0) = X
0
,
dY(t) = X(t)dt+0.01dV(t), Y(0) = 0,
где t∈ [0,1], X,Y ∈R, W(t) и V(t) — одномерные стандартные винеровские процессы
(W(t), V(t) и X
0
независимы), случайная величина X
0
имеет нормальное распределение
с математическим ожиданием 0.2 и дисперсией 0.0001.
Шаг численного интегрирования h = 0.005, начальное число вспомогательных тра-
екторий M = 10000. Прогнозирование осуществляется с фиксированным упреждением
∆ = 0.25приt∈ [0,0.75],адалееприt∈ (0.75,1]вфиксированныймоментвремениT
′
= 1,
т.е.
∆(t) =
{
0.25, t∈ [0,0.75],
1−t, t∈ (0.75,1].
Нарис. 3 слева приведены результаты моделирования системы наблюдения и прогно-
зирования по критерию минимума среднеквадратичной ошибки, а справа оценка апосте-
риорной плотности вероятности текущего состояния и прогноза с фиксированным упре-
ждением ∆ = 0.25, при этом принята такая же система цветовых обозначений и последо-
вательность графиков. В процессе моделирования объем выборкиX
k
менялся в пределах
от 10000 до 60785.
Электронный журнал. http://www.math.spbu.ru/diffjournal 35Дифференциальные уравнения и процессы управления, N. 1, 2015
Рис. 2. Результаты моделирования системы наблюдения и прогнозирования.
Электронный журнал. http://www.math.spbu.ru/diffjournal 36Дифференциальные уравнения и процессы управления, N. 1, 2015
Рис. 3. Результаты моделирования системы наблюдения и прогнозирования.
Электронный журнал. http://www.math.spbu.ru/diffjournal 37Дифференциальные уравнения и процессы управления, N. 1, 2015
Список литературы
[1] Аверина Т.А. Новые алгоритмы статистического моделирования неоднородных пуассонов-
скихансамблей//Журналвычислительнойматематикииматематическойфизики.—2010.
Т. 50. № 1. — С. 16–23.
[2] Казаков И.Е., Артемьев В.М., Бухалев В.А. Анализ систем случайной структуры. — М.:
Физматлит, 1993.
[3] Кузнецов Д.Ф. Стохастические дифференциальные уравнения: теория и практика числен-
ного решения. — СПб.: Изд-во Политехн. ун-та, 2010.
[4] Миллер Б.М., Панков А.Р. Теория случайных процессов в примерах и задачах. — М.: Физ-
матлит, 2002.
[5] Михайлов Г.А., Аверина Т.А. Алгоритм «максимального сечения» в методе Монте-Карло
// Доклады АН. — 2009. Т. 428. № 2. — С. 163–165.
[6] Михайлов Г.А., Рогазинский С.В. Модифицированный метод «мажорантной частоты» для
численногомоделированияобобщенногоэкспоненциальногораспределения//ДокладыАН.
— 2012. Т. 444. № 1. — С. 28–30.
[7] Оксендаль Б. Стохастические дифферециальные уравнения. Введение в теорию и приложе-
ния. — М.: Мир, 2003.
[8] Пантелеев А.В., Руденко Е.А., Бортаковский А.С. Нелинейные системы управления: опи-
сание, анализ и синтез. — М.: Вузовская книга, 2008.
[9] Пугачев В.С., Синицын И.Н. Теория стохастических систем. — М.: Логос, 2004.
[10] Рыбаков К.А. Сведение задачи нелинейной фильтрации к задаче анализа стохастических
системсобрывамииветвлениямитраекторий//Дифференциальныеуравненияипроцессы
управления. — 2012. № 3. — С. 91–110. — http://www.math.spbu.ru/diffjournal.
[11] Рыбаков К.А. Модифицированный алгоритм оптимальной фильтрации сигналов на основе
моделирования специального ветвящегося процесса // Авиакосмическое приборостроение.
— 2013. № 3. — С. 15–20.
[12] Синицын И.Н. Фильтры Калмана и Пугачева. — М.: Логос, 2007.
[13] Тихонов В.И., Кульман Н.К. Нелинейная фильтрация и квазикогерентный прием сигналов.
— М.: Советское радио, 1975.
[14] Artemiev S.S., Averina T.A. Numerical Analysis of Systems of Ordinary and Stochastic
Differential Equations. — VSP, 1997.
[15] Coleman W.A. Mathematical Veriﬁcation of a Certain Monte Carlo Sampling Technique and
Applications of the Technique to Radiation Transport Problems // Nuclear Science and
Engineering. — 1968. V. 32. — P. 76–81.
[16] Kloeden P.E., Platen E. Numerical Solution of Stochastic Differential Equations. — Springer,
1995.
[17] Matsumoto M., Nishimura T. Mersenne Twister: A 623-Dimensionally Equidistributed Uniform
Pseudo-Random Number Generator // ACM Transactions on Modeling and Computer
Simulation. — 1998. V. 8. No. 1. — P. 3–30.
[18] Thomas D.B., Luk W., Leong P.H.W., Villasenor J.D. Gaussian Random Number Generators
// ACM Computing Surveys. — 2007. V. 39. No. 4. — P. 11:1–11:38.
Электронный журнал. http://www.math.spbu.ru/diffjournal 38
