ДИФФЕРЕНЦИАЛЬНЫЕ УРАВНЕНИЯ 
И 
ПРОЦЕССЫ УПРАВЛЕНИЯ 
N. 2, 2024 
Электронный журнал, 
рег. Эл № ФС77-39410 от 15.04.2010 
ISSN 1817-2172 
 
http://diffjournal.spbu.ru/ 
e-mail: jodiff@mail.ru 
 
 
Общая теория управления 
 
Об одной задаче оптимального управления квадрокоптером с 
заданным промежуточным значением части координат фазового 
вектора  
 
В. Р. Барсегян
1,2,*
, Т. А. Симонян 
2,**
, A. Г. Матевосян
2,*** 
 
1
Институт механики НАН Армении  
2
Ереванский государственный университет  
 
*barseghyan@sci.am; **simtom09@gmail.com, ***amatevosya@ysu.am 
 
Аннотация. Учитывая растущее применение квадрокоптеров в различных целях, данная 
работа посвящена рассмотрению вопросов математического моделирования их 
пространственного движения и построению закона оптимального управления, 
обеспечивающего полет с заданным промежуточным значением части координат фазового 
вектора в некоторый момент времени. На основе законов теоретической механики приведена 
система дифференциальных уравнений, описывающих пространственное движение 
квадрокоптера. Для линеаризованной математической модели движения квадрокоптера и 
квадратичного функционала методом проблем моментов решена задача построения закона 
оптимального управления с заданными начальными, конечными значениями фазового 
вектора и значением части координат в промежуточный момент времени. Сформулированы 
условия вполне управляемости. Построены функции оптимального управления и 
соответствующие фазовые траектории оптимального движения, учитывающие значение 
части координат в некоторый промежуточный момент времени. В качестве иллюстрации 
предложенного подхода для конкретных численных значений построены явные выражения 
функции оптимального управления, фазовых координат движения и соответствующие 
графики. 
 
Ключевые слова: квадрокоптер, математическая модель, оптимальное управление, 
промежуточное условие, фазовые траектории. 
 
Введение  
Все большую популярность получает использование беспилотных летательных аппаратов в 
виде многовинтовых устройств, а чаще – квадрокоптеров. Область применения квадрокоптеров Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      60 
достаточно широка и не ограничена военной отраслью. Например, квадрокоптер является очень 
популярным автоматизированным объектом, который используется как недорогое и эффективное 
средство в различных прикладных задачах для мониторинга местности, видеосъемок и др. 
Квадрокоптер хорошо подходит для наблюдения и контроля объектов, территорий и зон, доступ к 
которым затруднен, или в условиях, непригодных для человека [1–11].  
В прикладных задачах при моделировании и проектировании движений различных 
механических систем, в частности, движения беспилотных летательных аппаратов, возникают 
задачи управления движением с многоточечными промежуточными условиями. В частности, 
учитывая разнообразность рельефа поверхности земли, проектирование автономно управляемого 
движения квадрокоптера для мониторинга местности или видеосъемок, приводит к 
необходимости учета возможностей для преодоления предстоящих горных высот. В подобных 
задачах, при проектировании движения, возникает необходимость учета достижения требуемого 
значения геометрических координат летательного аппарата, которые могут обеспечить 
преодоление предстоящей высоты. Следовательно, возникают задачи проектирования управления 
движением с заданными промежуточными значениями части координат фазового вектора [12-19]. 
Вообще, важное прикладное и теоретическое значение имеют задачи управления как для 
систем со сосредоточенными [12-17], так и с распределёнными параметрами [18, 19], в которых 
наряду с классическими краевыми (начальное и конечное) условиями необходимо также 
учитывать многоточечные промежуточные условия. 
В работе рассматривается пространственное движение квадрокоптера. Он имеет шесть 
степеней свободы и четыре управляющих воздействия. Управляющие силы и моменты 
формируются с помощью четырех двигателей, вращающих установленные на их роторах 
воздушные винты. Математическая модель квадрокоптера с четырьмя двигателями незаменима 
при последующем моделировании алгоритма управления и движения. В математической модели 
полета в форме дифференциальных уравнений Ньютона–Эйлера учитываются особенности 
динамики системы. Для линеаризованной математической модели движения квадрокоптера 
рассмотрена задача построения закона оптимального управления с заданными начальными, 
конечными значениями фазового вектора и значением части координат в некоторый 
промежуточный момент времени. Построены функции оптимального управления и 
соответствующие фазовые траектории оптимального движения, учитывающие промежуточное 
значение части координат в заданный момент времени. В качестве приложения предложенного 
подхода для конкретных численных значений построены явные выражения функции 
оптимального управления, и соответствующие фазовые траектории и графики. 
 
1. Математическая модель динамики квадрокоптера и постановка задачи 
 
В качестве управляемого динамического объекта рассматривается модель геометрически 
симметричного беспилотного летательного аппарата – квадрокоптера, построенного по 
классической четырехвинтовой схеме, структура которого представлена на рис.1.   
Рис. 1. Структурная схема квадрокоптера 
 Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      61 
Положение квадрокоптера с массой    в пространстве характеризуется координатами  
   ,    ,    центра масс аппарата в неподвижной декартовой системе координат и тремя углами (углы 
Эйлера)    ,    ,    поворота вокруг осей системы координат, жестко связанной с аппаратом, причем 
начало координат совпадает с центром масс аппарата. Здесь    - угол тангажа (т.е. угол наклона 
квадрокоптера относительно оси      ),    - угол крена (т.е. угол наклона БПЛА относительно оси 
     ),    - угол рыскания (т.е. угол наклона квадрокоптера относительно оси      ). Движение 
квадрокоптера в задачах динамики управления полетом рассматривается как сложное – движение 
центра масс и движение вокруг центра масс [9-11]. Для составления математической модели 
квадрокоптера приняты следующие допущения [1-3]: квадрокоптер симметричен относительно 
осей    и    ; рама квадрокоптера и его винты абсолютно жесткие; каждый двигатель располагается 
на конце стержня; тяга, создаваемая каждым винтом, перпендикулярна плоскости      .  
Движение управляемого квадрокоптера осуществляется четырьмя винтами и основано на 
создании изменяемых по величине и направлению сил и моментов, влияющих на квадрокоптер. 
Каждый из винтов имеет свой привод (электродвигатель), придающий ему вращение вокруг 
вертикальной оси. Таким образом, каждый из двигателей создает тягу и момент вращения. 
Описанный квадрокоптер имеет четыре управляющих воздействия, соответствующих угловым 
скоростям четырех винтов. Угловые скорости винтов обозначим через    1
,    2
,    3
,    4
, силы тяги, 
создаваемые вращением винтов – через    1
,    2
,    3
,    4
, а моменты, которые образуются в результате  
вращения винтов – через    1
,    2
,    3
,    4
.    
Для построения математической модели динамики квадрокоптера введем неподвижную 
систему координат          , а в центре масс       квадрокоптера закрепим неподвижную систему 
координат                         (рис.1). Обозначим через    ,    ,    координаты центра масс квадрокоптера 
относительно системы координат          . Вращательное движение квадрокоптера, т.е. угловые 
положения в инерциальной системе координат          , определяются с помощью углов Эйлера    , 
   ,    . Тогда пространственное положение квадрокоптера определяется двумя векторами 
 
   =(
         )
   ,     =(         )
   .  
               
Здесь и далее буква «   » в верхнем индексе означает операцию транспонирования. В системе 
координат                         векторы линейной скорости       и угловой скорости    будут: 
 
      =(       
       
       
)
   ,    =(
         )
   .  
              
А матрица поворота системы координат                         относительно неподвижной инерциальной 
системы координат          будет: 
 
   =(
                              −                              +                                          +                              −            −                              ),  
 
              
где       =          ,       =          ,    =   ,    ,   . 
Матрица    ортогональна, следовательно,    −1
=      и является матрицей перехода из 
инерциальной системы координат          в систему                         . Матрицы    и    −1
 используются 
для получения проекций вектора       в инерциальной системе координат. 
Матрица преобразования из инерциальной системы координат          в систему                          (т.е. 
   ) и обратно (т.е.    −1
 ) для вектора угловой скорости    в данном случае будет  Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      62 
   =(
1 0 −      0                   0 −                  ) ,                  −1
=(
1                         0       −      0
                        ). 
 
Здесь       =       ,    =   ,    ,   . Отметим, что матрица    обратима, когда    ≠(2   −1)
   2
, 
(   ∈ℤ) . Теперь, используя матрицу преобразования    и     −1
, будем иметь  
 
   ̇ =   −1
   ,          =         ̇.                              (1.1) 
 
Согласно выбору системы координат                         , квадрокоптер расположен симметрично 
относительно осей              и              (рис. 1), следовательно, инерционная матрица будет 
диагональной с моментами инерции квадрокоптера относительно осей       ,       и       –        
,        
 и 
       
, соответственно, и        
=       
. 
Угловая скорость       винта    (   =1,4) создает силу тяги       , (   =1,4) , направленную по оси 
винта. Угловая скорость       и угловое ускорение    ̇    винта    , также создают крутящий момент       , 
(   =1,4) вокруг оси винта    . Сила тяги и крутящий момент определяются по формулам: 
  
      =         2
,          =         2
+         ̇    ,   (   =1,4) , 
 
                                         
где    – постоянная подъемной силы,    постоянная сопротивления (т.е.    и    –коэффициенты 
пропорциональности, характеризующие особенности роторов),       – момент инерции винта 
(одинаковый для всех винтов). Влияние углового ускорения    ̇    , (   =1,4) настолько мало, 
что им можно пренебречь. Суммарная сила тяги    сил    1
 ,    2
,    3
,    4
 направлена вдоль оси 
            .       - вектор крутящего момента, который включает крутящие моменты       ,       ,       , 
соответствующие углам Эйлера    ,    ,    . Сила тяги и крутящий момент определяются по 
формулам: 
 
   =∑       4
   =1
=   ∑       2 4
   =1
,        =(
0
0
   ),       =(
                  )=(
     (−   2
2
+   4
2
)
     (−   1
2
+   2
2
)
∑       4
   =1
),        (1.2) 
 
где    - расстояние от осей винта (т.е. центра роторов) до центра масс квадрокоптера. 
Физический смысл формул (1.2) очевиден. Можно увеличить угловую скорость четвертого 
винта и уменьшить угловую скорость второго винта, а также изменить угол крена. Таким же 
образом можно изменить угол наклона. Для угла рыскания можно уменьшить скорость 
вращения двух диагональных винтов и увеличить скорость вращения двух других 
диагональных винтов.  
Для получения дифференциальных уравнений движения квадракоптера, воспользуемся 
вторым законом Ньютона и динамическими уравнениями Эйлера, и, следовательно, относительно 
системы координат                         будем иметь [9-11] 
   
      ̇    +   ×         =         +      ,     
                                                               
где    =(0 0 −   )
   ,     - ускорение свободного падения. А относительно системы координат 
         будем иметь 
     Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      63 
(
   ̈    ̈    ̈ )=(
0
0
−   )+
      (
                  +                              −                        ).  (1.3) 
 
В системе координат                         сумма углового ускорения инерции       ̇ центростремительных 
сил    ×     и гироскопических сил    равна внешнему крутящему моменту       
 
      ̇+   ×(     )+   =      ,     =      (
         )×(
0
0
1
)      ,         =   1
−   2
+   3
−   4
.               (1.4) 
 
Здесь       – момент инерции квадрокоптера относительно его мгновенной оси вращения. Таким 
образом, из (1.4) будем иметь  
   
   ̇ =(
   ̇    ̇    ̇ )=
(
 
 
 
(       
−       
)    
       
(       
−       
)    
       
(       
−       
)    
       
)
 
 
 
−      (
          
−          
0
)      +
(
 
 
             
             
              )
 
 
.                            (1.5) 
 
Имея угловые ускорения в системе координат                         , можно получить угловые ускорения 
в системе координат          , используя матрицу преобразования    −1
 и ее производную по 
времени.  
 
   ̈ =
       
(   −1
)   +   −1
   ̇.                              
 
 
Из (1.1), (1.3), (1.5) получим следующую систему уравнений относительно компонент векторов 
   ,    и    : 
 
   ̈ =
                        +
                  ,         ̈ =
                        −
                  ,        ̈=−   +
                  , 
(1.6) 
   ̇ =   +
                     +
                     ,           ̇ =         −         ,          ̇ =
               +
               ,                
   ̇ =
(       
−       
)    
       
−                
      +
             
,             ̇ =
(       
−       
)    
       
−                
      +
             
, 
   ̇ =
(       
−       
)    
       
−                
      +
             
 .  
                                                                                                      
Для дальнейшего аналитического исследования линеаризуем уравнения (1.6), 
характеризирующие математическую модель квадрокоптера. Линеаризацию системы (1.6) 
произведем в окрестности начала координат и считая, что углы     ,    ,     малы, так что 
соответствующие синусы равны нулю и косинусы равны единице, а также введя следующие 
обозначения 
 
   1
=   ,        2
=   ̇,         3
=   ,        4
=   ̇,        5
=   ,        6
=   ̇,  
   7
=   ,       8
=   ,        9
=   ,        10
=   ,       11
=   ,      12
=   ,                       
 Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      64 
получим систему уравнений, описывающих динамику линейной модели квадрокоптера 
 
   ̇1
=   2
,        ̇2
=      8
,       ̇3
=   4
,        ̇4
=−      7
,        ̇5
=   6
,        ̇6
=   1
, 
(1.7) 
   ̇7
=   10
,      ̇8
=   11
,        ̇9
=   12
,       ̇10
=
   2
       
,          ̇11
=
   3
       
,       ̇12
=
   4
       
.   
 
где      1
=
      −   ,      2
=      ,      3
=      ,      4
=        - управляющие воздействия. Обозначим 
   (   )=(   1
(   )      2
(   )      3
(   )      4
(   ))
   .  
Непосредственной проверкой можно убедиться, что система (1.7) вполне управляема [20]. 
Пусть заданы начальный    =   0
 и конечный     =   2
 моменты времени, а также состояния 
системы (1.7) в эти моменты времени 
 
   (   0
)=(   1
(   0
),…,   12
(   0
) )
   и     (   2
)=(   1
(   2
),…,   12
(   2
) )
   .                                        (1.8) 
 
Пусть заданы также значения части координат фазового вектора  
   
   1
(   1
),    3
(   1
),    5
(   1
)                                                                                 (1.9) 
 
в промежуточный момент времени    1
,   (   0
<   1
<   2
) . 
Пусть задан также критерий качества 
  
   [   ]=∫
[   1
2
(   )+   2
2
(   )+   3
2
(   )+   4
2
(   )]        2
   0
.                                                            (1.10) 
 
Сформулируем следующую задачу оптимального управления.  
Заданы уравнения движения (1.7), промежуточный момент времени    1
, (   0
<   1
<   2
), 
значения (1.8), (1.9) фазового вектора, а также критерий качества (1.10).   
Требуется найти оптимальное управляющее воздействие    0
(   )={   1
0
(   ),    2
0
(   ),    3
0
(   ),
   4
0
(   )},    ∈[   0
,   2
], переводящее систему (1.7) из начального положения    (   0
) через 
промежуточные состояния (1.9) в конечное положение    (   2
) , минимизируя функционал (1.10). 
 
2. Приведение задачи к проблеме моментов и построение решения 
 
Решение уравнения (1.7) с помощью формулы Коши запишем следующим образом [20]:  
 
   (   )=   [   ,   0
]   (   0
)+∫    [   ,   ]   (   )           0
, (2.1) 
 
где    [   ,   ]- нормированная фундаментальная матрица решения однородной части уравнения 
(1.7), a     [   ,   ]- импульсно-переходная матрица, которая имеет вид: 
 
      [   ,   ]=
(
 
 
 
 
 
0 0 0 0    −   1 0 0 0 0 0 0
0 0 −
   (   −   )
3
6       
−
   (   −   )
2
2       
0 0
   −          
0 0
1
       
0 0
   (   −   )
3
6       
   (   −   )
2
2       
0 0 0 0 0
   −          
0 0
1
       
0
0 0 0 0 0 0 0 0
   −          
0 0
1
       
)
 
 
 
 
 
. 
 Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      65 
Применяя подходы, приведенные в работах [14,16] а также учитывая промежуточные (1.9) и 
конечные (1.8) условия, для определения законов управления получим следующие интегральные 
соотношения 
 
∫
   (   2
−   )
3
6       
   3
(   )        2
   0
=   1
,  ∫
   (   2
−   )
2
2       
   3
(   )        2
   0
=   2
 ,  ∫ −
   (   2
−   )
3
6       
   2
(   )        2
   0
=   3
, 
∫ −
   (   2
−   )
2
2       
   2
(   )        2
   0
=   4
,  ∫
(   2
−   )   1
(   )        2
   0
=   5
,  ∫    1
(   )        2
   0
=   6
, 
∫
   2
−          
   2
(   )        2
   0
=   7
,   ∫
   2
−          
   3
(   )        2
   0
=   8
,  ∫
   2
−          
   4
(   )        2
   0
=   9
, 
∫
1
       
   2
(   )        2
   0
=   10
,  ∫
1
       
   3
(   )        2
   0
=   11
,   ∫
1
       
   4
(   )        2
   0
=   12
, 
∫
   (   1
−   )
3
6       
   3
(   )
   1
   0
     =   13
,   ∫ −
   (   1
−   )
3
6       
   2
(   )        1
   0
=   14
,    ∫
(   1
−   )   1
(   )        1
   0
=   15
, 
 
где  
 
   1
=   1
(   2
)−   1
(   0
)−   2
(   0
)(   2
−   0
)−
   2
(   2
−   0
)
2
   8
(   0
)−
   6
(   2
−   0
)
3
   11
(   0
) , 
   2
=   2
(   2
)−   2
(   0
)−   8
(   0
)   (   2
−   0
)−
   2
(   2
−   0
)
2
   11
(   0
) , 
   3
=   3
(   2
)−   3
(   0
)−   4
(   0
)(   2
−   0
)+
   2
(   2
−   0
)
2
   7
(   0
)+
   6
(   2
−   0
)
3
   10
(   0
) , 
   4
=   4
(   2
)−   4
(   0
)+   7
(   0
)   (   2
−   0
)+
   2
(   2
−   0
)
2
   10
(   0
) ,  
   5
=   5
(   2
)−   5
(   0
)−   6
(   0
)(   2
−   0
) ,        =      (   2
)−      (   0
) ,   (   =6,10,11,12) , 
   7
=   7
(   2
)−   7
(   0
)−   10
(   0
)(   2
−   0
) ,     8
=   8
(   2
)−   8
(   0
)−   11
(   0
)(   2
−   0
) , 
   9
=   9
(   2
)−   9
(   0
)−   12
(   0
)(   2
−   0
) ,  
   13
=   1
(   1
)−   1
(   0
)−   2
(   0
)(   1
−   0
)−
   2
(   1
−   0
)
2
   8
(   0
)−
   6
(   1
−   0
)
3
   11
(   0
) , 
   14
=   3
(   1
)−   3
(   0
)−   4
(   0
)(   1
−   0
)+
   2
(   1
−   0
)
2
   7
(   0
)+
   6
(   1
−   0
)
3
   10
(   0
) , 
   15
=   5
(   1
)−   5
(   0
)−(   1
−   0
)   6
(   0
) . 
 
В векторно-матричной форме полученные интегральные соотношения запишутся в виде:  
 
∫    (   )   (   )     =   (   0
,   1
,   2
)
   2
   0
, (2.2) 
 
где 
 
   (   )=(   1
(   ),   2
(   ),   3
(   ),   4
(   ))
   , 
   (   0
,   1
,   2
)=(   1
   2
...    15
)
   . 
 
Матрица    (   ) имеет размерность (15×4) , элементы которой имеют следующий вид  
 
ℎ
1
(3)
[   2
,   ]=
   (   2
−   )
3
6       
,  ℎ
2
(3)
[   2
,   ]=
   (   2
−   )
2
2       
,  ℎ
3
(2)
[   2
,   ]=−
   (   2
−   )
3
6       
, (2.3) Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      66 
ℎ
4
(2)
[   2
,   ]=−
   (   2
−   )
2
2       
,  ℎ
5
(1)
[   2
,   ]=(   2
−   ) ,  ℎ
6
(1)
[   2
,   ]=1,   
ℎ
7
(2)
[   2
,   ]=
   2
−          
, ℎ
8
(3)
[   2
,   ]=
   2
−          
, ℎ
9
(4)
[   2
,   ]=
   2
−          
, 
 ℎ
10
(2)
[   2
,   ]=
1
       
, ℎ
11
(3)
[   2
,   ]=
1
       
,  ℎ
12
(4)
[   2
,   ]=
1
       
,     ℎ
13
(3)
[   1
,   ]={
−
   (   1
−   )
3
6       
,     0
≤   ≤   1
    0  ,        1
<   ≤   2
  
, 
ℎ
14
(2)
[   1
,   ]={
−
   (   1
−   )
3
6       
,      0
≤   ≤   1
    0  ,         1
<   ≤   2
  
,  ℎ
15
(1)
[   1
,   ]={
(   1
−   ),      0
≤   ≤   1
    0  ,        1
<   ≤   2
,  
    
где нижний индекс функции ℎ
   (   )
 обозначает номер строки (   =1,...,15), а верхний индекс - 
номер столбца (   =1,...,4) матрицы. Все остальные не приведенные элементы матрицы    (   ) 
равны нулю. 
Из (2.2) следует справедливость следующего утверждения.  
Утверждение. Система (1.7) с условиями (1.8) и (1.9), вполне управляема тогда и только тогда, 
когда для любого вектора  
0 1 2
,, t t t  можно найти управление () Ut ,  
02
, t t t  ,
 
удовлетворяющее условию (2.2). 
 Так как функционал (1.10) является квадратом нормы линейного нормированного 
пространства, а интегральное соотношение (2.2), порожденное функцией    (   ) , линейно, то задачу 
определения оптимального управления    0
(   ) можно рассматривать как проблему моментов [14, 
16, 20]. Следовательно, решение можно построить с помощью алгоритма решения проблемы 
моментов. Для решения конечномерной проблемы моментов (1.10) и (2.2), следуя [20], нужно 
найти величины       ,    =1,...,15, связанные условием 
 
∑            =1
15
   =1
 (2.4) 
 
для которых 
 
   0
2
=min
∑             =1
15
   =1
∫
[ℎ
1
(   )
2
+ℎ
2
(   )
2
+ℎ
3
(   )
2
+ℎ
4
(   )
2
]        2
   0
, (2.5) 
 
где 
 
ℎ
1
(   )=ℎ
5
(1)
[   2
,   ]   5
+ℎ
6
(1)
[   2
,   ]   6
+ℎ
15
(1)
[   1
,   ], 
(2.6) 
ℎ
2
(   )=ℎ
3
(2)
[   2
,   ]   3
+ℎ
4
(2)
[   2
,   ]   4
+ℎ
7
(2)
[   2
,   ]   7
+ℎ
10
(2)
[   2
,   ]   10
+ℎ
14
(2)
[   1
,   ]   14
, 
ℎ
3
(   )=ℎ
1
(3)
[   2
,   ]   1
+ℎ
2
(3)
[   2
,   ]   2
+ℎ
8
(3)
[   2
,   ]   8
+ℎ
11
(3)
[   2
,   ]   11
+ℎ
13
(3)
[   1
,   ]   13
, 
ℎ
4
(   )=ℎ
9
(4)
[   2
,   ]   9
+ℎ
12
(4)
[   2
,   ]   12
. 
  
Для определения величин       0
,    =1,...,15, минимизирующих (2.4), применим метод 
неопределенных множителей Лагранжа. Введем функцию 
 
   =∫
[( ℎ
1
(   ))
2
+( ℎ
2
(   ))
2
+( ℎ
3
(   ))
2
+( ℎ
4
(   ))
2
]        2
   0
+   (∑             15
   =1
−1) , Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      67 
 
где    - неопределенный множитель Лагранжа. На основе этого метода, вычисляя 
производные по       ,    =1,...,15 функции    и приравнивая к нулю, далее вычисляя интегралы 
и учитывая при этом обозначения (2.3) и присоединяя к полученным уравнениям условие 
(2.4), получим замкнутую систему 16 алгебраических уравнений относительно стольких же 
неизвестных величин       ,    =1,...,15 и    . Решая эту замкнутую систему алгебраических 
уравнений, получаем явные значения для искомых величин       0
,    =1,...,15 и    0
. 
Имея значения       0
,    =1,...,15, согласно формулам (2.5), (2.6) будем иметь 
 
ℎ
1
0
(   )={
(   2
−   )   5
0
+   6
0
+(   1
−   )   15
0
,     0
≤   ≤   1
    (   2
−   )   5
0
+   6
0
  ,                     1
<   ≤   2
  
, 
(2.7) 
ℎ
2
0
(   )=
{
 
 
 
 
−
   (   2
−   )
3
6       
   3
0
−
   (   2
−   )
2
2       
   4
0
+
   2
−          
   7
0
+
1
       
   10
0
−
   (   1
−   )
3
6       
   14
0
,     0
≤   ≤   1
    −
   (   2
−   )
3
6       
   3
0
+−
   (   2
−   )
2
2       
   4
0
+
   2
−               7
0
+
1
       
   10
0
  ,        1
<   ≤   2
  
, 
ℎ
3
0
(   )=
{
 
 
 
 
   (   2
−   )
3
6       
   1
0
+
   (   2
−   )
2
2       
   2
0
+
   2
−          
   8
0
+
1
       
   11
0
−
   (   1
−   )
3
6       
   13
0
,     0
≤   ≤   1
    
   (   2
−   )
3
6       
   1
0
+
   (   2
−   )
2
2       
   2
0
+
   2
−          
   8
0
+
1
       
   11
0
  ,        1
<   ≤   2
  
 
ℎ
4
0
(   )=
   2
−          
   9
0
+
1
       
   12
0
, 
 
(      0
)
2
=∫
[(ℎ
1
0
(   ))
2
+(ℎ
2
0
(   ))
2
+(ℎ
3
0
(   ))
2
+(ℎ
4
0
(   ))
2
]        2
   0
.      
 
Следуя [20], оптимальные управления        0
(   ) для любого    =1,...,4 представятся в виде: 
 
      0
(   )=
ℎ
   0
(   )
   0
2
,   =1,…,4 (2.8) 
которые имеют следующие явные представления:  
 
   1
0
(   )=
{
 
 
 
 
1
   0
2
((   2
−   )   5
0
+   6
0
+(   1
−   )   15
0
) ,     0
≤   ≤   1
   
1
   0
2
 ((   2
−   )   5
0
+   6
0
 ) ,                     1
<   ≤   2
  
, 
(2.7) 
   2
0
(   )=
{
 
 
 
 
1
   0
2
(−
   (   2
−   )
3
6       
   3
0
−
   (   2
−   )
2
2       
   4
0
+
   2
−          
   7
0
+
1
       
   10
0
−
   (   1
−   )
3
6       
   14
0
) ,     0
≤   ≤   1
    
1
   0
2
(−
   (   2
−   )
3
6       
   3
0
+−
   (   2
−   )
2
2       
   4
0
+
   2
−          
   7
0
+
1
       
   10
0
 ) ,        1
<   ≤   2
  
, 
   3
0
(   )={
1
   0
2
(
   (   2
−   )
3
6       
   1
0
+
   (   2
−   )
2
2       
   2
0
+
   2
−          
   8
0
+
1
       
   11
0
−
   (   1
−   )
3
6       
   13
0
) ,   0
≤   ≤   1
    
1
   0
2
(
   (   2
−   )
3
6       
   1
0
+
   (   2
−   )
2
2       
   2
0
+
   2
−          
   8
0
+
1
       
   11
0
)  ,        1
<   ≤   2
  
, 
   4
0
(   )=
1
   0
2
(
   2
−          
   9
0
+
1
       
   12
0
). Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      68 
 
Таким образом, как видно из формул (2.7), (2.8), построенные оптимальные управляющие 
воздействия являются кусочно-непрерывными функциями.  
 
3. Численный пример 
Для иллюстрации вышеизложенного предположим, что    0
=0,    1
=15,    2
=30,        
=2,
       
=1,        
=3,   =9,8. Начальное и конечное состояние фазового вектора выберем следующим 
образом  
 
   (0)=(0, 0, 0, 0, 0, 0, 6, 2, 1, 1, 3, 1)
   ,  
   (   2
)=(0,0,0,0,0,0,5,4,2,2,5,4)
   . 
 
Пусть в промежуточный момент времени    1
=15 заданы значения части координат фазового 
вектора в виде: 
 
   1
(   1
)=1700 ,    3
(   1
)=1400 ,      5
(   1
)=1600 .   (3.1) 
 
Это означает, что требуется построить оптимальные управляющие воздействия    1
0
(   ),    2
0
(   ),
   3
0
(   ),    4
0
(   ) ,    ∈[0,30], переводящие движение системы из начального положения    (0) через 
заданную промежуточную геометрическую точку (3.1) в конечное положение    (   ) , минимизируя 
функционал (1.10).  
Согласно вышеизложенному, выполняя необходимые построения, получим следующие 
значения для величин       0
,    =1,...,15 и функционала: 
 
   1
0
=−788048   ,   2
0
=1938144   ,   3
0
=−303443   ,   4
0
=596379   ,   5
0
=−118540800   , 
   6
0
=889056000   ,   7
0
=21985614   ,   8
0
=−101511144    ,   9
0
=−6167826   ,   10
0
−27536040   , 
   11
0
=287108640   ,   12
0
=111270915   ,   13
0
=941056   ,   14
0
=681856   ,   15
0
=237081600    , 
   0
2
=20837250   , 
где 
 
   =1910694844495
−1
,   =382138968899
−1
. 
 
Согласно формулам (2.7) и (2.8), для искомых оптимальных управляющих воздействий 
   1
0
(   ),    2
0
(   ),    3
0
(   ),    4
0
(   ) ,    ∈[0,30], получим явные выражения в следующем виде: 
 
   1
0
(   )={
128
3
−
256   45
,  0≤   ≤15
−128+
256   45
,  15<   ≤30
, 
 
   2
0
(   )=
{
 
 
−
2377
675
+
649   375
−
39109   2
202500
+
54059   3
9112500
,  0≤   ≤15
293
9
−
18511   3375
+
19433   2
67500
−
43349   3
9112500
,  15<   ≤30
, Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      69 
   3
0
(   )=
{
 
 
−
14068
4725
+
3638   7875
+
1376   2
354375
−
19126   3
15946875
,  0≤   ≤15
−
1756
63
+
128546   23625
−
5536   2
16875
+
98506   3
15946875
,  15<   ≤30
, 
   4
0
(   )=−
59
50
+
37   375
. 
 
Графические поведения полученных оптимальных управляющих воздействий приведены ниже 
(Рис. 2 - 5).  
    
 
Рис. 2. График функции управления    1
0
(   )       Рис. 3. График функции управления    2
0
(   ) 
 
    
 
Рис.4. График функции управления    3
0
(   )  Рис.5. График функции управления    4
0
(   ) 
 
Если подставить найденные выражения функции управления    0
(   ) в уравнения (2.1) и 
проинтегрировать эти уравнения при заданных начальном и промежуточном значении фазового 
вектора на каждом промежутке времени, получим законы фазового вектора.  Считаем 
целесообразным привести только законы движения для геометрических координат, которые 
имеют следующие явные виды:  
 
   1
0
(   )=
{
 
 
 
 
 
 
49   2
5
+
49   3
10
−
24619   4
40500
+
12733   5
675000
+
602   6
11390625
−
9563   7
1366875000
,  0≤   ≤15
−7352+
51464   15
−
50729   2
75
+
109543   3
1350
−
3073   4
540
+
449911   5
2025000
−
−
16954   6
3796875
+
49253   7
1366875000
,  15<   ≤30  
, 
 Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      70 
   3
0
(   )=
{
 
 
 
 
−
147   2
5
−
49   3
30
+
116473   4
81000
−
31801   5
225000
+
1916341   6
364500000
−
378413   7
5467500000
,  0≤   ≤15
−21308+
149156   15
−
151361   2
75
+
296107   3
1350
−
14357   4
1080
+
907039   5
2025000
−
−
952217   6
121500000
+
303443   7
5467500000
,  15<   ≤30
, 
 
   5
0
(   )={
64   2
3
−
128   3
135
,  0≤   ≤15
−6400+1280   −64   2
+
128   3
135
,   15<   ≤30
, 
  
Графики фазового вектора-функции    (   ) при    ∈[0,30] по геометрическим координатам
 
   1
0
(   ) ,    3
0
(   ) и    5
0
(   ) представлены на рис. 6 - 8. 
                               
                       
  Рис.6. График функции    1
0
(   )   Рис.7. График функции    3
0
(   ) 
 
  
 
Рис.8. График функции    5
0
(   )   Рис.9. Траектория движения  
 
Заключение 
Для систем линеаризованных дифференциальных уравнений пространственного движения 
квадрокоптера решена задача управления полетом с заданными начальными, конечными 
условиями и заданным значением части координат в некотором промежуточном моменте 
времени. Сформулированы условия вполне управляемости. Методом проблем моментов 
построена функция оптимального управления. Для иллюстрации предложенного подхода 
построены явные выражения функции оптимального управления и движения с заданным 
значением части координат в промежуточном моменте времени, а также построены 
соответствующие графики координат векторов функций оптимального управления и движения. 
  
Работа выполнена при поддержке Комитета по высшему образованию и науке РА, в рамках 
исследовательского проекта № 23-2DP-1B001. 
 
 Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      71 
Литература 
 
[1] Ситников Д.В., Бурьян Ю.А., Русских Г.С. Автопилот мультикоптера // Известия 
Тульского государственного университета. Технические науки. 2012. № 7. С. 213–221. 
[2] Рубин Д.Т., Конев В.Н., Стариковский А.В., Шептунов А.А., Смирнов А.С., Толстая 
А.М. Разработка квадрокоптеров со специальными свойствами для проведения 
разведывательных операций // Спецтехника и связь. 2012. № 1. С. 28–30. 
[3] Эпов М.И., Злыгостев И.Н. Применение беспилотных летательных аппаратов в 
аэрогеофизической разведке // Интерэкспо Гео-Сибирь. 2012. Т. 2. № 3. С. 22–27. 
[4] Телухин С.В., Матвеев В.В. Беспилотный летательный аппарат как объект 
управления. Мехатроника, автоматизация, управление. 2008. № 10. С. 7-10. 
[5] Chettibi T., Haddad M. Dynamic modelling of a quadrotor aerial robot // Journees D’etudes 
Nationales de Mecanique. Batna, Algerie, 2007. P. 22–27. 
[6] Mokhtari A., Benallegue A. Dynamic feedback controller of Euler angles and wind 
parameters estimation for a quadrotor unmanned aerial vehicle // Proceedings – IEEE 
International Conference on Robotics and Automation. 2004. V. 2004. N 3. P. 2359–2366. 
[7] Derafa L., Madani T., Benallegue A. Dynamic modelling and experimental identification of 
four rotors helicopter parameters // Proceedings of the IEEE International Conference on 
Industrial Technology. 2006. Art. 4237837. P. 1834–1839. 
[8] Маргун А.А., Зименко К.А., Базылев Д.Н. и др. Система управления беспилотным 
летательным аппаратом, оснащенным робототехническим манипулятором // Научно-
технический вестник информационных технологий, механики и оптики. 2014. №6 (94). 
[9] Luukkonen T. Modelling and control of quadcopter. 2011. http://sal.aalto.fi/publications/pdf-
files/eluu11_public.pdf 
[10] Puls T., Hein A. 3D trajectory control for quadrocopter // Intelligent Robots and System 
(IROS), IEEE/RSJ International Conference. 2010. P. 640–645. 
[11] Benić Z., Piljek P. and Kotarski D.  Mathematical modelling of unmanned aerial vehicles with 
four rotors. Interdisciplinary Description of Complex Systems. 2016. 14(1), pp. 88-100.  
[12] Ащепков Л.Т. Оптимальное управление системой с промежуточными условиями. 
ПММ, 1981, т. 45, вып. 2, с. 215-222. 
[13] Дыхта В.А., Самсонюк О.Н. Принцип максимума для гладких задач оптимального 
импульсного управления с многоточечными фазоограничениями. Журнал 
вычислительной математики и математической физики. 2009, т. 49, № 6, с. 981-997. 
[14] Барсегян В.Р. Управление составных динамических систем и систем с многоточечными 
промежуточными условиями. М.: Наука, 2016. 230 с. 
[15] Barseghyan V.R. Control of stage by stage changing linear dynamic systems // Yugoslav 
Journal of Operations Resarch. 2012. Vol. 22. № 1. P. 31-39. 
[16] Barseghyan V.R. and Barseghyan T.V. On an Approach to the Problems of Control of 
Dynamic System with Nonseparated Multipoint Intermediate Conditions. Automation and 
Remote Control, 2015, Vol. 76, № 4, pp. 549-559. 
[17] Барсегян В.Р., Матевосян А.Г. Об одной задаче управления беспилотным летательным 
аппаратом самолетного типа с заданными промежуточными значениями разных частей 
координат. Дифференциальные уравнения и процессы управления. 2023, № 2. С. 86-96. 
https://doi.org/10.21638/11701/spbu35.2023.205       
[18] Barseghyan V.R. Control Problem of String Vibrations with Inseparable Multipoint 
Conditions at Intermediate Points in Time. Mechanics of Solids. 2019. Vol. 54, Issue 8, pp. 
1216-1226. https://doi.org/10.3103/S0025654419080120 
[19] Barseghyan V., Solodusha S. On One Problem in Optimal Boundary Control for String 
Vibrations with a Given Velocity of Points at an Intermediate Moment of Time // IEEE 
International Russian Automation Conference (RusAutoCon). 2021. P. 343–349. 
[20] Красовский Н.Н. Теория управления движением. М.: Наука, 1968. 476 с. 
 Дифференциальные уравнения и процессы управления, N. 2, 2024 
 
https://doi.org/10.21638/11701/spbu35.2024.205     Электронный журнал: http://diffjournal.spbu.ru      72 
 
On one problem of optimal control of a quadcopter with a given 
intermediate value of part of the coordinates of the phase vector 
 
Barseghyan V. R.
1,2,*
, Simonyan T. A.
2,**
,  Matevosyan A. G.
2,***
 
 
1
 Institute of Mechanics of National Academy of Science of Armenia, Yerevan, Armenia 
2 
Yerevan State University, Yerevan, Armenia 
 
*
barseghyan@sci.am 
**
simtom09@gmail.com 
***
amatevosyan@ysu.am 
 
 
Abstract. Taking into account the growing use of quadcopters for various purposes, this work is 
devoted to considering the issues of mathematical modeling of their spatial motion and constructing 
a program optimal control law that ensures flight with a given intermediate value of part of the 
coordinates of the phase vector at some point in time. Based on the laws of theoretical mechanics, a 
system of differential equations describing the spatial motion of the quadcopter is given. For a 
linearized mathematical model of the motion of a quadcopter and a quadratic functional, the 
problem of constructing an optimal control law with given initial and final values of the phase 
vector and the value of a part of the coordinates at an intermediate point in time solved by the 
method of problems of moments. Optimal control functions and corresponding phase trajectories of 
optimal motion are constructed, taking into account the value of a part of the coordinates at some 
intermediate point in time. To illustrate the proposed approach, explicit expressions for the program 
optimal control function, phase coordinates of motion and corresponding graphs are constructed for 
specific numerical values. 
 
Keywords: quadcopter, mathematical model, optimal control, intermediate condition, phase 
trajectories. 
 
Acknowledgements. This study was financially supported by the Higher Education and Science 
Committee of RA (project No.23-2DP-1B001). 
 
