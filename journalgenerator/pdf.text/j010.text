dx
dt
6
 
-
?
ДИФФЕРЕНЦИАЛЬНЫЕ УРАВНЕНИЯ
И
ПРОЦЕССЫ УПРАВЛЕНИЯ
N 1, 1998
Электронный журнал,
рег. N П23275 от 07.03.97
http://www.wplus.net/pp/diffur
e-mail: diff@osipenko.stu.neva.ru
стохастические дифференциальные уравнения
ЧИСЛЕННОЕ МОДЕЛИРОВАНИЕ РЕШЕНИЙ
СТОХАСТИЧЕСКИХ СИСТЕМ ЛИНЕЙНЫХ
СТАЦИОНАРНЫХ ДИФФЕРЕНЦИАЛЬНЫХ
УРАВНЕНИЙ
О.Ю. Кульчицкий
Россия, 195251, Санкт-Петербург, ул. Политехническая, д.29
С.-Петербургский государственный технический университет
Кафедра ”Механика и процессы управления”
e-mail: control1@citadel.stu.neva.ru
Д.Ф.Кузнецов
Россия, 195251, Санкт-Петербург, ул. Политехническая, д.29
С.-Петербургский государственный технический университет
Кафедра ”Высшая математика”
e-mail: control1@citadel.stu.neva.ru
Аннотация.
Линейные стохастические системы занимают особое место как в тео-
рии стохастических систем, так и в их приложениях в механике, элек-
тротехнике и других областях. Прикладная значимость линейных систем
определяется тем, что они являются универсальным средством математи-
ческого описания малых отклонений поведения реальных систем от номи-
нальных режимов их функционирования. Теория стационарных линейныхДифференциальные уравнения и процессы управления, N. 1, 1998
систем основывается на аналитических представлениях решений в общем
случаеидопускаетприменениеспециальных,особенноэффективныхмето-
дов численно-статистического моделирования. В связи с этим, настоящая
статьяпосвященаспециальнымметодамчисленногомоделированиялиней-
ных стационарных стохастических систем и их практической реализации.
1. Системылинейныхстохастическихдифференциаль-
ныхуравнений:расчетныеформулыивспомогатель-
ные результаты
Рассмотрим систему линейных стохастических дифференциальных урав-
нений (СЛСДУ) вида:
dx
t
=A(t)x
t
dt+g(t)dt+Σ(t)df
t
; x
0
= x(0,ω), (1)
где x
t
= x(t,ω) ∈ R
n
− случайный процесс, являющийся решением СЛ-
СДУ (1) с начальным условием x(0,ω); f
t
= f(t,ω) ∈ R
m
− винеровский
случайный процесс с независимыми компонентами f
(i)
t
(i = 1,...,m) : M{f
t
}
≡ 0, M{f
t
f
T
t
} = Σ
2
f
= diag{σ
2
f
i
}
m
i=1
; g(t) ∈ R
k
− детерминированное возму-
щение системы; Σ(t) ∈ R
n×m
;A(t) ∈ R
n×n
и g(t) ∈ R
n
− матричные функ-
ции,удовлетворяющиеусловиямсуществованияиединственностирешения
СЛСДУ (1).
Систему (1) можно рассматривать как систему уравнений Ито или
Стратоновича, или в другом смысле, поскольку нетрудно показать, что
система (1) в силу своей структуры имеет одно и то же решение в каком
бы смысле она не рассматривалась. В связи с этим, часто применяемая в
технической литературе форма описания системы (1) в виде:
·
x
t
=A(t)x
t
+g(t)+Σ(t)
·
ft
; x
0
= x(0,ω),
с белым шумом
·
ft
в правой части не приводит к неоднозначности матема-
тического определения решений системы (1).
Линейные стохастические дифференциальные уравнения (ЛСДУ) рас-
сматривались рядом авторов. Так, в работах Арнольда [1], Ричардсона
[2], Маккенна и Моррисона [3], [4], а также Клоедена и Платена [5] рас-
сматривались скалярные ЛСДУ. В этих работах получено интегральное
представление решения скалярного ЛСДУ через фундаментальное реше-
ние, изучены свойства решений скалярных ЛСДУ. Аналитические реше-
ния некоторых простейших скалярных ЛСДУ можно найти у Арнольда

[1],Гарда [6],ХорстхемкеиЛофевера [7],ПугачеваиСиницина [8],Кло-
едена и Платена [5]. В работах Микулевичуса [9], Струка и Варадана
[10], Клоедена и Платена [5], Пугачева и Синицина [8] рассматривались
СЛСДУ. Для них дано интегральное представление решения через фунда-
ментальную матрицу решений, а также аналитически решены некоторые
простейшие СЛСДУ. В книге Арато [11] рассматривались стационарные
СЛСДУ.Длянихданопредставлениерешениячерезматричнуюэкспонен-
туирассмотреныихосновныесвойства.Кромеэтогоизученыдискретные
стационарные линейные стохастические системы, для которых построен
алгоритм численного моделирования. Вопросы численного моделирования
СЛСДУ рассматривались в работе Шкурко [12].
Настоящая работа посвящена построению численных методов решения
стационарных СЛСДУ, основанных на точном интегральном представле-
нииихрешений.Приэтомрассматриваетсярядвопросов,связанныхнепо-
средственно с особенностями численной реализации построенных числен-
ных методов.
1.1. Интегральное представление решений СЛСДУ
Рассмотримхорошоизвестныерезультаты (см.например [8], [5], [11])по
интегральному представлению решений СЛСДУ.
Общийслучай.Будемговорить,чтоn×n-матричнаяфункцияX(t,τ)
является фундаментальной матрицей системы (1), если:
1. X(τ,τ) = I при всех τ ≥ 0.
2.
∂
∂t
X(t,τ) = A(t)X(t,τ) при t≥τ ≥ 0.
3. X(τ,t) = X
−1
(t,τ) при τ ≤t, τ ≥ 0.
Известно, (см.,например, [13]),что X(t,τ)обладаетследующимисвой-
ствами:
1. X(t,τ) = X(t,s)X(s,τ) для любых τ, s, t≥ 0.
2.
∂
∂τ
X(t,τ) =−X(t,τ)A(τ) при любых t,τ ≥ 0.
Воспользовавшись описанными свойствами X(t,τ), нетрудно получить
интегральное соотношение для решений СЛСДУ (1) известное под назва-
нием формулы Коши:
x
t
= X(t,τ)x
τ
+
Z
t
τ
X(t,s)g(s)ds+
Z
t
τ
X(t,s)Σ(s)df
s
, (2)

где t≥τ ≥ 0.
Если задать временную сетку t
i
:
0 =t
0
<t
1
<t
2
<...<t
k
<...,
то из (2) следует рекуррентная формула для значений вектора решений x
t
в моменты времени t
k
:
x
t
k+1
=X(t
k+1
,t
k
)x
t
k
+
Z
t
k+1
t
k
X(t
k+1
,s)g(s)ds+ (3)
+
Z
t
k+1
t
k
X(t
k+1
,s)Σ(s)df
s
; x
0
= x(0,ω).
Дляупрощениядальнейшихвыкладокпримемследующиеобозначения:
x
k
Δ
= x
t
k
;
˜
A(k)
Δ
=X(t
k+1
,t
k
);
˜ g(k)
Δ
=
Z
t
k+1
t
k
X(t
k+1
,s)g(s)ds;
˜
f
k+1
Δ
=
Z
t
k+1
t
k
X(t
k+1
,s)Σ(s)df
s
. (4)
Тогда рекуррентное уравнение (3) примет вид:
x
k+1
=
˜
A(k)x
k
+˜ g(k)+
˜
f
k+1
; x
0
= x(0,ω). (5)
По своему построению (4) случайное возмущение
˜
f
k
является гауссов-
ским белошумным дискретным векторным случайным процессом таким,
что:
M{
˜
f
k
}≡ 0; M{
˜
f
k
˜
f
T
r
} = 0 при k6=r;
D
n
˜
f
k+1
o
Δ
=M
n
˜
f
k+1
˜
f
T
k+1
o
=
Z
t
k+1
t
k
X(t
k+1
,s)Σ(s)Σ
2
f
Σ
T
(s)X
T
(t
k+1
,s)ds.
Дисперсионная матричная функция D
n
˜
f
k+1
o
является симметричной
не- отрицательно-определенной и представима в виде:
D
n
˜
f
k+1
o
=D
f
(t
k+1
),
где матричная функция D
f
(t) при t∈ [t
k
,t
k+1
] является решением следу-
ющей системы дифференциальных уравнений:
·
D
f
(t) =A(t)D
f
(t)+D
f
(t)A
T
(t)+Σ(t)Σ
2
f
Σ
T
(t); D
f
(t
k
) = 0 (6)

Стационарный случай. Систему (1) будем называть стационарной,
если: A(t)≡A; Σ(t)≡ Σ :
dx
t
=Ax
t
dt+g(t)dt+Σdf
t
; x
0
= x(0,ω). (7)
ВэтомслучаефундаментальнаяматрицарешенийX(t,τ)представляет
собой матричную экспоненту:
X(t,τ) =e
A(t−τ)
=
∞
X
k=0
A
k
(t−τ)
k
k!
.
Формула Коши (2) запишется при этом в виде:
x
t
=e
A(t−τ)
x
τ
+
Z
t
τ
e
A(t−s)
g(s)ds+
Z
t
τ
e
A(t−s))
Σdf
s
.
Если в случае стационарной системы (7) взять регулярную сетку:
t
i+1
=t
i
+Δ; t
0
= 0,
где Δ− шаг сетки, то обозначения (4) несколько упростятся:
˜
A =e
AΔ
;
˜ g(k)
Δ
=
Z
Δ
0
e
A(Δ−s)
g(kΔ+s)ds;
˜
f
k+1
Δ
=
Z
Δ
0
e
A(t−s)
Σdf
kΔ+s
.
и система (5) превращается в систему с постоянной матрицей
˜
A:
x
k+1
=
˜
Ax
k
+˜ g(k)+
˜
f
k+1
, x
0
= x(0,ω), (8)
гдевекторныйгауссовскийбелошумныйдискретныйслучайныйпроцесс
˜
f
k
имеет дисперсионную матрицу:
D
n
˜
f
k+1
o
=D
f
(Δ) =
Z
Δ
0
e
A(Δ−s)
ΣΣ
2
f
Σ
T
e
A
T
(Δ−s)
ds, (9)
равнуюрешениюматричногодифференциальногоуравнения(6)приt = Δ,
которое с учетом сделаных допущений принимает вид:
·
D
f
(t) = AD
f
(t)+D
f
(t)A
T
+ΣΣ
2
f
Σ
T
; D
f
(0) = 0. (10)

Если все собственные числа матрицы А лежат в левой полуплоскости:
Reλ
i
(A) < 0, то уравнение (10) имеет стационарное решение D(∞), удо-
влетворяющее следующей алгебраической системе линейных уравнений:
0 =AD(∞)+D(∞)A
T
+ΣΣ
2
f
Σ
T
. (11)
Однако, в задачах моделирования шаг Δ обычно нельзя считать доста-
точнобольшимпосравнениюс
1
λ
min
(A)
и,следовательно,матрица D
f
(Δ)не
может определяться из уравнения (11).
1.2. Моментные характеристики решений СЛСДУ
Приведемсводкуизвестныхвлитературе (см.,например, [8], [11])уравне-
ний,которымудовлетворяютматематическиеожиданияикорреляционные
функции решений СЛСДУ. Введем обозначения:
m
x
(t)
Δ
=M{x
t
};
◦
x
t
= x
t
−m
x
(t);
R
x
(t,τ) = M
 
◦
x
t
◦
x
T
τ
 
; D
x
(t) =R
x
(t,t).
В общем случае из (1) с учетом введенных обозначений получаем:
1. Для m
x
(t) при t≥ 0 :
·
m
x
(t) =A(t)m
x
(t)+g(t); m
x
(0) =M{x
0
},
или в интегральной форме:
m
x
(t) = X(t,0)m
x
(0)+
Z
t
0
X(t,τ)g(τ)dτ.
2. Для D
x
(t) при t≥ 0 :
·
Dx
(t) = A(t)D
x
(t)+D
x
(t)A(t)
T
+Σ(t)Σ
2
f
Σ
T
(t); D
x
(0) =M
 
◦
x
0
◦
x
T
0
 
3. Для R
x
(t,τ) при t,τ ≥ 0 :
при t≥τ :
∂
∂t
R
x
(t,τ) =A(t)R
x
(t,τ); R
x
(τ,τ) =D(τ),
при t≤τ:
R(t,τ) = R
T
(τ,t)

В стационарном случае эти уравнения принимают вид:
·
m
x
(t) = Am
x
(t)+m(t); m
x
(0) =M{x
0
},
m
x
(t) = e
At
m
x
(0)+
Z
t
0
e
A(t−τ)
g(τ)dτ.
·
Dx
(t) =AD
x
(t)+D
x
(t)A
T
+ΣΣ
2
f
Σ
T
; D
x
(0) =M
 
◦
x
0
◦
x
T
0
 
. (12)
∂
∂t
R
x
(t,τ) = AR
x
(t,τ); R
x
(τ,τ) =D(τ) при t≥τ,
R(t,τ) = R
T
(τ,t) при t≤τ.
Нетрудно видеть, что в данном случае:
R
x
(t,τ) =
(
e
A(t−τ)
D
x
(τ) при t≥τ
D
x
(t)e
A
T
(τ−t)
при τ ≥t.
ДлягурвицевойматрицыAматричноеуравнение(12)имеетстационар-
ное решение, удовлетворяющее системе линейных алгебраических уравне-
ний вида:
0 =AD
x
(∞)+D
x
(∞)A
T
+ΣΣ
2
f
Σ
T
.
Если D
x
(0) =D
x
(∞), то D
x
(t) =D
x
(∞) = const. Тогда
R
x
(t,τ)≡R
x
(t−τ) =
(
e
A(t−τ)
D
x
(∞) при t≥τ
D
x
(∞)e
A
T
(τ−t)
при τ ≥t.
(13)
Если D
x
(0) 6= D
x
(∞), то в силу гурвицевости матрицы A D
x
(t) →
D
x
(∞) при t→∞ и формула (13) оказывается справедливой асимптоти-
чески при t,τ →∞, |t−τ |<∞ :
lim
t,τ→∞|t−τ|<∞
R
x
(t,τ) = R
x
(t−τ).
Таким образом, центрированная составляющая решения системы (7)
◦
x
t
= x
t
−m
x
(t) является в случае гурвицевой матрицы A либо стационар-
ным процессом при D
x
(0) = D
x
(∞), либо асимптотически стационарным
при D
x
(0)6=D
x
(∞).

Пусть выходными переменными СЛСДУ являются линейные комбина-
ции координат вектора состояния:
y
t
=H
T
x
t
∈R
l
,
где H ∈R
n×l
.Тогдамоментныехарактеристикипроцессаy
t
определяются
по формулам:
m
y
(t) =M{y
t
} = H
T
m
x
(t);
D
y
(t) = M
n
◦
y
t
2
o
=H
T
D
x
(t)H; R
y
(t,τ) = H
T
R
x
(t,τ)H. (14)
В установившемся режиме для гурвицевой матрицы A формулы (14) при
τ,t→∞,|t−τ |<∞ принимают вид:
D
y
(∞) = H
T
D
x
(∞)H; R
y
(t,τ)→R
y
(t−τ) = H
T
R
x
(t−τ)H.
Спектральнаяплотностьмощностицентрированнойсоставляющейста-
ционарного выходного процесса y
t
представима в виде:
S◦
y
(ω) =
Z
∞
−∞
R
y
(t)e
−iωt
dt =H
T
(iωI−A)
−1
ΣΣ
2
f
Σ
T
(−iωI−A
T
)
−1
H =
=G(iω)G
T
(−iω),
гдеI−единичнаяматрица,аi−мнимаяединица;G(p) =H
T
(pI−A)
−1
ΣΣ
f
-
матричная передаточная функция системы от входа
·
ft
к y
t
.
1.3. Свойства дискретной системы стохастических уравнений в
стационарном случае
Рассмотрим дискретную линейную стохастическую систему (8) в предпо-
ложении, что:
˜ g(k) =
˜
Bu(k);
˜
f
k
=
˜
Σv
k
; y
k
=H
T
x
k
,
где u(k) ∈ R
r
− детерминированные возмущения; v
k
∈ R
m
− белошумный
векторныйгауссовскийслучайныйпроцессснулевымсреднимидисперси-
онной матрицей, пропорциональной единичной матрице:
M{v
k
}≡ 0; M
 
v
k
v
T
k
	
=I;
˜
Σ =
q
D
˜
f
,
y
k
∈R
l
− выходная переменная.

С учетом принятых обозначений система (8) запишется в виде:
x
k+1
=
˜
Ax
k
+
˜
Bu(k)+
˜
Σv
k+1
; x
0
= x(0); y
k
=H
T
x
k
. (15)
Рассмотриммоментныехарактеристикирешениясистемы (15) (см.,на-
пример, [8], [11]).
1. Для m
x
(k) и m
y
(k) :
m
x
(k+1) =
˜
Am
x
(k)+
˜
Bu(k); m
x
(0) =M{x
0
};
m
y
(k) =H
T
m
x
(k)
или
m
x
(k+1) =
˜
A
k
m
x
(0)+
k−1
X
s=0
˜
A
k−s−1
˜
Bu(s);
m
y
(k+1) = H
T
˜
A
k
m
x
(0)+
k−1
X
s=0
H
T
˜
A
k−s−1
˜
Bu(s);
2. Для D
x
(k) и D
y
(k) :
D
x
(k+1) =
˜
AD
x
(k)
˜
A
T
+
˜
Σ
2
; D
x
(0) =M
 
◦
x
0
◦
x
T
0
 
; (16)
D
y
(k) = H
T
D
x
(k)H.
3. Для R
x
(k,r) и R
y
(k,r) :
R
x
(k,r) =
(
e
A(k−r)
D
x
(r) при k≥r
D
x
(k)e
A
T
(r−k)
при r≥k.
R
y
(k,r) =
(
H
T
e
A(k−r)
D
x
(r)H при k≥r
H
T
D
x
(k)e
A
T
(r−k)
H при r≥k.
Еслиматрица Aгурвицева,томатрица
˜
Aимеетвсесобственныечисла
внутри единичного круга и уравнение (16) имеет асимптотически устой-
чивое решение, удовлетворяющее системе линейных алгебраических урав-
нений:
D
x
(∞) =
˜
AD
x
(∞)
˜
A
T
+
˜
Σ
2
; D
y
(∞) = H
T
D
x
(∞)H.
Если D
x
(0) =D
x
(∞), то D
x
(k) = D
x
(∞) =const. Тогда

R
x
(k,r)≡R
x
(k−r) =
(
e
A(k−r)
D
x
(∞) при k≥r
D
x
(∞)e
A
T
(r−k)
при r≥k.
(17)
Если D
x
(0) 6= D
x
(∞), то в силу гурвицевости матрицы A D
x
(k) →
D
x
(∞)при k→∞иформула (17)оказываетсясправедливойасимптоти-
чески при k,r→∞, |k−r|<∞ :
lim
k,r→∞|k−r|<∞
R
x
(k,r) =R
x
(k−r).
Таким образом, центрированная составляющая решения системы (15)
◦
x
k
= x
k
−m
x
(k) является в случае гурвицевойматрицы A либо стационар-
ным процессом при D
x
(0) = D
x
(∞), либо асимптотически стационарным
при D
x
(0)6=D
x
(∞).
2. Точный метод моделирования решений СЛСДУ
ВэтомразделебудетрассматриватьсяметодчисленногорешенияСЛСДУ,
основанный на представлении решений СЛСДУ по формуле Коши. По-
скольку формула Коши является точным интегральным представлением
решения СЛСДУ, то численный метод, основанный на ее применении, бу-
дем называть точным численным методом.
2.1. Общий подход к моделированию и структурирование про-
блемы
Рассмотрим СЛСДУ вида (1) в предположениях:
A(t)≡A; g(t)≡Bu(t); Σ(t)≡ Σ. (18)
Выходомсистемыбудемсчитатьлинейнуюкомбинациюкомпонентвек-
торасостояниясистемы.Сучетом (18)интересующаянассистемауравне-
ний (1) может быть переписана в виде:
dx
t
=Ax
t
dt+Bu(t)dt+Σdf
t
; x
0
= x(0); (19)
y
t
= H
T
x
t
,

где x
t
= x(t,ω) ∈ R
n
− решение СЛСДУ; u(t) ∈ R
k
− детерминированное
внешнее возмущение; y
t
∈ R
l
− выходной процесс, численная реализация
которого является финальной целью моделирования; H ∈ R
n×l
, A ∈ R
n×n
,
Σ ∈ R
n×m
, B ∈ R
n×k
− числовые матрицы; f
t
∈ R
m
− винеровский случай-
ный процесс с независимыми компонентами f
(i)
t
(i = 1,... ,m).
Рассмотрим временную сетку с узлами t
k
, k = 0, 1,... с постоянным
шагом Δ> 0 такую, что:
t
k+1
= t
k
+Δ =t
0
+(k+1)Δ.
Решение системы (19) на временной сетке с постоянным шагом Δ за-
пишется в форме Коши в виде:
x
k+1
=e
AΔ
x
k
+
Z
Δ
0
e
A(Δ−τ)
Bu(τ +kΔ)dτ +
Z
Δ
0
e
A(Δ−τ)
Σdf
τ+kΔ
, (20)
где x
k
Δ
= x
kΔ
.
Исходяизсодержательногосмысласлагаемых,входящихвправуючасть
(20), будем называть первое слагаемое переходной или динамической
составляющей,второе -систематическойсоставляющей,атретье -слу-
чайной составляющей векторного случайного процесса x
k
. Рассмотрим
отдельно проблемы моделирования каждой из этих составляющих.
2.2. Алгоритм моделирования динамической составляющей ре-
шения СЛСДУ
Вычисление динамической составляющей процесса x
k
на каждом шаге
моделирования требует знания матрицы e
AΔ
. По определению матричная
экспонента задается в виде ряда:
e
AΔ
=
∞
X
s=0
A
s
Δ
s
s!
. (21)
Однако непосредственное использование формулы (21) для вычисления
e
AΔ
не рационально, т.к. достижение приемлемой точности вычисления
требуетвэтомслучаевыполнениябольшогоколичестваоперацийматрич-
ных уможений и сложений. Для эффективного вычисления матричной экс-
понентывлитературе [14]рекомендуетсяиспользоватьспециальныйалго-

ритм ”быстрого”вычисления, основанный на формуле:
e
AΔ
=
 
e
A
Δ
2
M
 
2
M
'
 
N
X
s=0
A
s
s!
 
Δ
2
M
 
s
!
2
M
, (22)
где N ≥ 1, M ≥ 0−некоторые целые числа.
Отметим, что, если M = 0, n =∞, то формула (22) полностью совпа-
дает с формулой (21). При M = 2, 3,...
Δ
2
M
<< Δ и потому для аппрок-
симации с достаточной точностью матричной экспоненты e
AΔ
количество
N+1членоврядав (22)можетбытьвзятозначительноменьшим,чемпри
M = 0. Причем это различие будет тем значительней, чем больше берется
значение M. Учитывая, что в диапазоне M ∈ [10, 20] величина 2
M
при-
мерно находится в диапазоне [10
3
, 10
6
], число N в (22), необходимое для
достижения одной и той же точности вычисления e
AΔ
резко уменьшается
с увеличением M.
Вработе [15], (см.также [16,гл.8])показано,чтодлятого,чтобывычис-
лить матричную экспоненту e
AΔ
по формуле (22) с точностью не меньшей
  :
ke
AΔ
−Dk≤ , (23)
достаточно взять такие целые N ≥ 1 и M ≥ 0, при которых выполняется
условие:
e
kAkΔ(kAkΔ)
N+1
2
MN
(N +1)!
≤ , (24)
где
kAk = max
1≤i≤n
n
X
j=1
|A
(ij)
|,
где A
(ij)
−компонента матрицы A.
В [15] поставлены и решены задачи об определении оптимальной пары
(M,N), используемой в формуле (22). Оказалось, что соотношения, свя-
зывающие оптимальные M и N в задаче об определении минимума вы-
числительныхзатратпрификсированнойточностивычисленияматричной
экспоненты и в задаче минимизации погрешности вычисления матричной
экспоненты при фиксированных вычислительных затратах эквивалентны.

Приведем эти соотношения:
M =





[z]+1 при kAkΔ>v
0 при kAkΔ≤v,
(25)
где
z =
1
ln2
 
ln
kAkΔ
N +1
−
1
2(N +1)
 
+N;
v =
1
2
N
(N +1)e
1
2(N+1)
.
В [15] также даны практические рекомендации по выбору M и N. Так,
например,переборнатуральныхNследуетначинатьс4-5при kAkΔ≤ 1,3
и с 2-3 при kAkΔ ≥ 1,3. После фиксации конкретного N определяется
M, удовлетворяющее (23) и (24). Таким образом, алгоритм вычисления
матричной экспоненты может быть записан в следующей рекуррентной
форме:
Алгоритм 2.1. Вычисление матричной экспоненты e
AΔ
с точностью
 .
1. Вычисляется kAkΔ.
2.Позаданному  > 0выбираютсязначения Mи Nизсоотношения (25)
и условия (24).
3. i := 0.
4. G :=
N
P
s=0
A
s
s!
 
Δ
2
M
 
s
.
5. i :=i+1.
6. G :=G
2
.
7. Если i<M, то переход к пункту 3.
8. Если i =M, то полагается: e
AΔ
≈G.
9. Конец алгоритма.

2.3. Алгоритм моделирования систематической составляющей
решения СЛСДУ
Проблема моделирования систематической составляющей сводится к вы-
числению интеграла
J
Δ
=
Z
Δ
0
e
A(Δ−τ)
Bu(τ +kΔ)dτ. (26)
Рассмотрим различные способы приближенного вычисления интеграла
J
Δ
. Будем считать, что векторная функция u(kΔ+τ) при k = 0, 1,...
и τ ∈ [0,Δ] аппроксимируется с точностью ρ некоторой полиномиальной
функцией вида:
u(kΔ+τ) =
l
X
j=0
v
j
(k)τ
j
+r
l+1
(k,τ), (27)
где | r
l+1
(k,τ) |≤ ρτ
l+1
при k = 0, 1,... и τ ∈ [0,Δ], а векторные
коэффициенты v
j
(k); j = 0, 1,... ,l могут быть выбраны различными
способами. Ниже будут рассмотрены некоторые из них.
Достаточным условием, обеспечивающим возможность аппроксимаций
вида (27) является l+1 кратная непрерывная дифференцируемость функ-
ции u(t)сограниченной l+1−йпроизводной.Однаковозможныидругие
менее ограничительные условия.
Подставим (27) в (26). В результате получим следующее выражение:
J
Δ
=
l
X
j=0
J
Δ,j
Bv
j
(k)+R
Δ,l+1
, (28)
где
kR
Δ,l+1
k =k
Z
Δ
0
e
A(Δ−τ)
Br
l+1
(k,τ)dτk≤ρkJ
Δ,l+1
kkBk. (29)
J
Δ,j
=
Z
Δ
0
τ
j
e
A(Δ−τ)
dτ.
Остановимсяподробнеенавычисленииинтегралов J
Δ,j
; j = 0, 1,... ,l.
Нетрудно видеть, что
J
Δ,0
=A
−1
 
e
AΔ
−I
 
; (30)

J
Δ,j
=−A
−1
 
Δ
j
I−jJ
Δ,j−1
 
; j = 1, 2,... ,l. (31)
Применяямногократноформулу (31)самуксебепридемкследующему
выражению:
J
Δ,j
=A
−(j+1)
j!
"
AJ
Δ,0
−
j
X
s=1
Δ
s
A
s
s!
#
; j ≥ 1. (32)
Подставляя (30)в (32)получимокончательноевыражениедляинтеграла
J
Δ,j
; j ≥ 1:
J
Δ,j
=A
−(j+1)
j!
"
e
AΔ
−
j
X
s=0
Δ
s
A
s
s!
#
; j ≥ 0. (33)
Из (29) и (33) следует, что
kR
Δ,l+1
k≤constΔ
l+2
ρ. (34)
Подставляя (33) в (28) и отбрасывая остаточный член R
Δ,l+1
придем
к следующему приближенному представлению:
J
Δ
≈A
−(j+1)
l
X
j=0
j!
"
e
AΔ
−
j
X
s=0
Δ
s
A
s
s!
#
Bv
j
(k). (35)
Рассмотрим некоторые случаи выбора коэффициентов v
j
(k); j = 0, 1,
... ,l в соответствии с формулой (27) и соответствующие этим случаям
приближенные представления для J
Δ
.
1. Аппроксимация с помощью формулы Тейлора:
v
j
(k) =
1
j!
∂
(j)
u
k
∂t
j
; r
l+1
(k,τ) =
∂
(l+1)
u(θ(τ))
∂t
l+1
τ
l+1
(l+1)!
,
где θ(τ)∈ [kΔ,kΔ+τ];
J
Δ
≈A
−(j+1)
l
X
j=0
"
e
AΔ
−
j
X
s=0
Δ
s
A
s
s!
#
B
∂
(j)
u
k
∂t
j
.

2. Кусочно-постоянная аппроксимация (l=0):
v
0
(k) = u
k
, (36)
где u
k
Δ
= u(kΔ);
J
Δ
≈A
−1
 
e
AΔ
−I
 
Bu
k
.
3. Линейная интерполяция (l=1):
v
0
(k) = u
k
,
v
1
(k) =
1
Δ
(u
k+1
−u
k
),
где u
k+1
Δ
= u((k+1)Δ);
J
Δ
≈A
−1
 
e
AΔ
−I
 
Bu
k
+
A
−2
Δ
 
e
AΔ
−I−ΔA
 
B(u
k+1
−u
k
).
4. Квадратичная интерполяция (l=2):
v
0
(k) = u
k
,
v
1
(k) =
1
Δ
 
4u
k+
1
2
−3u
k
−u
k+1
 
;
v
2
(k) =
2
Δ
2
 
u
k+1
+u
k
−2u
k+
1
2
 
,
где u
k+
1
2
Δ
= u((k+
1
2
)Δ);
J
Δ
≈A
−1
 
e
AΔ
−I
 
Bu
k
+
A
−2
Δ
 
e
AΔ
−I−ΔA
 
B
 
4u
k+
1
2
−3u
k
−u
k+1
 
+
+
4A
−3
Δ
2
 
e
AΔ
−I−ΔA−
Δ
2
A
2
2
 
B
 
u
k+1
+u
k
−2u
k+
1
2
 
.
5. Кубическая интерполяция (l=3):
v
0
(k) = u
k
,
v
1
(k) =
1
2Δ
 
2u
k+1
+18u
k+
1
3
−9u
k+
2
3
−11u
k
 
,

v
2
(k) =
9
2Δ
2
 
−u
k+1
−5u
k+
1
3
+4u
k+
2
3
+2u
k
 
,
v
3
(k) =
9
2Δ
3
 
u
k+1
+3u
k+
1
3
−3u
k+
2
3
−u
k
 
,
где u
k+
1
3
Δ
= u((k+
1
3
)Δ), u
k+
2
3
Δ
= u((k+
2
3
)Δ);
J
Δ
≈A
−1
 
e
AΔ
−I
 
Bu
k
+
+
A
−2
2Δ
 
e
AΔ
−I−ΔA
 
B
 
2u
k+1
+18u
k+
1
3
−9u
k+
2
3
−11u
k
 
+
+
9A
−3
Δ
2
 
e
AΔ
−I−ΔA−
Δ
2
A
2
2
 
B
 
−u
k+1
−5u
k+
1
3
+4u
k+
2
3
+2u
k
 
+
+
27A
−4
Δ
3
 
e
AΔ
−I−ΔA−
Δ
2
A
2
2
−
Δ
3
A
3
6
 
B
 
u
k+1
+3u
k+
1
3
−3u
k+
2
3
−u
k
 
.
Из (35) следует, что проблема моделирования систематической соста-
вляющей практически сводится к вычислению матриц
˜
B
j
вида:
˜
B
j
=A
−(j+1)
j!
"
e
AΔ
−
j
X
s=0
Δ
s
A
s
s!
#
B, (37)
где j = 0, 1,... ,l. Если матрица А неособенная, то матрицы
˜
B
j
мо-
гут быть вычислены непосредственно по формуле (37) с использованием
алгоритма вычисления матричной экспоненты e
AΔ
. Однако, матрицы
˜
B
j
могутбытьвычисленыивслучаевырожденнойматрицы A,поскольку
˜
B
j
представимы в виде:
˜
B
j
=j!A
−(j+1)
∞
X
s=j+1
Δ
s
s!
A
s
B; j = 0, 1,... ,l. (38)
Из последнего равенства следует существование конечного предела левой
части (38) при det(A) → 0. Для вычисления матриц
˜
B
j
в случае выро-
жденнойматрицы Aрассмотримобобщениеподхода,предложенногов [15].
Рассмотрим систему дифференциальных уравнений вида:
˙
ˆ x(t) =Aˆ x(t)+B
l
X
j=0
t
j
v
j
(k); ˆ x(0) = 0, (39)
где ˆ x(t)∈R
n
.

Нетрудно видеть, что решение системы (39) имеет вид:
ˆ x(t) = e
At
ˆ x(0)+
l
X
j=0
J
t,j
Bv
j
(k).
Откуда следует, что:
ˆ x(Δ) =e
AΔ
ˆ x(0)+
l
X
j=0
˜
B
j
v
j
(k).
Введем в рассмотрение расширенную векторную функцию:
ˆ y(t) =








ˆ x(t)
x
n+1
(t)
...
x
n+l+1
(t)
x
n+l+2
(t)








,
которая является решением однородной системы уравнений вида:
˙
ˆ y(t) = A
1
ˆ y(t); ˆ y(0) =










O
n,1
v
0
(k)
v
1
(k)
2!v
2
(k)
...
l!v
l
(k)










, (40)
где
x
n+1
(t) =
l
X
j=0
t
j
v
j
(k),
·
x
n+p+1
(t) = x
n+p+2
(t); p = 0, 1,... ,l
·
x
n+l+2
(t) = 0;
A
1
=










A B O
n,k
O
n,k
... O
n,k
O
n,k
O
k,n
O
k
I
k
O
k
... O
k
O
k
...
O
k,n
O
k
O
k
O
k
... I
k
O
k
O
k,n
O
k
O
k
O
k
... O
k
I
k
O
k,n
O
k
O
k
O
k
... O
k
O
k










;

O
k
-нулеваяматрицаразмера k×k; I
k
−единичнаяматрицаразмера k×k;
O
n,k
−нулевая матрица размера n×k.
Решением системы (40) является матричная функция:
ˆ y(t) = e
A
1
t
ˆ y(0) =










e
At
J
t,0
B J
t,1
B ...
1
l!
J
t,l
B
...




















O
n,1
v
0
(k)
v
1
(k)
2!v
2
(k)
...
l!v
l
(k)










.
Такимобразом,вычисливматричнуюэкспонентуe
A
1
Δ
,можнополучить
сразу как матрицу e
AΔ
так и матрицы
˜
B
j
; j = 0, 1,... ,l. Сформулируем
полученный результат в форме специального алгоритма.
Алгоритм 2.2. Вычисление матриц e
AΔ
и
˜
B
j
; j = 0, 1,... ,l.
1. Из матрицы A и B системы (19) формируется матрица A
1
систе-
мы (40).
2. К матрице A
1
Δ применяется алгоритм 2.1 вычисления матричной
экспоненты, результатом которого с точностью ε, оказывается матрица:
˜
A
1
=








e
AΔ
J
Δ,0
B J
Δ,1
B ...
1
l!
J
Δ,l
B
...








.
3. Левый верхний блок (размера n×n) матрицы
˜
A
1
является матрицей
e
AΔ
.
4. j := 1.
5. j + 1-й левый верхний блок (размера n×k) матрицы
˜
A
1
является
матрицей:
ˆ
B
j
=
1
j!
J
Δ,j
B.
6.
˜
B
j
:=j!
ˆ
B
j
.
7.Если j <l+1, то j :=j +1 и перейти к пункту 5.
8. Конец работы алгоритма 2.2.

2.4. Алгоритм моделирования случайной составляющей решения
СЛСДУ.
Сначала рассмотрим основные идеи, которые будут положены в основу
построения алгоритма моделирования случайной составляющей решения
СЛСДУ, а затем приведем непосредственно сам алгоритм.
Найдем такое представление случайного столбца
˜
f
k
∈ R
n
, которое бы-
ло бы удобно для моделирования. Для этого рассмотрим дисперсионную
матрицу
˜
f
k+1
:
D
f
(Δ) =M
n
˜
f
k+1
˜
f
T
k+1
o
.
Спектральное разложение дисперсионной матрицы D
f
(Δ) имеет вид:
D
f
(Δ) =S
D
Λ
2
D
S
−1
D
, (41)
где S
D
− матрица ортонормированных собственных векторов D
f
(Δ), а
Λ
D
−диагональнаяматрица.Отметим,чтоD
f
(Δ)−симметричная,неотри-
цательно определенная матрица, поэтому ее собственные числа неотрица-
тельны, а матрица собственных векторов ортогональная.
Представим
˜
f
k+1
в виде:
˜
f
k+1
=S
D
Λ
D
˜
f
∗
k+1
, (42)
где
˜
f
∗
k+1
− случайный столбец, такой, что компоненты
˜
f
∗(i)
k+1
(i = 1,... ,n)
являютсянезависимымигауссовскимислучайнымивеличинамиснулевым
средним и единичной дисперсией.
Таким образом, при представлении (42) справедливо соотношение (41).
Для того, чтобы смоделировать случайный столбец
˜
f
k+1
необходимо най-
ти матрицу D
f
(Δ), ее собственные числа и собственные векторы, а так-
же смоделировать n независимых гауссовских случайных величин с нуле-
вым средним и единичной дисперсией, которые будут являться элемента-
ми
˜
f
∗
k+1
. Выражение для матрицы D
f
(Δ) и дифференциальное уравнение
для ее определения даны соотношениями (9) и (10). Отметим, что так
как матрица D
f
(Δ) симметричная, то полезную информацию несут
n
2
+n
2
элементов, расположенных над(под) главной диагональю D
f
(Δ), включая
главную диагональ. Для нахождения матрицы D
f
(Δ) необходимо решить
уравнение (10). С этой целью оно приводится к виду:
dd
f
(Δ)
dΔ
=A
∗
d
f
(Δ)+b, (43)

где столбцы d
f
(Δ), b∈R
n
2
+n
2
и имеют вид:
d
T
f
(Δ) =
 
d
T
f
1
(Δ),... ,d
T
f
n
(Δ)
 
, b
T
=
 
b
T
1
... b
T
n
 
, (44)
где
d
T
f
j
(Δ) =
h
D
(1j)
f
(Δ) ... D
(n−j+1 n)
f
(Δ)
i
, b
T
j
=
h
S
(1j)
... S
(n−j+1 n)
i
,
где j = 1,... ,n, S
Δ
= ΣΣ
2
f
Σ
T
.
Матрица A
∗
(размера
n
2
+n
2
×
n
2
+n
2
), входящая в (18), строится сле-
дующим образом. Сначала строятся матрицы Q
ip
; p = 0,... ,n− 1, i =
1,... ,n−p размера n×n с элементами Q
(kl)
ip
вида:
Q
(kl)
ip
=





1, при k =i, l =i+p
1, при k =i+p, l =i,
0, иначе.
Затемрассматриваютсяматрицы: R
ip
; p = 0,... ,n−1, i = 1,... ,n−p
вида:
R
ip
=Q
ip
A
T
+AQ
ip
.
Далеенетруднозаметить,чтопервые nстолбцовматрицы A
∗
строятся
из матриц R
i0
(i = 1,... ,n) подобно тому, как строится столбец d
f
(Δ) из
матрицы D
f
(Δ) по правилу (44). Затем из матриц R
i1
(i = 1,... ,n−1)
получаемследующие n−1столбецматрицы A
∗
потомужеправилуит.д.
Теперь, после того, как определены d
f
(Δ), b и A
∗
можно найти решение
уравнения (43):
d
f
(Δ) =A
∗−1
 
e
A
∗
Δ
−I
 
b. (45)
Следует отметить, что при переходе от (10) к (43) резко возрастает
размерность задачи.
Далее после перехода от d
f
(Δ) к D
f
(Δ) могут быть определены матри-
цы S
D
и Λ
D
. После этого можно приступить к моделированию случайной
составляющей решения СЛСДУ.
Сформулируем изложенные идеи в виде алгоритмов.
Алгоритм 2.3Преобразованиесимметричной n×nматрицыAвстол-
бец b размера
n
2
+n
2
.

1. i := 0.
2. j := 1.
3. q := 1.
4. b
(q+i)
:=A
(q q+j−1)
.
5. Если q < n−j +1, то q :=q+1 и перейти к пункту 4.
6. i :=i+n−j +1.
7. Если j <n, то j :=j +1 и перейти к пункту 3.
8. Конец работы алгоритма.
Алгоритм 2.4 Преобразование столбца b размера
n
2
+n
2
в симметрич-
ную матрицу A размера n×n.
1. i := 0.
2. j := 1.
3. q := 1.
4. A
(q q+j−1)
:= b
(q+i)
.
5. A
(q+j−1 q)
:= b
(q+i)
.
6. Если q < n−j +1, то q :=q+1 и перейти к пункту 4.
7. i :=i+n−j +1.
8. Если j <n, то j :=j +1 и перейти к пункту 3.
9. Конец работы алгоритма.
Алгоритм 2.5Преобразованиесимметричнойматрицы Aразмера n×
n в матрицу A
∗
размера
n
2
+n
2
×
n
2
+n
2
.
1. Q :=O
n
2. r := 1.
3. j := 1.
4. q := 1.
5. i :=q+j−1.
6. Q
(qi)
:= 1.
7. Q
(iq)
:= 1.
8. R :=QA
T
+AQ.
9. m := 0.

10. s := 1.
11. l := 1.
12. A
∗(l+m r)
:=R
(l l+s−1)
.
13. Если l <n−s+1, то l :=l+1 и перейти к пункту 12.
14. m :=m+n−s+1.
15. Если s<n, то s :=s+1 и перейти к пункту 11.
16. Q :=O
n
.
17. r :=r+1.
18. Если q <n−j +1, то q :=q+1 и перейти к пункту 5.
19. Если j <n, то j :=j +1 и перейти к пункту 4.
20. Конец работы алгоритма.
Алгоритм 2.6 Алгоритм моделирования случайной составляющей.
1. Формирование столбца b из матрицы ΣΣ
2
f
Σ
T
по алгоритму 2.3.
2. Формирование матрицы A
∗
из матрицы A по алгоритму 2.5.
3. Определение столбца d
f
(Δ) =A
∗−1
 
e
A
∗
Δ
−I
 
b по алгоритму 2.2.
4. Формирование матрицы D
f
(Δ) из столбца d
f
(Δ) по алгоритму 2.4.
5. Осуществление спектрального разложения матрицы D
f
(Δ) и опре-
деление матриц S
D
, Λ
2
D
.
6. Определение матрицы Λ
D
.
7. i := 1.
8. Моделирование случайной величины
˜
f
∗(i)
k+1
.
9. Если i<n, то i :=i+1 и перейти к пункту 7.
10.
˜
f
k+1
:=S
D
Λ
D
˜
f
∗
k+1
.
11. Конец работы алгоритма.
2.5. Алгоритммоделированиярешениясистемылинейныхстоха-
стических дифференциальных уравнений.
Приведем алгоритм моделирования решения СЛСДУ.
Алгоритм 2.7. Моделирование решения СЛСДУ.
1.Определениематриц
˜
A =e
AΔ
и
˜
B
j
=
R
Δ
0
e
A(Δ−τ)
τ
j
dτB; j = 0, 1,... ,l

по алгоритму 2.2.
2. x
1
:= x(0).
3. k := 1.
4. Моделирование случайного столбца
˜
f
k+1
по алгоритму 2.6.
5. x
k+1
:=
˜
Ax
k
+
l
P
j=0
˜
B
j
v
j
(k)+
˜
f
k+1
.
6. y
k
:=H
T
x
k
.
7. Если k < N, то k :=k+1 и перейти к пункту 4.
8. Конец работы алгоритма.
Список литературы
[1] Arnold L. Stochastic Differential Equations, New York: Wiley, 1974.
[2] Richardson J.M. The application of truncated hierarchy techniques in the
solution of a stochastic linear differential equation. In Stochastic Processes
in Mathematical Phisics and Engineering// Proc. Sympos. Appl. Math.,
Vol. 16, 1964 (R. Bellman, editor) Amer. Math. Soc., Providence RI, pp.
290-302.
[3] McKenna J., Morrison J.A. Moments and correlation functions of a
stochastic differential equation//J. Math. Phys., 11, 1970, pp. 2348-2360.
[4] McKenna J., Morrison J.A. Moments of solutions of a class of stochastic
differential equations//J. Math. Phys., 12, 1971, pp. 2126-2136.
[5] Kloeden P.E., Platen E. Numerical Solution of Stochastic Differential
Equations, Berlin Heidelberg New York: Springer-Verlag, 1992.
[6] Gard T.C. Introduction to Stochastic Differential Equations, New York:
Marcel Dekker, 1988.
[7] Horsthemke W., Lofever R. Noise Induced Transitions, Springer, 1984.
[8] Pugachev V.S., Sinitsyn I.N. Stochastic Differential Systems: Analisis and
Filtering, New York: Wiley, 1987.
[9] Mikulevicius R. On some properties of solutions of stochastic differential
equations//Lietuvos Matem. Rink, 4, 1983, pp. 18-31.

[10] Strook D.W., Varadhan S.R.S. Multidimensional Diffusion Processes,
Springer, 1982.
[11] Arato M. Linear Stochastic Systems with Constant Coeﬃcients. A Statis-
tical Approach, Berlin Heidelberg New York: Springer-Verlag, 1982.
[12] Shkurko I.O. Numerical solution of linear systems of stochastic differential
equations//In: Numerical Methods for Statistics and Modeling. Collected
Scientiﬁc Works. Novosibirsk, 1987, pp. 101-109 (In Russian)
[13] Понтрягин Л.С. Обыкновенные дифференциальные уравнения. Изд.5-
е. М.:Наука, 1982, 331c.
[14] Бахвалов Н.С. Численные методы. М.: Физматгиз, 1973, 631 с.
[15] Арсеньев Д.Г., Кульчицкий О.Ю. Оптимизация алгоритмов числен-
ного интегрирования жестких линейных систем дифференциальных
уравненийспостояннымикоэффициентами//ВИНИТИ31.01.86,N732-
B, 1986. 32с.
[16] Арсеньев Д.Г., Иванов В.М., Кульчицкий О.Ю. Адаптивные методы
вычислительной математики и механики. Стохастический вариант.
СПб.: Наука, 1996, 366 с.
Электронный журнал.  65
